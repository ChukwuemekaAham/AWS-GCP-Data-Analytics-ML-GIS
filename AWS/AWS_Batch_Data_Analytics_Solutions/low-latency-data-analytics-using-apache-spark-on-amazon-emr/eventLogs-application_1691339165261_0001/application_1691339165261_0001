{"Event":"SparkListenerLogStart","Spark Version":"3.1.1-amzn-0"}
{"Event":"SparkListenerResourceProfileAdded","Resource Profile Id":0,"Executor Resource Requests":{"cores":{"Resource Name":"cores","Amount":4,"Discovery Script":"","Vendor":""},"memory":{"Resource Name":"memory","Amount":4269,"Discovery Script":"","Vendor":""},"offHeap":{"Resource Name":"offHeap","Amount":0,"Discovery Script":"","Vendor":""}},"Task Resource Requests":{"cpus":{"Resource Name":"cpus","Amount":1.0}}}
{"Event":"SparkListenerBlockManagerAdded","Block Manager ID":{"Executor ID":"driver","Host":"ip-10-0-10-20.us-west-2.compute.internal","Port":41811},"Maximum Memory":956615884,"Timestamp":1691340111998,"Maximum Onheap Memory":956615884,"Maximum Offheap Memory":0}
{"Event":"SparkListenerEnvironmentUpdate","JVM Information":{"Java Home":"/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre","Java Version":"1.8.0_382 (Amazon.com Inc.)","Scala Version":"version 2.12.10"},"Spark Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"PySparkShell","spark.scheduler.mode":"FIFO","spark.driver.memory":"2048M","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"},"Hadoop Properties":{"hadoop.service.shutdown.timeout":"30s","yarn.resourcemanager.amlauncher.thread-count":"50","yarn.sharedcache.enabled":"false","fs.s3a.connection.maximum":"15","yarn.nodemanager.numa-awareness.numactl.cmd":"/usr/bin/numactl","fs.s3a.impl":"org.apache.hadoop.fs.s3a.S3AFileSystem","yarn.app.mapreduce.am.scheduler.heartbeat.interval-ms":"1000","yarn.timeline-service.timeline-client.number-of-async-entities-to-merge":"10","hadoop.security.kms.client.timeout":"60","hadoop.http.authentication.kerberos.principal":"HTTP/_HOST@LOCALHOST","mapreduce.jobhistory.loadedjob.tasks.max":"-1","mapreduce.framework.name":"yarn","yarn.sharedcache.uploader.server.thread-count":"50","yarn.nodemanager.log-aggregation.roll-monitoring-interval-seconds.min":"3600","yarn.nodemanager.linux-container-executor.nonsecure-mode.user-pattern":"^[_.A-Za-z0-9][-@_.A-Za-z0-9]{0,255}?[$]?$","tfile.fs.output.buffer.size":"262144","yarn.app.mapreduce.am.job.task.listener.thread-count":"60","yarn.nodemanager.node-attributes.resync-interval-ms":"120000","hadoop.security.groups.cache.background.reload.threads":"3","yarn.resourcemanager.webapp.cross-origin.enabled":"true","fs.AbstractFileSystem.ftp.impl":"org.apache.hadoop.fs.ftp.FtpFs","hadoop.registry.secure":"false","hadoop.shell.safely.delete.limit.num.files":"100","dfs.bytes-per-checksum":"512","fs.s3.buffer.dir":"/mnt/s3","mapreduce.job.acl-view-job":" ","fs.s3a.s3guard.ddb.background.sleep":"25ms","fs.s3a.retry.limit":"${fs.s3a.attempts.maximum}","mapreduce.jobhistory.loadedjobs.cache.size":"5","fs.s3a.s3guard.ddb.table.create":"false","yarn.log-aggregation.enable-local-cleanup":"false","dfs.namenode.handler.count":"64","yarn.nodemanager.amrmproxy.enabled":"false","yarn.timeline-service.entity-group-fs-store.with-user-dir":"false","mapreduce.input.fileinputformat.split.minsize":"0","yarn.resourcemanager.container.liveness-monitor.interval-ms":"600000","dfs.namenode.replication.max-streams":"20","yarn.resourcemanager.client.thread-count":"64","io.seqfile.compress.blocksize":"1000000","mapreduce.tasktracker.http.threads":"60","fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","yarn.sharedcache.checksum.algo.impl":"org.apache.hadoop.yarn.sharedcache.ChecksumSHA256Impl","yarn.nodemanager.amrmproxy.interceptor-class.pipeline":"org.apache.hadoop.yarn.server.nodemanager.amrmproxy.DefaultRequestInterceptor","dfs.datanode.data.dir":"/mnt/hdfs","dfs.replication":"1","yarn.timeline-service.entity-group-fs-store.leveldb-cache-read-cache-size":"10485760","mapreduce.reduce.shuffle.fetch.retry.interval-ms":"1000","mapreduce.task.profile.maps":"0-2","yarn.scheduler.include-port-in-node-name":"false","yarn.nodemanager.admin-env":"MALLOC_ARENA_MAX=$MALLOC_ARENA_MAX","yarn.resourcemanager.node-removal-untracked.timeout-ms":"60000","mapreduce.am.max-attempts":"2","hadoop.security.kms.client.failover.sleep.base.millis":"100","mapreduce.jobhistory.webapp.https.address":"0.0.0.0:19890","yarn.node-labels.fs-store.impl.class":"org.apache.hadoop.yarn.nodelabels.FileSystemNodeLabelsStore","yarn.nodemanager.collector-service.address":"${yarn.nodemanager.hostname}:8048","fs.trash.checkpoint.interval":"0","mapreduce.job.map.output.collector.class":"org.apache.hadoop.mapred.MapTask$MapOutputBuffer","yarn.resourcemanager.node-ip-cache.expiry-interval-secs":"3600","hadoop.http.authentication.signature.secret.file":"*********(redacted)","hadoop.jetty.logs.serve.aliases":"true","yarn.resourcemanager.placement-constraints.handler":"disabled","yarn.timeline-service.handler-thread-count":"10","yarn.resourcemanager.max-completed-applications":"1000","dfs.hosts.exclude":"/emr/instance-controller/lib/dfs.hosts.exclude","yarn.resourcemanager.placement-constraints.algorithm.class":"org.apache.hadoop.yarn.server.resourcemanager.scheduler.constraint.algorithm.DefaultPlacementAlgorithm","yarn.sharedcache.webapp.address":"0.0.0.0:8788","yarn.resourcemanager.delegation.token.renew-interval":"*********(redacted)","yarn.sharedcache.nm.uploader.replication.factor":"10","hadoop.security.groups.negative-cache.secs":"30","yarn.app.mapreduce.task.container.log.backups":"0","mapreduce.reduce.skip.proc-count.auto-incr":"true","hadoop.security.group.mapping.ldap.posix.attr.gid.name":"gidNumber","ipc.client.fallback-to-simple-auth-allowed":"false","yarn.nodemanager.resource.memory.enforced":"true","yarn.client.failover-proxy-provider":"org.apache.hadoop.yarn.client.ConfiguredRMFailoverProxyProvider","yarn.timeline-service.http-authentication.simple.anonymous.allowed":"true","ha.health-monitor.check-interval.ms":"1000","yarn.acl.reservation-enable":"false","yarn.resourcemanager.store.class":"org.apache.hadoop.yarn.server.resourcemanager.recovery.FileSystemRMStateStore","yarn.app.mapreduce.am.hard-kill-timeout-ms":"10000","fs.s3a.etag.checksum.enabled":"false","yarn.nodemanager.container-metrics.enable":"false","yarn.timeline-service.client.fd-clean-interval-secs":"60","yarn.resourcemanager.nodemanagers.heartbeat-interval-ms":"250","hadoop.common.configuration.version":"3.0.0","fs.s3a.s3guard.ddb.table.capacity.read":"500","yarn.nodemanager.remote-app-log-dir-suffix":"logs","yarn.nodemanager.windows-container.cpu-limit.enabled":"false","yarn.nodemanager.runtime.linux.docker.privileged-containers.allowed":"false","file.blocksize":"67108864","hadoop.registry.zk.retry.ceiling.ms":"60000","mapreduce.reduce.env":"HADOOP_MAPRED_HOME=/usr/lib/hadoop-mapreduce","yarn.scheduler.configuration.leveldb-store.path":"${hadoop.tmp.dir}/yarn/system/confstore","yarn.sharedcache.store.in-memory.initial-delay-mins":"10","mapreduce.jobhistory.principal":"jhs/_HOST@REALM.TLD","mapreduce.map.skip.proc-count.auto-incr":"true","fs.s3a.committer.name":"file","mapreduce.task.profile.reduces":"0-2","hadoop.zk.num-retries":"1000","yarn.webapp.xfs-filter.enabled":"true","seq.io.sort.mb":"100","yarn.scheduler.configuration.max.version":"100","yarn.timeline-service.webapp.https.address":"${yarn.timeline-service.hostname}:8190","yarn.resourcemanager.scheduler.address":"ip-10-0-10-20.us-west-2.compute.internal:8030","yarn.node-labels.enabled":"false","yarn.resourcemanager.webapp.ui-actions.enabled":"true","mapreduce.task.timeout":"600000","yarn.sharedcache.client-server.thread-count":"50","hadoop.security.groups.shell.command.timeout":"0s","hadoop.security.crypto.cipher.suite":"AES/CTR/NoPadding","yarn.nodemanager.elastic-memory-control.oom-handler":"org.apache.hadoop.yarn.server.nodemanager.containermanager.linux.resources.DefaultOOMHandler","yarn.resourcemanager.connect.max-wait.ms":"900000","fs.defaultFS":"hdfs://ip-10-0-10-20.us-west-2.compute.internal:8020","yarn.minicluster.use-rpc":"false","yarn.app.mapreduce.am.env":"HADOOP_MAPRED_HOME=/usr/lib/hadoop-mapreduce","fs.s3.impl":"com.amazon.ws.emr.hadoop.fs.EmrFileSystem","fs.har.impl.disable.cache":"true","yarn.webapp.ui2.enable":"false","io.compression.codec.bzip2.library":"system-native","fs.s3.buckets.create.region":"us-west-2","fs.s3a.change.detection.source":"etag","yarn.nodemanager.distributed-scheduling.enabled":"false","mapreduce.shuffle.connection-keep-alive.timeout":"5","yarn.resourcemanager.webapp.https.address":"${yarn.resourcemanager.hostname}:8090","mapreduce.jobhistory.address":"ip-10-0-10-20.us-west-2.compute.internal:10020","yarn.resourcemanager.nm-tokens.master-key-rolling-interval-secs":"*********(redacted)","yarn.is.minicluster":"false","yarn.nodemanager.address":"${yarn.nodemanager.hostname}:8041","hadoop.proxyuser.livy.groups":"*","fs.abfss.impl":"org.apache.hadoop.fs.azurebfs.SecureAzureBlobFileSystem","fs.AbstractFileSystem.s3a.impl":"org.apache.hadoop.fs.s3a.S3A","mapreduce.task.combine.progress.records":"10000","yarn.resourcemanager.epoch.range":"0","yarn.resourcemanager.am.max-attempts":"2","yarn.nodemanager.linux-container-executor.cgroups.hierarchy":"/hadoop-yarn","fs.AbstractFileSystem.wasbs.impl":"org.apache.hadoop.fs.azure.Wasbs","yarn.timeline-service.entity-group-fs-store.cache-store-class":"org.apache.hadoop.yarn.server.timeline.MemoryTimelineStore","yarn.nodemanager.runtime.linux.docker.default-rw-mounts":"/mnt/yarn:/mnt/yarn,/mnt/s3:/mnt/s3","fs.ftp.transfer.mode":"BLOCK_TRANSFER_MODE","ipc.server.log.slow.rpc":"false","yarn.resourcemanager.node-labels.provider.fetch-interval-ms":"1800000","yarn.router.webapp.https.address":"0.0.0.0:8091","yarn.nodemanager.webapp.cross-origin.enabled":"false","fs.wasb.impl":"org.apache.hadoop.fs.azure.NativeAzureFileSystem","yarn.resourcemanager.auto-update.containers":"false","yarn.app.mapreduce.am.job.committer.cancel-timeout":"60000","yarn.scheduler.configuration.zk-store.parent-path":"/confstore","yarn.nodemanager.default-container-executor.log-dirs.permissions":"750","yarn.app.attempt.diagnostics.limit.kc":"64","fs.s3a.change.detection.mode":"server","hadoop.proxyuser.presto.hosts":"*","ftp.bytes-per-checksum":"512","yarn.nodemanager.resource.memory-mb":"6144","io.compression.codecs":"org.apache.hadoop.io.compress.GzipCodec,org.apache.hadoop.io.compress.DefaultCodec,org.apache.hadoop.io.compress.BZip2Codec,org.apache.hadoop.io.compress.SnappyCodec,com.hadoop.compression.lzo.LzoCodec,com.hadoop.compression.lzo.LzopCodec","fs.AbstractFileSystem.abfs.impl":"org.apache.hadoop.fs.azurebfs.Abfs","yarn.timeline-service.writer.flush-interval-seconds":"60","fs.s3a.fast.upload.active.blocks":"4","yarn.resourcemanager.submission-preprocessor.enabled":"false","hadoop.security.credential.clear-text-fallback":"true","yarn.nodemanager.collector-service.thread-count":"5","fs.azure.secure.mode":"false","mapreduce.jobhistory.joblist.cache.size":"20000","fs.ftp.host":"0.0.0.0","yarn.timeline-service.writer.async.queue.capacity":"100","yarn.resourcemanager.fs.state-store.num-retries":"0","yarn.resourcemanager.nodemanager-connect-retries":"10","yarn.nodemanager.log-aggregation.num-log-files-per-app":"30","hadoop.security.kms.client.encrypted.key.cache.low-watermark":"0.3f","fs.s3a.committer.magic.enabled":"false","yarn.timeline-service.client.max-retries":"30","dfs.ha.fencing.ssh.connect-timeout":"30000","yarn.log-aggregation-enable":"true","yarn.system-metrics-publisher.enabled":"true","mapreduce.reduce.markreset.buffer.percent":"0.0","fs.AbstractFileSystem.viewfs.impl":"org.apache.hadoop.fs.viewfs.ViewFs","mapreduce.task.io.sort.factor":"48","yarn.nodemanager.amrmproxy.client.thread-count":"25","ha.failover-controller.new-active.rpc-timeout.ms":"60000","yarn.nodemanager.container-localizer.java.opts":"-Xmx256m","mapreduce.jobhistory.datestring.cache.size":"200000","mapreduce.job.acl-modify-job":" ","dfs.namenode.https-address":"ip-10-0-10-20.us-west-2.compute.internal:9871","yarn.nodemanager.windows-container.memory-limit.enabled":"false","yarn.timeline-service.webapp.address":"${yarn.timeline-service.hostname}:8188","yarn.app.mapreduce.am.job.committer.commit-window":"10000","yarn.nodemanager.container-manager.thread-count":"64","yarn.minicluster.fixed.ports":"false","hadoop.tags.system":"YARN,HDFS,NAMENODE,DATANODE,REQUIRED,SECURITY,KERBEROS,PERFORMANCE,CLIENT\n      ,SERVER,DEBUG,DEPRECATED,COMMON,OPTIONAL","yarn.cluster.max-application-priority":"0","yarn.timeline-service.ttl-enable":"true","mapreduce.jobhistory.recovery.store.fs.uri":"${hadoop.tmp.dir}/mapred/history/recoverystore","hadoop.caller.context.signature.max.size":"40","hadoop.proxyuser.hive.groups":"*","yarn.client.load.resource-types.from-server":"false","ha.zookeeper.session-timeout.ms":"10000","mapreduce.map.java.opts":"-Xmx1229m","tfile.io.chunk.size":"1048576","fs.s3a.s3guard.ddb.table.capacity.write":"100","yarn.dispatcher.print-events-info.threshold":"5000","mapreduce.job.speculative.slowtaskthreshold":"1.0","io.serializations":"org.apache.hadoop.io.serializer.WritableSerialization, org.apache.hadoop.io.serializer.avro.AvroSpecificSerialization, org.apache.hadoop.io.serializer.avro.AvroReflectSerialization","hadoop.security.kms.client.failover.sleep.max.millis":"2000","hadoop.security.group.mapping.ldap.directory.search.timeout":"10000","yarn.scheduler.configuration.store.max-logs":"1000","yarn.nodemanager.node-attributes.provider.fetch-interval-ms":"600000","fs.swift.impl":"org.apache.hadoop.fs.swift.snative.SwiftNativeFileSystem","yarn.nodemanager.local-cache.max-files-per-directory":"8192","hadoop.http.cross-origin.enabled":"false","dfs.namenode.rpc-address":"ip-10-0-10-20.us-west-2.compute.internal:8020","hadoop.zk.acl":"world:anyone:rwcda","mapreduce.map.sort.spill.percent":"0.80","yarn.timeline-service.entity-group-fs-store.scan-interval-seconds":"60","dfs.datanode.fsdataset.volume.choosing.policy":"org.apache.hadoop.hdfs.server.datanode.fsdataset.AvailableSpaceVolumeChoosingPolicy","yarn.node-attribute.fs-store.impl.class":"org.apache.hadoop.yarn.server.resourcemanager.nodelabels.FileSystemNodeAttributeStore","fs.s3a.retry.interval":"500ms","yarn.timeline-service.client.best-effort":"false","yarn.resourcemanager.webapp.delegation-token-auth-filter.enabled":"*********(redacted)","hadoop.security.group.mapping.ldap.posix.attr.uid.name":"uidNumber","fs.AbstractFileSystem.swebhdfs.impl":"org.apache.hadoop.fs.SWebHdfs","yarn.nodemanager.elastic-memory-control.timeout-sec":"5","mapreduce.ifile.readahead":"true","yarn.timeline-service.leveldb-timeline-store.ttl-interval-ms":"300000","yarn.timeline-service.reader.webapp.address":"${yarn.timeline-service.webapp.address}","yarn.resourcemanager.placement-constraints.algorithm.pool-size":"1","yarn.timeline-service.hbase.coprocessor.jar.hdfs.location":"/hbase/coprocessor/hadoop-yarn-server-timelineservice.jar","hadoop.security.kms.client.encrypted.key.cache.num.refill.threads":"2","yarn.resourcemanager.scheduler.class":"org.apache.hadoop.yarn.server.resourcemanager.scheduler.capacity.CapacityScheduler","yarn.app.mapreduce.am.command-opts":"-Xmx2458m","mapreduce.cluster.local.dir":"/mnt/mapred","hadoop.proxyuser.hue.hosts":"*","io.mapfile.bloom.error.rate":"0.005","fs.client.resolve.topology.enabled":"false","hadoop.proxyuser.hue.groups":"*","yarn.nodemanager.runtime.linux.allowed-runtimes":"default,docker","yarn.sharedcache.store.class":"org.apache.hadoop.yarn.server.sharedcachemanager.store.InMemorySCMStore","ha.failover-controller.graceful-fence.rpc-timeout.ms":"5000","ftp.replication":"3","hadoop.security.uid.cache.secs":"14400","mapreduce.job.maxtaskfailures.per.tracker":"3","fs.s3a.metadatastore.impl":"org.apache.hadoop.fs.s3a.s3guard.NullMetadataStore","io.skip.checksum.errors":"false","yarn.app.mapreduce.client-am.ipc.max-retries-on-timeouts":"3","yarn.timeline-service.webapp.xfs-filter.xframe-options":"SAMEORIGIN","fs.s3a.connection.timeout":"200000","yarn.nodemanager.linux-container-executor.group":"yarn","mapreduce.job.max.split.locations":"15","yarn.resourcemanager.nm-container-queuing.max-queue-length":"15","hadoop.registry.zk.session.timeout.ms":"60000","yarn.federation.cache-ttl.secs":"300","mapreduce.jvm.system-properties-to-log":"os.name,os.version,java.home,java.runtime.version,java.vendor,java.version,java.vm.name,java.class.path,java.io.tmpdir,user.dir,user.name","yarn.resourcemanager.opportunistic-container-allocation.nodes-used":"10","yarn.timeline-service.entity-group-fs-store.active-dir":"/tmp/entity-file-history/active","mapreduce.shuffle.transfer.buffer.size":"131072","yarn.timeline-service.client.retry-interval-ms":"1000","yarn.timeline-service.flowname.max-size":"0","yarn.http.policy":"HTTP_ONLY","fs.s3a.socket.send.buffer":"8192","fs.AbstractFileSystem.abfss.impl":"org.apache.hadoop.fs.azurebfs.Abfss","yarn.sharedcache.uploader.server.address":"0.0.0.0:8046","yarn.resourcemanager.delegation-token.max-conf-size-bytes":"*********(redacted)","hadoop.http.authentication.token.validity":"*********(redacted)","mapreduce.shuffle.max.connections":"0","yarn.minicluster.yarn.nodemanager.resource.memory-mb":"4096","mapreduce.job.emit-timeline-data":"false","yarn.nodemanager.resource.system-reserved-memory-mb":"-1","hadoop.kerberos.min.seconds.before.relogin":"60","mapreduce.jobhistory.move.thread-count":"3","yarn.resourcemanager.admin.client.thread-count":"1","yarn.dispatcher.drain-events.timeout":"300000","fs.s3a.buffer.dir":"${hadoop.tmp.dir}/s3a","hadoop.ssl.enabled.protocols":"TLSv1,SSLv2Hello,TLSv1.1,TLSv1.2","mapreduce.jobhistory.admin.address":"0.0.0.0:10033","yarn.log-aggregation-status.time-out.ms":"600000","fs.s3a.assumed.role.sts.endpoint.region":"us-west-1","mapreduce.shuffle.port":"13562","yarn.resourcemanager.max-log-aggregation-diagnostics-in-memory":"10","yarn.nodemanager.health-checker.interval-ms":"600000","yarn.service.base.path":"hdfs://ip-10-0-10-20.us-west-2.compute.internal:8020/user/hadoop/.yarn/","yarn.router.clientrm.interceptor-class.pipeline":"org.apache.hadoop.yarn.server.router.clientrm.DefaultClientRequestInterceptor","yarn.resourcemanager.zk-appid-node.split-index":"0","ftp.blocksize":"67108864","yarn.nodemanager.runtime.linux.sandbox-mode.local-dirs.permissions":"read","yarn.router.rmadmin.interceptor-class.pipeline":"org.apache.hadoop.yarn.server.router.rmadmin.DefaultRMAdminRequestInterceptor","yarn.nodemanager.log-container-debug-info.enabled":"true","yarn.client.max-cached-nodemanagers-proxies":"0","yarn.nodemanager.linux-container-executor.cgroups.delete-delay-ms":"20","yarn.nodemanager.delete.debug-delay-sec":"0","yarn.nodemanager.pmem-check-enabled":"true","yarn.nodemanager.disk-health-checker.max-disk-utilization-per-disk-percentage":"90.0","mapreduce.app-submission.cross-platform":"false","yarn.resourcemanager.work-preserving-recovery.scheduling-wait-ms":"10000","yarn.nodemanager.container-retry-minimum-interval-ms":"1000","hadoop.security.groups.cache.secs":"300","yarn.scheduler.increment-allocation-mb":"32","yarn.federation.enabled":"false","fs.azure.local.sas.key.mode":"false","ipc.maximum.data.length":"67108864","mapreduce.shuffle.max.threads":"0","yarn.router.pipeline.cache-max-size":"25","yarn.resourcemanager.nm-container-queuing.load-comparator":"QUEUE_LENGTH","hadoop.security.authorization":"false","yarn.app.mapreduce.am.jhs.backup.enabled":"true","mapreduce.job.complete.cancel.delegation.tokens":"*********(redacted)","fs.s3a.paging.maximum":"5000","nfs.exports.allowed.hosts":"* rw","yarn.nodemanager.amrmproxy.ha.enable":"false","mapreduce.jobhistory.http.policy":"HTTP_ONLY","yarn.sharedcache.store.in-memory.check-period-mins":"720","mapreduce.reduce.java.opts":"-Xmx2458m","hadoop.security.group.mapping.ldap.ssl":"false","yarn.client.application-client-protocol.poll-interval-ms":"200","yarn.scheduler.configuration.leveldb-store.compaction-interval-secs":"86400","yarn.timeline-service.writer.class":"org.apache.hadoop.yarn.server.timelineservice.storage.HBaseTimelineWriterImpl","ha.zookeeper.parent-znode":"/hadoop-ha","yarn.resourcemanager.submission-preprocessor.file-refresh-interval-ms":"60000","dfs.namenode.safemode.extension":"5000","yarn.nodemanager.log-aggregation.policy.class":"org.apache.hadoop.yarn.server.nodemanager.containermanager.logaggregation.AllContainerLogAggregationPolicy","mapreduce.reduce.shuffle.merge.percent":"0.66","hadoop.security.group.mapping.ldap.search.filter.group":"(objectClass=group)","yarn.resourcemanager.placement-constraints.scheduler.pool-size":"1","yarn.nodemanager.resourcemanager.minimum.version":"NONE","mapreduce.job.speculative.speculative-cap-running-tasks":"0.1","yarn.admin.acl":"*","dfs.namenode.replication.max-streams-hard-limit":"40","yarn.nodemanager.recovery.supervised":"true","yarn.sharedcache.admin.thread-count":"1","yarn.resourcemanager.ha.automatic-failover.enabled":"true","mapreduce.reduce.skip.maxgroups":"0","mapreduce.reduce.shuffle.connect.timeout":"180000","yarn.resourcemanager.address":"ip-10-0-10-20.us-west-2.compute.internal:8032","ipc.client.ping":"true","mapreduce.task.local-fs.write-limit.bytes":"-1","mapred.output.committer.class":"org.apache.hadoop.mapred.DirectFileOutputCommitter","fs.adl.oauth2.access.token.provider.type":"*********(redacted)","mapreduce.shuffle.ssl.file.buffer.size":"65536","yarn.resourcemanager.ha.automatic-failover.embedded":"true","yarn.nodemanager.resource-plugins.gpu.docker-plugin":"nvidia-docker-v1","hadoop.ssl.enabled":"false","fs.s3a.multipart.purge":"false","yarn.scheduler.configuration.store.class":"file","yarn.resourcemanager.nm-container-queuing.queue-limit-stdev":"1.0f","mapreduce.job.end-notification.max.attempts":"5","mapreduce.output.fileoutputformat.compress.codec":"org.apache.hadoop.io.compress.DefaultCodec","yarn.nodemanager.container-monitor.procfs-tree.smaps-based-rss.enabled":"false","ipc.client.bind.wildcard.addr":"false","yarn.resourcemanager.webapp.rest-csrf.enabled":"false","ha.health-monitor.connect-retry-interval.ms":"1000","yarn.nodemanager.keytab":"/etc/krb5.keytab","hadoop.security.key.provider.path":"kms://http@ip-10-0-10-20.us-west-2.compute.internal:9600/kms","hive.metastore.connect.retries":"15","mapreduce.jobhistory.keytab":"/etc/security/keytab/jhs.service.keytab","fs.s3a.threads.max":"10","mapreduce.reduce.shuffle.input.buffer.percent":"0.70","hadoop.security.token.service.use_ip":"*********(redacted)","yarn.nodemanager.runtime.linux.docker.allowed-container-networks":"emr-docker-bridge,host,bridge","yarn.nodemanager.node-labels.resync-interval-ms":"120000","hadoop.tmp.dir":"/mnt/var/lib/hadoop/tmp","mapreduce.job.maps":"8","mapreduce.jobhistory.webapp.rest-csrf.custom-header":"X-XSRF-Header","mapreduce.job.end-notification.max.retry.interval":"5000","yarn.log-aggregation.retain-check-interval-seconds":"-1","yarn.resourcemanager.resource-tracker.client.thread-count":"64","yarn.nodemanager.containers-launcher.class":"org.apache.hadoop.yarn.server.nodemanager.containermanager.launcher.ContainersLauncher","yarn.rm.system-metrics-publisher.emit-container-events":"false","yarn.timeline-service.leveldb-timeline-store.start-time-read-cache-size":"10000","yarn.resourcemanager.ha.automatic-failover.zk-base-path":"/yarn-leader-election","io.seqfile.local.dir":"${hadoop.tmp.dir}/io/local","fs.s3a.s3guard.ddb.throttle.retry.interval":"100ms","fs.AbstractFileSystem.wasb.impl":"org.apache.hadoop.fs.azure.Wasb","mapreduce.client.submit.file.replication":"10","mapreduce.jobhistory.minicluster.fixed.ports":"false","fs.s3a.multipart.threshold":"2147483647","yarn.resourcemanager.webapp.xfs-filter.xframe-options":"SAMEORIGIN","mapreduce.jobhistory.done-dir":"${yarn.app.mapreduce.am.staging-dir}/history/done","dfs.namenode.name.dir":"/mnt/namenode","ipc.client.idlethreshold":"4000","yarn.nodemanager.linux-container-executor.cgroups.strict-resource-usage":"false","yarn.nodemanager.runtime.linux.docker.default-ro-mounts":"/etc/passwd:/etc/passwd,/usr/lib:/docker/usr/lib,/usr/share:/docker/usr/share","mapreduce.reduce.input.buffer.percent":"0.0","yarn.nodemanager.runtime.linux.docker.userremapping-gid-threshold":"1","yarn.nodemanager.webapp.rest-csrf.enabled":"false","fs.ftp.host.port":"21","ipc.ping.interval":"60000","yarn.resourcemanager.history-writer.multi-threaded-dispatcher.pool-size":"10","yarn.resourcemanager.admin.address":"${yarn.resourcemanager.hostname}:8033","file.client-write-packet-size":"65536","ipc.client.kill.max":"10","mapreduce.reduce.speculative":"true","hadoop.security.key.default.bitlength":"256","mapreduce.job.reducer.unconditional-preempt.delay.sec":"300","yarn.nodemanager.disk-health-checker.interval-ms":"120000","yarn.nodemanager.log.deletion-threads-count":"4","yarn.webapp.filter-entity-list-by-user":"false","yarn.web-proxy.address":"ip-10-0-10-20.us-west-2.compute.internal:20888","ipc.client.connection.maxidletime":"10000","mapreduce.task.io.sort.mb":"200","yarn.nodemanager.localizer.client.thread-count":"20","io.erasurecode.codec.rs.rawcoders":"rs_native,rs_java","io.erasurecode.codec.rs-legacy.rawcoders":"rs-legacy_java","yarn.sharedcache.admin.address":"0.0.0.0:8047","yarn.resourcemanager.placement-constraints.algorithm.iterator":"SERIAL","yarn.nodemanager.localizer.cache.cleanup.interval-ms":"600000","hadoop.security.crypto.codec.classes.aes.ctr.nopadding":"org.apache.hadoop.crypto.OpensslAesCtrCryptoCodec, org.apache.hadoop.crypto.JceAesCtrCryptoCodec","mapreduce.job.cache.limit.max-resources-mb":"0","fs.s3a.connection.ssl.enabled":"true","yarn.nodemanager.process-kill-wait.ms":"5000","mapreduce.job.hdfs-servers":"${fs.defaultFS}","hadoop.workaround.non.threadsafe.getpwuid":"true","fs.df.interval":"60000","yarn.dispatcher.exit-on-error":"true","fs.s3a.multiobjectdelete.enable":"true","yarn.sharedcache.cleaner.resource-sleep-ms":"0","yarn.nodemanager.disk-health-checker.min-healthy-disks":"0.25","hadoop.shell.missing.defaultFs.warning":"false","io.file.buffer.size":"65536","dfs.permissions.superusergroup":"hdfsadmingroup","hadoop.security.group.mapping.ldap.search.attr.member":"member","hadoop.security.random.device.file.path":"/dev/urandom","hadoop.security.sensitive-config-keys":"*********(redacted)","fs.s3a.s3guard.ddb.max.retries":"9","hadoop.rpc.socket.factory.class.default":"org.apache.hadoop.net.StandardSocketFactory","yarn.intermediate-data-encryption.enable":"false","yarn.resourcemanager.connect.retry-interval.ms":"30000","yarn.nodemanager.container.stderr.pattern":"{*stderr*,*STDERR*}","fs.s3bfs.impl":"org.apache.hadoop.fs.s3.S3FileSystem","yarn.scheduler.minimum-allocation-mb":"32","yarn.app.mapreduce.am.staging-dir":"/tmp/hadoop-yarn/staging","mapreduce.reduce.shuffle.read.timeout":"180000","hadoop.http.cross-origin.max-age":"1800","io.erasurecode.codec.xor.rawcoders":"xor_native,xor_java","fs.s3a.connection.establish.timeout":"5000","mapreduce.job.running.map.limit":"0","yarn.minicluster.control-resource-monitoring":"false","hadoop.ssl.require.client.cert":"false","hadoop.kerberos.kinit.command":"kinit","yarn.federation.state-store.class":"org.apache.hadoop.yarn.server.federation.store.impl.MemoryFederationStateStore","mapreduce.reduce.log.level":"INFO","hadoop.security.dns.log-slow-lookups.threshold.ms":"1000","mapreduce.job.ubertask.enable":"false","adl.http.timeout":"-1","yarn.resourcemanager.placement-constraints.retry-attempts":"3","hadoop.caller.context.enabled":"false","hadoop.security.group.mapping.ldap.num.attempts":"3","yarn.nodemanager.vmem-pmem-ratio":"5","hadoop.rpc.protection":"authentication","ha.health-monitor.rpc-timeout.ms":"45000","yarn.nodemanager.remote-app-log-dir":"/var/log/hadoop-yarn/apps","hadoop.zk.timeout-ms":"10000","fs.s3a.s3guard.cli.prune.age":"86400000","yarn.nodemanager.resource.pcores-vcores-multiplier":"1.0","yarn.nodemanager.runtime.linux.sandbox-mode":"disabled","yarn.app.mapreduce.am.containerlauncher.threadpool-initial-size":"10","fs.s3a.committer.threads":"8","hadoop.zk.retry-interval-ms":"1000","hadoop.security.crypto.buffer.size":"8192","yarn.nodemanager.node-labels.provider.fetch-interval-ms":"600000","mapreduce.jobhistory.recovery.store.leveldb.path":"${hadoop.tmp.dir}/mapred/history/recoverystore","yarn.client.failover-retries-on-socket-timeouts":"0","yarn.nodemanager.resource.memory.enabled":"false","fs.azure.authorization.caching.enable":"true","hadoop.security.instrumentation.requires.admin":"false","yarn.nodemanager.delete.thread-count":"4","mapreduce.job.finish-when-all-reducers-done":"true","hadoop.registry.jaas.context":"Client","yarn.timeline-service.leveldb-timeline-store.path":"${hadoop.tmp.dir}/yarn/timeline","io.map.index.interval":"128","yarn.resourcemanager.nm-container-queuing.max-queue-wait-time-ms":"100","fs.abfs.impl":"org.apache.hadoop.fs.azurebfs.AzureBlobFileSystem","mapreduce.job.counters.max":"120","mapreduce.jobhistory.webapp.rest-csrf.enabled":"false","yarn.timeline-service.store-class":"org.apache.hadoop.yarn.server.timeline.EntityGroupFSTimelineStore","mapreduce.jobhistory.move.interval-ms":"180000","fs.s3a.change.detection.version.required":"true","yarn.nodemanager.localizer.fetch.thread-count":"20","yarn.resourcemanager.scheduler.client.thread-count":"64","hadoop.ssl.hostname.verifier":"DEFAULT","yarn.timeline-service.leveldb-state-store.path":"${hadoop.tmp.dir}/yarn/timeline","mapreduce.job.classloader":"false","mapreduce.task.profile.map.params":"${mapreduce.task.profile.params}","ipc.client.connect.timeout":"20000","hadoop.security.auth_to_local.mechanism":"hadoop","yarn.timeline-service.app-collector.linger-period.ms":"60000","yarn.nm.liveness-monitor.expiry-interval-ms":"600000","yarn.resourcemanager.reservation-system.planfollower.time-step":"1000","yarn.nodemanager.runtime.linux.docker.enable-userremapping.allowed":"true","hadoop.proxyuser.hadoop.groups":"*","yarn.webapp.api-service.enable":"true","yarn.nodemanager.recovery.enabled":"true","mapreduce.job.end-notification.retry.interval":"1000","fs.du.interval":"600000","fs.ftp.impl":"org.apache.hadoop.fs.ftp.FTPFileSystem","yarn.nodemanager.container.stderr.tail.bytes":"4096","hadoop.security.group.mapping.ldap.read.timeout.ms":"60000","mapreduce.map.env":"HADOOP_MAPRED_HOME=/usr/lib/hadoop-mapreduce","hadoop.security.groups.cache.warn.after.ms":"5000","file.bytes-per-checksum":"512","mapreduce.outputcommitter.factory.scheme.s3a":"org.apache.hadoop.fs.s3a.commit.S3ACommitterFactory","hadoop.security.groups.cache.background.reload":"false","yarn.nodemanager.container-monitor.enabled":"true","yarn.nodemanager.elastic-memory-control.enabled":"false","net.topology.script.number.args":"100","mapreduce.task.merge.progress.records":"10000","yarn.nodemanager.localizer.address":"${yarn.nodemanager.hostname}:8040","yarn.timeline-service.keytab":"/etc/krb5.keytab","mapreduce.reduce.shuffle.fetch.retry.timeout-ms":"30000","yarn.resourcemanager.rm.container-allocation.expiry-interval-ms":"600000","mapreduce.fileoutputcommitter.algorithm.version":"2","yarn.resourcemanager.work-preserving-recovery.enabled":"true","mapreduce.map.skip.maxrecords":"0","yarn.sharedcache.root-dir":"/sharedcache","fs.s3a.retry.throttle.limit":"${fs.s3a.attempts.maximum}","hadoop.http.authentication.type":"simple","mapreduce.job.jvm.numtasks":"20","mapreduce.job.cache.limit.max-resources":"0","mapreduce.task.userlog.limit.kb":"0","yarn.resourcemanager.scheduler.monitor.enable":"false","ipc.client.connect.max.retries":"10","hadoop.registry.zk.retry.times":"5","dfs.namenode.http-address":"ip-10-0-10-20.us-west-2.compute.internal:9870","yarn.nodemanager.resource-monitor.interval-ms":"3000","yarn.nodemanager.resource-plugins.gpu.allowed-gpu-devices":"auto","mapreduce.job.sharedcache.mode":"disabled","yarn.app.mapreduce.am.jhs.backup-dir":"file:///var/log/hadoop-mapreduce/history","yarn.nodemanager.webapp.rest-csrf.custom-header":"X-XSRF-Header","mapreduce.shuffle.listen.queue.size":"128","yarn.scheduler.configuration.mutation.acl-policy.class":"org.apache.hadoop.yarn.server.resourcemanager.scheduler.DefaultConfigurationMutationACLPolicy","mapreduce.map.cpu.vcores":"1","yarn.log-aggregation.file-formats":"TFile","yarn.timeline-service.client.fd-retain-secs":"300","hadoop.user.group.static.mapping.overrides":"dr.who=;","fs.azure.sas.expiry.period":"90d","mapreduce.jobhistory.recovery.store.class":"org.apache.hadoop.mapreduce.v2.hs.HistoryServerFileSystemStateStoreService","yarn.resourcemanager.fail-fast":"${yarn.fail-fast}","yarn.resourcemanager.proxy-user-privileges.enabled":"false","yarn.router.webapp.interceptor-class.pipeline":"org.apache.hadoop.yarn.server.router.webapp.DefaultRequestInterceptorREST","yarn.nodemanager.resource.memory.cgroups.soft-limit-percentage":"90.0","mapreduce.job.reducer.preempt.delay.sec":"0","hadoop.util.hash.type":"murmur","yarn.nodemanager.disk-validator":"basic","yarn.app.mapreduce.client.job.max-retries":"3","mapreduce.reduce.shuffle.retry-delay.max.ms":"60000","hadoop.security.group.mapping.ldap.connection.timeout.ms":"60000","mapreduce.task.profile.params":"-agentlib:hprof=cpu=samples,heap=sites,force=n,thread=y,verbose=n,file=%s","yarn.app.mapreduce.shuffle.log.backups":"0","yarn.nodemanager.container-diagnostics-maximum-size":"10000","hadoop.registry.zk.retry.interval.ms":"1000","yarn.nodemanager.linux-container-executor.cgroups.delete-timeout-ms":"1000","fs.AbstractFileSystem.file.impl":"org.apache.hadoop.fs.local.LocalFs","yarn.nodemanager.log-aggregation.roll-monitoring-interval-seconds":"-1","mapreduce.jobhistory.cleaner.interval-ms":"86400000","hadoop.registry.zk.quorum":"ip-10-0-10-20.us-west-2.compute.internal:2181","mapreduce.output.fileoutputformat.compress":"false","yarn.resourcemanager.am-rm-tokens.master-key-rolling-interval-secs":"*********(redacted)","fs.s3a.assumed.role.session.duration":"30m","hadoop.security.group.mapping.ldap.conversion.rule":"none","hadoop.proxyuser.livy.hosts":"*","hadoop.ssl.server.conf":"ssl-server.xml","fs.s3a.retry.throttle.interval":"1000ms","seq.io.sort.factor":"100","yarn.sharedcache.cleaner.initial-delay-mins":"10","mapreduce.client.completion.pollinterval":"5000","hadoop.ssl.keystores.factory.class":"org.apache.hadoop.security.ssl.FileBasedKeyStoresFactory","yarn.app.mapreduce.am.resource.cpu-vcores":"1","yarn.timeline-service.enabled":"false","yarn.nodemanager.runtime.linux.docker.capabilities":"CHOWN,DAC_OVERRIDE,FSETID,FOWNER,MKNOD,NET_RAW,SETGID,SETUID, SETFCAP,SETPCAP,NET_BIND_SERVICE,SYS_CHROOT,KILL,AUDIT_WRITE","yarn.acl.enable":"false","yarn.timeline-service.entity-group-fs-store.done-dir":"/tmp/entity-file-history/done/","mapreduce.tasktracker.map.tasks.maximum":"1","hadoop.security.group.mapping.ldap.num.attempts.before.failover":"3","mapreduce.task.profile":"false","dfs.webhdfs.enabled":"true","yarn.resourcemanager.fs.state-store.uri":"${hadoop.tmp.dir}/yarn/system/rmstore","mapreduce.jobhistory.always-scan-user-dir":"false","yarn.nodemanager.opportunistic-containers-use-pause-for-preemption":"false","yarn.nodemanager.linux-container-executor.nonsecure-mode.local-user":"hadoop","mapred.output.direct.EmrFileSystem":"true","yarn.timeline-service.reader.class":"org.apache.hadoop.yarn.server.timelineservice.storage.HBaseTimelineReaderImpl","yarn.resourcemanager.configuration.provider-class":"org.apache.hadoop.yarn.LocalConfigurationProvider","yarn.nodemanager.runtime.linux.docker.userremapping-uid-threshold":"1","yarn.resourcemanager.configuration.file-system-based-store":"/yarn/conf","mapreduce.job.cache.limit.max-single-resource-mb":"0","yarn.nodemanager.runtime.linux.docker.stop.grace-period":"10","yarn.resourcemanager.resource-profiles.source-file":"resource-profiles.json","yarn.nodemanager.resource.percentage-physical-cpu-limit":"100","mapreduce.jobhistory.client.thread-count":"10","tfile.fs.input.buffer.size":"262144","mapreduce.client.progressmonitor.pollinterval":"1000","yarn.nodemanager.log-dirs":"/var/log/hadoop-yarn/containers","hadoop.security.auth_to_local":"\n      RULE:[1:$1@$0](.*@)s/@.*///L\n      RULE:[2:$1@$0](.*@)s/@.*///L\n      DEFAULT\n    ","fs.automatic.close":"true","yarn.nodemanager.hostname":"0.0.0.0","yarn.nodemanager.resource.memory.cgroups.swappiness":"0","fs.s3n.impl":"com.amazon.ws.emr.hadoop.fs.EmrFileSystem","ftp.stream-buffer-size":"4096","yarn.fail-fast":"false","yarn.timeline-service.app-aggregation-interval-secs":"15","hadoop.security.group.mapping.ldap.search.filter.user":"(&(objectClass=user)(sAMAccountName={0}))","yarn.nodemanager.container-localizer.log.level":"INFO","yarn.timeline-service.address":"${yarn.timeline-service.hostname}:10200","dfs.namenode.replication.work.multiplier.per.iteration":"10","mapreduce.job.ubertask.maxmaps":"9","fs.s3a.threads.keepalivetime":"60","dfs.datanode.available-space-volume-choosing-policy.balanced-space-preference-fraction":"1.0","mapreduce.jobhistory.webapp.rest-csrf.methods-to-ignore":"GET,OPTIONS,HEAD","mapreduce.task.files.preserve.failedtasks":"false","yarn.app.mapreduce.client.job.retry-interval":"2000","ha.failover-controller.graceful-fence.connection.retries":"1","yarn.resourcemanager.delegation.token.max-lifetime":"*********(redacted)","yarn.timeline-service.client.drain-entities.timeout.ms":"2000","yarn.nodemanager.resource-plugins.fpga.vendor-plugin.class":"org.apache.hadoop.yarn.server.nodemanager.containermanager.resourceplugin.fpga.IntelFpgaOpenclPlugin","yarn.timeline-service.entity-group-fs-store.summary-store":"org.apache.hadoop.yarn.server.timeline.RollingLevelDBTimelineStore","mapreduce.reduce.cpu.vcores":"1","hadoop.proxyuser.oozie.groups":"*","mapreduce.job.encrypted-intermediate-data.buffer.kb":"128","fs.client.resolve.remote.symlinks":"true","yarn.nodemanager.webapp.https.address":"0.0.0.0:8044","hadoop.http.cross-origin.allowed-origins":"*","mapreduce.job.encrypted-intermediate-data":"false","yarn.timeline-service.entity-group-fs-store.retain-seconds":"604800","yarn.resourcemanager.metrics.runtime.buckets":"60,300,1440","yarn.timeline-service.generic-application-history.max-applications":"10000","mapreduce.tasktracker.reduce.tasks.maximum":"1","yarn.nodemanager.local-dirs":"/mnt/yarn","mapreduce.shuffle.connection-keep-alive.enable":"false","yarn.node-labels.configuration-type":"distributed","fs.s3a.path.style.access":"false","yarn.nodemanager.aux-services.mapreduce_shuffle.class":"org.apache.hadoop.mapred.ShuffleHandler","yarn.sharedcache.store.in-memory.staleness-period-mins":"10080","fs.adl.impl":"org.apache.hadoop.fs.adl.AdlFileSystem","yarn.resourcemanager.nodemanager.minimum.version":"NONE","mapreduce.jobhistory.webapp.xfs-filter.xframe-options":"SAMEORIGIN","yarn.app.mapreduce.am.staging-dir.erasurecoding.enabled":"false","net.topology.impl":"org.apache.hadoop.net.NetworkTopology","io.map.index.skip":"0","fs.AbstractFileSystem.s3.impl":"org.apache.hadoop.fs.s3.EMRFSDelegate","yarn.timeline-service.reader.webapp.https.address":"${yarn.timeline-service.webapp.https.address}","fs.ftp.data.connection.mode":"ACTIVE_LOCAL_DATA_CONNECTION_MODE","mapreduce.job.userlog.retain.hours":"48","mapreduce.job.local-fs.single-disk-limit.check.kill-limit-exceed":"true","yarn.scheduler.maximum-allocation-vcores":"128","hadoop.http.cross-origin.allowed-headers":"X-Requested-With,Content-Type,Accept,Origin","yarn.nodemanager.log-aggregation.compression-type":"none","yarn.timeline-service.version":"1.5","yarn.ipc.rpc.class":"org.apache.hadoop.yarn.ipc.HadoopYarnProtoRPC","mapreduce.reduce.maxattempts":"4","hadoop.security.dns.log-slow-lookups.enabled":"false","mapreduce.job.committer.setup.cleanup.needed":"true","mapreduce.job.running.reduce.limit":"0","ipc.maximum.response.length":"134217728","yarn.resourcemanager.webapp.rest-csrf.methods-to-ignore":"GET,OPTIONS,HEAD","mapreduce.job.token.tracking.ids.enabled":"*********(redacted)","hadoop.caller.context.max.size":"128","yarn.nodemanager.runtime.linux.docker.host-pid-namespace.allowed":"false","yarn.nodemanager.runtime.linux.docker.delayed-removal.allowed":"false","hadoop.registry.system.acls":"sasl:yarn@, sasl:mapred@, sasl:hdfs@","yarn.nodemanager.recovery.dir":"${hadoop.tmp.dir}/yarn-nm-recovery","fs.s3a.fast.upload.buffer":"disk","mapreduce.jobhistory.intermediate-done-dir":"${yarn.app.mapreduce.am.staging-dir}/history/done_intermediate","yarn.app.mapreduce.shuffle.log.separate":"true","yarn.log-aggregation.debug.filesize":"104857600","fs.s3a.max.total.tasks":"5","fs.s3a.readahead.range":"64K","hadoop.http.authentication.simple.anonymous.allowed":"true","fs.s3a.attempts.maximum":"20","hadoop.registry.zk.connection.timeout.ms":"15000","yarn.resourcemanager.delegation-token-renewer.thread-count":"*********(redacted)","yarn.nodemanager.health-checker.script.timeout-ms":"1200000","yarn.timeline-service.leveldb-timeline-store.start-time-write-cache-size":"10000","yarn.nodemanager.emit-container-events":"true","yarn.log.server.url":"http://ip-10-0-10-20.us-west-2.compute.internal:19888/jobhistory/logs","yarn.resourcemanager.resource-profiles.enabled":"false","yarn.timeline-service.hbase-schema.prefix":"prod.","fs.azure.authorization":"false","mapreduce.map.log.level":"INFO","yarn.resourcemanager.decommissioning-nodes-watcher.poll-interval-secs":"20","hadoop.job.history.user.location":"none","mapreduce.output.fileoutputformat.compress.type":"BLOCK","yarn.resourcemanager.leveldb-state-store.path":"${hadoop.tmp.dir}/yarn/system/rmstore","yarn.timeline-service.webapp.rest-csrf.custom-header":"X-XSRF-Header","mapreduce.ifile.readahead.bytes":"4194304","yarn.sharedcache.app-checker.class":"org.apache.hadoop.yarn.server.sharedcachemanager.RemoteAppChecker","yarn.nodemanager.linux-container-executor.nonsecure-mode.limit-users":"true","yarn.nodemanager.resource.detect-hardware-capabilities":"false","mapreduce.cluster.acls.enabled":"false","mapreduce.job.speculative.retry-after-no-speculate":"1000","hadoop.security.group.mapping.ldap.search.group.hierarchy.levels":"0","yarn.resourcemanager.fs.state-store.retry-interval-ms":"1000","hadoop.proxyuser.hadoop.hosts":"*","yarn.resourcemanager.nodes.exclude-path":"/emr/instance-controller/lib/yarn.nodes.exclude.xml","file.stream-buffer-size":"4096","yarn.resourcemanager.application-timeouts.monitor.interval-ms":"3000","mapreduce.map.output.compress.codec":"org.apache.hadoop.io.compress.SnappyCodec","mapreduce.map.speculative":"true","mapreduce.job.speculative.retry-after-speculate":"15000","yarn.nodemanager.linux-container-executor.cgroups.mount":"false","yarn.app.mapreduce.am.container.log.backups":"0","yarn.app.mapreduce.am.log.level":"INFO","mapreduce.job.reduce.slowstart.completedmaps":"0.05","yarn.timeline-service.http-authentication.type":"simple","hadoop.security.group.mapping.ldap.search.attr.group.name":"cn","yarn.nodemanager.resource-plugins.fpga.allowed-fpga-devices":"auto","yarn.timeline-service.client.internal-timers-ttl-secs":"420","hadoop.http.logs.enabled":"true","fs.s3a.block.size":"32M","yarn.sharedcache.client-server.address":"0.0.0.0:8045","yarn.nodemanager.logaggregation.threadpool-size-max":"100","yarn.resourcemanager.hostname":"10.0.10.20","yarn.resourcemanager.delegation.key.update-interval":"86400000","mapreduce.reduce.shuffle.fetch.retry.enabled":"${yarn.nodemanager.recovery.enabled}","mapreduce.map.memory.mb":"1536","mapreduce.task.skip.start.attempts":"2","fs.AbstractFileSystem.hdfs.impl":"org.apache.hadoop.fs.Hdfs","yarn.nodemanager.disk-health-checker.enable":"true","ipc.client.tcpnodelay":"true","ipc.client.rpc-timeout.ms":"0","yarn.nodemanager.webapp.rest-csrf.methods-to-ignore":"GET,OPTIONS,HEAD","ipc.client.low-latency":"false","mapreduce.input.lineinputformat.linespermap":"1","yarn.router.interceptor.user.threadpool-size":"5","javax.jdo.option.ConnectionURL":"jdbc:derby:;databaseName=/var/lib/hadoop/metastore/metastore_db;create=true","ipc.client.connect.max.retries.on.timeouts":"5","yarn.timeline-service.leveldb-timeline-store.read-cache-size":"104857600","fs.AbstractFileSystem.har.impl":"org.apache.hadoop.fs.HarFs","mapreduce.job.split.metainfo.maxsize":"10000000","yarn.am.liveness-monitor.expiry-interval-ms":"600000","yarn.resourcemanager.container-tokens.master-key-rolling-interval-secs":"*********(redacted)","yarn.timeline-service.entity-group-fs-store.app-cache-size":"10","fs.s3a.socket.recv.buffer":"8192","yarn.application.classpath":"\n        $HADOOP_CONF_DIR,\n        $HADOOP_COMMON_HOME/*,$HADOOP_COMMON_HOME/lib/*,\n        $HADOOP_HDFS_HOME/*,$HADOOP_HDFS_HOME/lib/*,\n        $HADOOP_MAPRED_HOME/*,$HADOOP_MAPRED_HOME/lib/*,\n        $HADOOP_YARN_HOME/*,$HADOOP_YARN_HOME/lib/*,\n        /usr/lib/hadoop-lzo/lib/*,\n        /usr/share/aws/emr/emrfs/conf,\n        /usr/share/aws/emr/emrfs/lib/*,\n        /usr/share/aws/emr/emrfs/auxlib/*,\n        /usr/share/aws/emr/lib/*,\n        /usr/share/aws/emr/ddb/lib/emr-ddb-hadoop.jar,\n        /usr/share/aws/emr/goodies/lib/emr-hadoop-goodies.jar,\n        /usr/lib/spark/yarn/lib/datanucleus-api-jdo.jar,\n        /usr/lib/spark/yarn/lib/datanucleus-core.jar,\n        /usr/lib/spark/yarn/lib/datanucleus-rdbms.jar,\n        /usr/share/aws/emr/cloudwatch-sink/lib/*,\n        /usr/share/aws/aws-java-sdk/*\n     ","yarn.resourcemanager.resource-tracker.address":"ip-10-0-10-20.us-west-2.compute.internal:8025","yarn.nodemanager.node-labels.provider.fetch-timeout-ms":"1200000","mapreduce.job.heap.memory-mb.ratio":"0.8","yarn.resourcemanager.leveldb-state-store.compaction-interval-secs":"3600","yarn.resourcemanager.webapp.rest-csrf.custom-header":"X-XSRF-Header","yarn.scheduler.configuration.fs.path":"file://${hadoop.tmp.dir}/yarn/system/schedconf","dfs.datanode.max.transfer.threads":"4096","mapreduce.client.output.filter":"FAILED","hadoop.http.filter.initializers":"org.apache.hadoop.security.HttpCrossOriginFilterInitializer,org.apache.hadoop.yarn.server.security.http.RMAuthenticationFilterInitializer,org.apache.hadoop.http.lib.StaticUserWebFilter","mapreduce.reduce.memory.mb":"3072","mapreduce.admin.user.env":"LD_LIBRARY_PATH=$HADOOP_COMMON_HOME/lib/native:/usr/lib/hadoop-lzo/lib/native","yarn.timeline-service.hostname":"ip-10-0-10-20.us-west-2.compute.internal","file.replication":"1","yarn.nodemanager.container-metrics.unregister-delay-ms":"10000","yarn.nodemanager.container-metrics.period-ms":"-1","mapreduce.fileoutputcommitter.task.cleanup.enabled":"false","hadoop.proxyuser.oozie.hosts":"*","yarn.nodemanager.log.retain-seconds":"10800","yarn.timeline-service.entity-group-fs-store.cleaner-interval-seconds":"3600","yarn.resourcemanager.keytab":"/etc/krb5.keytab","hadoop.security.group.mapping.providers.combined":"true","mapreduce.reduce.merge.inmem.threshold":"1000","yarn.timeline-service.recovery.enabled":"false","fs.azure.saskey.usecontainersaskeyforallaccess":"true","yarn.sharedcache.nm.uploader.thread-count":"20","mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","yarn.resourcemanager.nodemanager-graceful-decommission-timeout-secs":"3600","mapreduce.shuffle.ssl.enabled":"false","yarn.timeline-service.hbase.coprocessor.app-final-value-retention-milliseconds":"259200000","fs.s3a.committer.staging.abort.pending.uploads":"true","yarn.nodemanager.opportunistic-containers-max-queue-length":"0","yarn.resourcemanager.state-store.max-completed-applications":"${yarn.resourcemanager.max-completed-applications}","mapreduce.job.speculative.minimum-allowed-tasks":"10","yarn.nodemanager.node-labels.provider":"config","yarn.log-aggregation.retain-seconds":"172800","yarn.nodemanager.disk-health-checker.min-free-space-per-disk-mb":"0","mapreduce.jobhistory.max-age-ms":"604800000","hadoop.http.cross-origin.allowed-methods":"GET,POST,HEAD","yarn.resourcemanager.opportunistic-container-allocation.enabled":"false","mapreduce.jobhistory.webapp.address":"ip-10-0-10-20.us-west-2.compute.internal:19888","hadoop.system.tags":"YARN,HDFS,NAMENODE,DATANODE,REQUIRED,SECURITY,KERBEROS,PERFORMANCE,CLIENT\n      ,SERVER,DEBUG,DEPRECATED,COMMON,OPTIONAL","yarn.log-aggregation.file-controller.TFile.class":"org.apache.hadoop.yarn.logaggregation.filecontroller.tfile.LogAggregationTFileController","yarn.client.nodemanager-connect.max-wait-ms":"180000","yarn.resourcemanager.webapp.address":"${yarn.resourcemanager.hostname}:8088","mapreduce.jobhistory.recovery.enable":"false","mapreduce.reduce.shuffle.parallelcopies":"20","fs.AbstractFileSystem.webhdfs.impl":"org.apache.hadoop.fs.WebHdfs","fs.trash.interval":"0","yarn.nodemanager.node-labels.provider.configured-node-partition":"CORE","yarn.app.mapreduce.client.max-retries":"3","hadoop.security.authentication":"simple","mapreduce.task.profile.reduce.params":"${mapreduce.task.profile.params}","dfs.datanode.du.reserved":"536870912","yarn.app.mapreduce.am.resource.mb":"3072","mapreduce.input.fileinputformat.list-status.num-threads":"1","io.compression.codec.lzo.class":"com.hadoop.compression.lzo.LzoCodec","yarn.nodemanager.container-executor.class":"org.apache.hadoop.yarn.server.nodemanager.DefaultContainerExecutor","io.mapfile.bloom.size":"1048576","yarn.timeline-service.ttl-ms":"604800000","yarn.resourcemanager.nm-container-queuing.min-queue-length":"5","yarn.nodemanager.resource.cpu-vcores":"4","mapreduce.job.reduces":"3","fs.s3a.multipart.size":"100M","mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","yarn.scheduler.minimum-allocation-vcores":"1","mapreduce.job.speculative.speculative-cap-total-tasks":"0.01","hadoop.ssl.client.conf":"ssl-client.xml","mapreduce.job.queuename":"default","mapreduce.job.encrypted-intermediate-data-key-size-bits":"128","fs.s3a.metadatastore.authoritative":"false","yarn.nodemanager.webapp.xfs-filter.xframe-options":"SAMEORIGIN","ha.health-monitor.sleep-after-disconnect.ms":"1000","yarn.app.mapreduce.shuffle.log.limit.kb":"0","hadoop.security.group.mapping":"org.apache.hadoop.security.JniBasedUnixGroupsMappingWithFallback","yarn.client.application-client-protocol.poll-timeout-ms":"-1","mapreduce.jobhistory.jhist.format":"binary","yarn.resourcemanager.ha.enabled":"false","hadoop.http.staticuser.user":"dr.who","mapreduce.task.exit.timeout.check-interval-ms":"20000","mapreduce.jobhistory.intermediate-user-done-dir.permissions":"770","mapreduce.task.exit.timeout":"60000","yarn.nodemanager.linux-container-executor.resources-handler.class":"org.apache.hadoop.yarn.server.nodemanager.util.DefaultLCEResourcesHandler","mapreduce.reduce.shuffle.memory.limit.percent":"0.25","yarn.resourcemanager.reservation-system.enable":"false","mapreduce.map.output.compress":"true","ha.zookeeper.acl":"world:anyone:rwcda","hadoop.proxyuser.presto.groups":"*","ipc.server.max.connections":"0","yarn.nodemanager.aux-services":"mapreduce_shuffle,","yarn.nodemanager.runtime.linux.docker.default-container-network":"host","yarn.router.webapp.address":"0.0.0.0:8089","yarn.scheduler.maximum-allocation-mb":"6144","yarn.resourcemanager.scheduler.monitor.policies":"org.apache.hadoop.yarn.server.resourcemanager.monitor.capacity.ProportionalCapacityPreemptionPolicy","yarn.sharedcache.cleaner.period-mins":"1440","yarn.nodemanager.resource-plugins.gpu.docker-plugin.nvidia-docker-v1.endpoint":"http://localhost:3476/v1.0/docker/cli","yarn.app.mapreduce.am.container.log.limit.kb":"0","ipc.client.connect.retry.interval":"1000","yarn.timeline-service.http-cross-origin.enabled":"true","fs.wasbs.impl":"org.apache.hadoop.fs.azure.NativeAzureFileSystem$Secure","hadoop.proxyuser.httpfs.groups":"*","yarn.federation.subcluster-resolver.class":"org.apache.hadoop.yarn.server.federation.resolver.DefaultSubClusterResolverImpl","yarn.resourcemanager.zk-state-store.parent-path":"/rmstore","mapreduce.jobhistory.cleaner.enable":"true","yarn.timeline-service.client.fd-flush-interval-secs":"10","hadoop.security.kms.client.encrypted.key.cache.expiry":"43200000","hadoop.proxyuser.httpfs.hosts":"*","yarn.client.nodemanager-client-async.thread-pool-max-size":"500","mapreduce.map.maxattempts":"4","yarn.resourcemanager.nm-container-queuing.sorting-nodes-interval-ms":"1000","fs.s3a.committer.staging.tmp.path":"tmp/staging","yarn.nodemanager.sleep-delay-before-sigkill.ms":"250","yarn.resourcemanager.nm-container-queuing.min-queue-wait-time-ms":"10","mapreduce.job.end-notification.retry.attempts":"0","yarn.nodemanager.resource.count-logical-processors-as-cores":"false","mapred.output.direct.NativeS3FileSystem":"true","hadoop.registry.zk.root":"/registry","adl.feature.ownerandgroup.enableupn":"false","yarn.resourcemanager.zk-max-znode-size.bytes":"1048576","mapreduce.job.reduce.shuffle.consumer.plugin.class":"org.apache.hadoop.mapreduce.task.reduce.Shuffle","yarn.resourcemanager.delayed.delegation-token.removal-interval-ms":"*********(redacted)","yarn.nodemanager.localizer.cache.target-size-mb":"10240","fs.s3a.committer.staging.conflict-mode":"fail","mapreduce.client.libjars.wildcard":"true","fs.s3a.committer.staging.unique-filenames":"true","yarn.nodemanager.node-attributes.provider.fetch-timeout-ms":"1200000","fs.s3a.list.version":"2","ftp.client-write-packet-size":"65536","fs.AbstractFileSystem.adl.impl":"org.apache.hadoop.fs.adl.Adl","hadoop.proxyuser.hive.hosts":"*","yarn.node-labels.fs-store.root-dir":"file:///mnt/var/lib/hadoop-yarn/nodelabels","hadoop.security.key.default.cipher":"AES/CTR/NoPadding","yarn.client.failover-retries":"0","fs.s3a.multipart.purge.age":"86400","mapreduce.job.local-fs.single-disk-limit.check.interval-ms":"5000","net.topology.node.switch.mapping.impl":"org.apache.hadoop.net.ScriptBasedMapping","yarn.nodemanager.amrmproxy.address":"0.0.0.0:8049","ipc.server.listen.queue.size":"128","map.sort.class":"org.apache.hadoop.util.QuickSort","fs.viewfs.rename.strategy":"SAME_MOUNTPOINT","hadoop.security.kms.client.authentication.retry-count":"1","fs.permissions.umask-mode":"022","fs.s3a.assumed.role.credentials.provider":"org.apache.hadoop.fs.s3a.SimpleAWSCredentialsProvider","yarn.nodemanager.vmem-check-enabled":"true","yarn.nodemanager.numa-awareness.enabled":"false","yarn.nodemanager.recovery.compaction-interval-secs":"3600","yarn.app.mapreduce.client-am.ipc.max-retries":"3","yarn.federation.registry.base-dir":"yarnfederation/","mapreduce.job.max.map":"-1","mapreduce.job.local-fs.single-disk-limit.bytes":"-1","mapreduce.job.ubertask.maxreduces":"1","hadoop.security.kms.client.encrypted.key.cache.size":"500","hadoop.security.java.secure.random.algorithm":"SHA1PRNG","ha.failover-controller.cli-check.rpc-timeout.ms":"20000","mapreduce.jobhistory.jobname.limit":"50","mapreduce.application.classpath":"\n    $HADOOP_MAPRED_HOME/share/hadoop/mapreduce/*,\n    $HADOOP_MAPRED_HOME/share/hadoop/mapreduce/lib/*,\n    /usr/lib/hadoop-lzo/lib/*,\n    /usr/share/aws/emr/emrfs/conf,\n    /usr/share/aws/emr/emrfs/lib/*,\n    /usr/share/aws/emr/emrfs/auxlib/*,\n    /usr/share/aws/emr/lib/*,\n    /usr/share/aws/emr/ddb/lib/emr-ddb-hadoop.jar,\n    /usr/share/aws/emr/goodies/lib/emr-hadoop-goodies.jar,\n    /usr/share/aws/emr/cloudwatch-sink/lib/*,\n    /usr/share/aws/aws-java-sdk/*\n  ","yarn.client.nodemanager-connect.retry-interval-ms":"10000","yarn.timeline-service.state-store-class":"org.apache.hadoop.yarn.server.timeline.recovery.LeveldbTimelineStateStore","yarn.nodemanager.env-whitelist":"JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME,PATH","yarn.sharedcache.nested-level":"3","yarn.timeline-service.webapp.rest-csrf.methods-to-ignore":"GET,OPTIONS,HEAD","fs.azure.user.agent.prefix":"unknown","yarn.resourcemanager.zk-delegation-token-node.split-index":"*********(redacted)","yarn.nodemanager.numa-awareness.read-topology":"false","yarn.nodemanager.webapp.address":"${yarn.nodemanager.hostname}:8042","rpc.metrics.quantile.enable":"false","yarn.registry.class":"org.apache.hadoop.registry.client.impl.FSRegistryOperationsService","mapreduce.jobhistory.admin.acl":"*","yarn.resourcemanager.system-metrics-publisher.dispatcher.pool-size":"10","yarn.scheduler.queue-placement-rules":"user-group","hadoop.http.authentication.kerberos.keytab":"${user.home}/hadoop.keytab","yarn.resourcemanager.recovery.enabled":"false","yarn.timeline-service.webapp.rest-csrf.enabled":"false","dfs.datanode.available-space-volume-choosing-policy.balanced-space-threshold":"10737418240"},"System Properties":{"java.io.tmpdir":"/tmp","line.separator":"\n","path.separator":":","sun.management.compiler":"HotSpot 64-Bit Tiered Compilers","SPARK_SUBMIT":"true","sun.cpu.endian":"little","java.specification.maintenance.version":"5","java.specification.version":"1.8","java.vm.specification.name":"Java Virtual Machine Specification","java.vendor":"Amazon.com Inc.","java.vm.specification.version":"1.8","user.home":"/home/hadoop","file.encoding.pkg":"sun.io","sun.nio.ch.bugLevel":"","sun.arch.data.model":"64","sun.boot.library.path":"/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre/lib/amd64","user.dir":"/home/hadoop","java.library.path":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native:/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib","sun.cpu.isalist":"","os.arch":"amd64","java.vm.version":"25.382-b05","jetty.git.hash":"27afab2bd37780d179836e313e0fe11bc4fa0ce9","java.endorsed.dirs":"/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre/lib/endorsed","java.runtime.version":"1.8.0_382-b05","java.vm.info":"mixed mode","java.ext.dirs":"/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre/lib/ext:/usr/java/packages/lib/ext","java.runtime.name":"OpenJDK Runtime Environment","EMR_RELEASE_LABEL":"emr-6.3.0","file.separator":"/","java.class.version":"52.0","EMR_CLUSTER_ID":"j-3PCSM5IW1L6A","java.specification.name":"Java Platform API Specification","sun.boot.class.path":"/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre/lib/resources.jar:/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre/lib/rt.jar:/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre/lib/sunrsasign.jar:/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre/lib/jsse.jar:/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre/lib/jce.jar:/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre/lib/charsets.jar:/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre/lib/jfr.jar:/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre/classes","file.encoding":"UTF-8","user.timezone":"UTC","java.specification.vendor":"Oracle Corporation","sun.java.launcher":"SUN_STANDARD","os.version":"4.14.225-169.362.amzn2.x86_64","sun.os.patch.level":"unknown","java.vm.specification.vendor":"Oracle Corporation","sun.jnu.encoding":"UTF-8","user.language":"en","java.vendor.url":"https://aws.amazon.com/corretto/","java.awt.printerjob":"sun.print.PSPrinterJob","java.awt.graphicsenv":"sun.awt.X11GraphicsEnvironment","awt.toolkit":"sun.awt.X11.XToolkit","os.name":"Linux","java.vm.vendor":"Amazon.com Inc.","java.vendor.url.bug":"https://github.com/corretto/corretto-8/issues/","user.name":"hadoop","java.vm.name":"OpenJDK 64-Bit Server VM","sun.java.command":"org.apache.spark.deploy.SparkSubmit --name PySparkShell pyspark-shell","java.home":"/usr/lib/jvm/java-1.8.0-amazon-corretto.x86_64/jre","java.version":"1.8.0_382","sun.io.unicode.encoding":"UnicodeLittle"},"Classpath Entries":{"/usr/lib/spark/jars/jackson-module-jaxb-annotations-2.10.5.jar":"System Classpath","/usr/lib/spark/jars/cats-kernel_2.12-2.0.0-M4.jar":"System Classpath","/usr/lib/spark/jars/commons-lang3-3.10.jar":"System Classpath","/usr/lib/spark/jars/jersey-container-servlet-core-2.30.jar":"System Classpath","/usr/lib/spark/jars/snappy-java-1.1.8.2.jar":"System Classpath","/usr/lib/spark/jars/netty-all-4.1.51.Final.jar":"System Classpath","/usr/lib/spark/jars/jackson-core-asl-1.9.13.jar":"System Classpath","/usr/lib/spark/jars/hadoop-mapreduce-client-common-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/scala-xml_2.12-1.2.0.jar":"System Classpath","/usr/lib/spark/conf/":"System Classpath","/usr/lib/spark/jars/dnsjava-2.1.7.jar":"System Classpath","/usr/lib/spark/jars/aopalliance-repackaged-2.6.1.jar":"System Classpath","/usr/lib/spark/jars/jackson-dataformat-yaml-2.10.5.jar":"System Classpath","/usr/lib/spark/jars/spark-ganglia-lgpl_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/objenesis-2.6.jar":"System Classpath","/usr/lib/spark/jars/osgi-resource-locator-1.0.3.jar":"System Classpath","/usr/lib/spark/jars/libfb303-0.9.3.jar":"System Classpath","/usr/lib/spark/jars/guice-4.0.jar":"System Classpath","/usr/lib/spark/jars/datanucleus-rdbms-4.1.19.jar":"System Classpath","/usr/lib/spark/jars/jakarta.inject-2.6.1.jar":"System Classpath","/usr/lib/spark/jars/spark-launcher_2.12-3.1.1-amzn-0.jar":"System Classpath","/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar":"System Classpath","/usr/lib/spark/jars/machinist_2.12-0.6.8.jar":"System Classpath","/usr/lib/spark/jars/hive-beeline-2.3.7-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/hive-metastore-2.3.7-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/commons-daemon-1.0.13.jar":"System Classpath","/usr/lib/spark/jars/jsr305-3.0.0.jar":"System Classpath","/usr/lib/spark/jars/jmespath-java-1.11.852.jar":"System Classpath","/usr/lib/spark/jars/HikariCP-2.5.1.jar":"System Classpath","/usr/lib/spark/jars/spark-tags_2.12-3.1.1-amzn-0-tests.jar":"System Classpath","/usr/lib/spark/jars/jdo-api-3.0.1.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_system-osx-x86_64-1.1-natives.jar":"System Classpath","/usr/lib/spark/jars/spark-mllib_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/JTransforms-3.1.jar":"System Classpath","/usr/lib/spark/jars/lz4-java-1.7.1.jar":"System Classpath","/usr/lib/spark/jars/kerb-server-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/commons-math3-3.4.1.jar":"System Classpath","/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar":"System Classpath","/usr/lib/spark/jars/orc-shims-1.5.12.jar":"System Classpath","/usr/lib/spark/jars/stax2-api-3.1.4.jar":"System Classpath","/usr/lib/spark/jars/libthrift-0.12.0.jar":"System Classpath","/usr/lib/spark/jars/parquet-jackson-1.10.1-spark-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/kerby-config-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/httpclient-4.5.9.jar":"System Classpath","/usr/lib/spark/jars/spark-network-shuffle_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/jpam-1.1.jar":"System Classpath","/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar":"System Classpath","/usr/lib/spark/jars/kryo-shaded-4.0.2.jar":"System Classpath","/usr/lib/spark/jars/json-smart-2.3.jar":"System Classpath","/usr/lib/spark/jars/commons-cli-1.2.jar":"System Classpath","/usr/lib/spark/jars/scala-compiler-2.12.10.jar":"System Classpath","/usr/lib/spark/jars/commons-beanutils-1.9.4.jar":"System Classpath","/usr/lib/spark/jars/objenesis-2.1.jar":"System Classpath","/usr/lib/spark/jars/curator-client-2.13.0.jar":"System Classpath","/usr/lib/spark/jars/hive-shims-scheduler-2.3.7-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/slf4j-api-1.7.30.jar":"System Classpath","/usr/lib/spark/jars/shims-0.9.0.jar":"System Classpath","/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar":"System Classpath","/usr/lib/spark/jars/curator-framework-2.13.0.jar":"System Classpath","/usr/lib/spark/jars/hive-shims-0.23-2.3.7-amzn-4.jar":"System Classpath","/usr/share/aws/emr/security/conf":"System Classpath","/usr/lib/spark/jars/slf4j-api-1.7.21.jar":"System Classpath","/usr/lib/spark/jars/commons-configuration2-2.1.1.jar":"System Classpath","/usr/lib/spark/jars/istack-commons-runtime-3.0.8.jar":"System Classpath","/usr/lib/spark/jars/hk2-locator-2.6.1.jar":"System Classpath","/usr/lib/spark/jars/commons-lang-2.6.jar":"System Classpath","/usr/lib/spark/jars/jackson-annotations-2.10.5.jar":"System Classpath","/usr/lib/spark/jars/log4j-1.2.17.jar":"System Classpath","/usr/lib/spark/jars/spark-repl_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/emrfs-hadoop-assembly-2.46.0.jar":"System Classpath","/usr/lib/spark/jars/curator-recipes-2.13.0.jar":"System Classpath","/usr/lib/spark/jars/jackson-databind-2.10.5.jar":"System Classpath","/usr/lib/spark/jars/jersey-client-2.30.jar":"System Classpath","/usr/lib/spark/jars/breeze-macros_2.12-1.0.jar":"System Classpath","/usr/lib/spark/jars/orc-mapreduce-1.5.12.jar":"System Classpath","/usr/lib/spark/jars/hadoop-common-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/spark-yarn_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/kerb-core-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/kerby-asn1-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/json4s-ast_2.12-3.7.0-M5.jar":"System Classpath","/usr/lib/spark/jars/py4j-0.10.9.jar":"System Classpath","/usr/lib/spark/jars/paranamer-2.8.jar":"System Classpath","/usr/lib/spark/jars/hadoop-yarn-server-web-proxy-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/hive-vector-code-gen-2.3.7-amzn-4.jar":"System Classpath","/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar":"System Classpath","/usr/lib/spark/jars/jakarta.annotation-api-1.3.5.jar":"System Classpath","/usr/lib/spark/jars/janino-3.0.16.jar":"System Classpath","/usr/lib/spark/jars/threeten-extra-1.5.0.jar":"System Classpath","/usr/lib/spark/jars/hive-llap-common-2.3.7-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/commons-collections-3.2.2.jar":"System Classpath","/usr/lib/spark/jars/commons-logging-1.1.3.jar":"System Classpath","/usr/lib/spark/jars/hive-cli-2.3.7-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/jackson-core-2.10.5.jar":"System Classpath","/usr/lib/spark/jars/chill-java-0.9.5.jar":"System Classpath","/usr/lib/spark/jars/nimbus-jose-jwt-4.41.1.jar":"System Classpath","/usr/lib/spark/jars/metrics-jvm-4.1.1.jar":"System Classpath","/usr/lib/spark/jars/re2j-1.1.jar":"System Classpath","/usr/lib/spark/jars/jackson-datatype-jsr310-2.11.2.jar":"System Classpath","/usr/lib/spark/jars/arrow-vector-2.0.0.jar":"System Classpath","/usr/lib/hadoop-lzo/lib/hadoop-lzo-0.4.19.jar":"System Classpath","/usr/lib/spark/jars/commons-codec-1.10.jar":"System Classpath","/usr/lib/spark/jars/compress-lzf-1.0.3.jar":"System Classpath","/usr/lib/spark/jars/bcprov-jdk15on-1.60.jar":"System Classpath","/usr/lib/spark/jars/spark-sql_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/jersey-common-2.30.jar":"System Classpath","/usr/lib/spark/jars/javax.jdo-3.2.0-m3.jar":"System Classpath","/usr/share/aws/aws-java-sdk/aws-java-sdk-bundle-1.11.977.jar":"System Classpath","/usr/share/aws/emr/security/lib/*":"System Classpath","/usr/lib/spark/jars/kerb-util-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_ref-linux-i686-1.1-natives.jar":"System Classpath","/usr/lib/spark/jars/hive-service-rpc-3.1.2.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_system-linux-armhf-1.1-natives.jar":"System Classpath","/usr/lib/spark/jars/jta-1.1.jar":"System Classpath","/usr/lib/spark/jars/commons-net-3.1.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_system-linux-i686-1.1-natives.jar":"System Classpath","/usr/lib/spark/jars/slf4j-log4j12-1.7.30.jar":"System Classpath","/usr/lib/spark/jars/json-1.8.jar":"System Classpath","/usr/lib/spark/jars/macro-compat_2.12-1.1.1.jar":"System Classpath","/usr/lib/spark/jars/stream-2.9.6.jar":"System Classpath","/usr/lib/spark/jars/aircompressor-0.10.jar":"System Classpath","/usr/lib/spark/jars/jackson-module-scala_2.12-2.10.5.jar":"System Classpath","/usr/lib/spark/jars/hive-exec-2.3.7-amzn-4-core.jar":"System Classpath","/usr/lib/spark/jars/metrics-json-4.1.1.jar":"System Classpath","/usr/lib/spark/jars/parquet-column-1.10.1-spark-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/httpcore-4.4.11.jar":"System Classpath","/usr/lib/spark/jars/commons-io-2.5.jar":"System Classpath","/usr/lib/spark/jars/parquet-format-2.4.0.jar":"System Classpath","/usr/lib/spark/jars/ehcache-3.3.1.jar":"System Classpath","/usr/lib/spark/jars/aws-glue-sdk-1.12.0.jar":"System Classpath","/usr/lib/spark/jars/native_ref-java-1.1.jar":"System Classpath","/usr/lib/spark/jars/hive-storage-api-2.7.2.jar":"System Classpath","/etc/hadoop/conf/":"System Classpath","/usr/lib/spark/jars/native_system-java-1.1.jar":"System Classpath","/usr/lib/spark/jars/remotetea-oncrpc-1.1.2.jar":"System Classpath","/usr/lib/spark/jars/snakeyaml-1.26.jar":"System Classpath","/usr/lib/spark/jars/woodstox-core-5.0.3.jar":"System Classpath","/usr/lib/spark/jars/htrace-core4-4.1.0-incubating.jar":"System Classpath","/usr/lib/spark/jars/jline-2.14.6.jar":"System Classpath","/usr/lib/spark/jars/jackson-jaxrs-json-provider-2.10.5.jar":"System Classpath","/usr/lib/spark/jars/spark-streaming_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/zstd-jni-1.4.8-1.jar":"System Classpath","/usr/lib/spark/jars/accessors-smart-1.2.jar":"System Classpath","/usr/lib/spark/jars/jakarta.activation-api-1.2.1.jar":"System Classpath","/usr/lib/spark/jars/hadoop-yarn-common-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/activation-1.1.1.jar":"System Classpath","/usr/lib/spark/jars/hadoop-yarn-client-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_ref-win-x86_64-1.1-natives.jar":"System Classpath","/usr/lib/spark/jars/spark-hive-thriftserver_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_ref-linux-armhf-1.1-natives.jar":"System Classpath","/usr/lib/spark/jars/flatbuffers-java-1.9.0.jar":"System Classpath","/usr/lib/spark/jars/shapeless_2.12-2.3.3.jar":"System Classpath","/usr/lib/spark/jars/jetty-rewrite-9.3.27.v20190418.jar":"System Classpath","/usr/lib/spark/jars/metrics-core-4.1.1.jar":"System Classpath","/usr/lib/spark/jars/leveldbjni-all-1.8.jar":"System Classpath","/usr/lib/spark/jars/spire-platform_2.12-0.17.0-M1.jar":"System Classpath","/usr/lib/spark/jars/gmetric4j-1.0.10.jar":"System Classpath","/usr/lib/spark/jars/javax.inject-1.jar":"System Classpath","/usr/lib/spark/jars/commons-compress-1.20.jar":"System Classpath","/usr/lib/spark/jars/univocity-parsers-2.9.1.jar":"System Classpath","/usr/lib/spark/jars/hive-serde-2.3.7-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/jersey-server-2.30.jar":"System Classpath","/usr/lib/spark/jars/kerby-xdr-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/javax.servlet-api-3.1.0.jar":"System Classpath","/usr/lib/spark/jars/hive-shims-common-2.3.7-amzn-4.jar":"System Classpath","/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar":"System Classpath","/usr/lib/spark/jars/gson-2.2.4.jar":"System Classpath","/usr/lib/spark/jars/hadoop-client-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/spark-core_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/spire-macros_2.12-0.17.0-M1.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_system-win-x86_64-1.1-natives.jar":"System Classpath","/usr/lib/spark/jars/jcl-over-slf4j-1.7.21.jar":"System Classpath","/usr/lib/spark/jars/transaction-api-1.1.jar":"System Classpath","/usr/lib/spark/jars/kerby-util-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/avro-mapred-1.8.2-hadoop2.jar":"System Classpath","/usr/lib/spark/jars/protobuf-java-2.5.0.jar":"System Classpath","/usr/lib/spark/jars/emr-spark-goodies.jar":"System Classpath","/usr/lib/spark/jars/kerb-client-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/jaxb-api-2.2.11.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_ref-linux-x86_64-1.1-natives.jar":"System Classpath","/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar":"System Classpath","/usr/lib/spark/jars/jersey-media-jaxb-2.30.jar":"System Classpath","/usr/lib/spark/jars/kerby-pkix-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/RoaringBitmap-0.9.0.jar":"System Classpath","/usr/lib/spark/jars/parquet-common-1.10.1-spark-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/datanucleus-core-4.1.17.jar":"System Classpath","/usr/lib/spark/jars/minlog-1.3.0.jar":"System Classpath","/usr/lib/spark/jars/jackson-mapper-asl-1.9.13.jar":"System Classpath","/usr/lib/spark/jars/zjsonpatch-0.3.0.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_system-linux-x86_64-1.1-natives.jar":"System Classpath","/usr/lib/spark/jars/lombok-1.18.4.jar":"System Classpath","/usr/lib/spark/jars/okhttp-2.7.5.jar":"System Classpath","/usr/lib/spark/jars/jakarta.servlet-api-4.0.3.jar":"System Classpath","/usr/lib/spark/jars/jackson-jaxrs-base-2.10.5.jar":"System Classpath","/usr/lib/spark/jars/jniloader-1.1.jar":"System Classpath","/usr/lib/spark/jars/spark-catalyst_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/avro-1.8.2.jar":"System Classpath","/usr/lib/spark/jars/json4s-core_2.12-3.7.0-M5.jar":"System Classpath","/usr/lib/spark/jars/annotations-16.0.2.jar":"System Classpath","/usr/lib/spark/jars/oro-2.0.8.jar":"System Classpath","/usr/lib/spark/jars/automaton-1.11-8.jar":"System Classpath","/usr/lib/spark/jars/token-provider-1.0.1.jar":"System Classpath","/docker/usr/share/aws/emr/security/conf":"System Classpath","/usr/lib/spark/jars/arrow-memory-core-2.0.0.jar":"System Classpath","/usr/lib/spark/jars/hadoop-hdfs-client-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/xz-1.5.jar":"System Classpath","/usr/lib/spark/jars/parquet-hadoop-1.10.1-spark-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/commons-pool-1.5.4.jar":"System Classpath","/usr/lib/spark/jars/kerb-common-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/bonecp-0.8.0.RELEASE.jar":"System Classpath","/usr/lib/spark/jars/hk2-utils-2.6.1.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_ref-osx-x86_64-1.1-natives.jar":"System Classpath","/usr/lib/spark/jars/scala-collection-compat_2.12-2.1.1.jar":"System Classpath","/usr/lib/spark/jars/json4s-jackson_2.12-3.7.0-M5.jar":"System Classpath","/usr/lib/spark/jars/okhttp-3.12.12.jar":"System Classpath","/usr/lib/spark/jars/commons-dbcp-1.4.jar":"System Classpath","/usr/lib/spark/jars/jersey-hk2-2.30.jar":"System Classpath","/usr/lib/spark/jars/hive-jdbc-2.3.7-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/metrics-jmx-4.1.1.jar":"System Classpath","/usr/lib/spark/jars/derby-10.12.1.1.jar":"System Classpath","/usr/lib/spark/jars/scala-library-2.12.10.jar":"System Classpath","/usr/lib/spark/jars/commons-crypto-1.1.0.jar":"System Classpath","/usr/lib/spark/jars/metrics-graphite-4.1.1.jar":"System Classpath","/usr/lib/spark/jars/JLargeArrays-1.5.jar":"System Classpath","/usr/lib/spark/jars/zookeeper-3.4.14.jar":"System Classpath","/usr/lib/spark/jars/antlr-runtime-3.5.2.jar":"System Classpath","/usr/lib/spark/jars/generex-1.0.2.jar":"System Classpath","/usr/lib/spark/jars/spark-kvstore_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar":"System Classpath","/usr/lib/spark/jars/commons-text-1.6.jar":"System Classpath","/docker/usr/lib/hadoop/hadoop-aws.jar":"System Classpath","/docker/usr/share/aws/aws-java-sdk/*":"System Classpath","/usr/lib/spark/jars/hadoop-mapreduce-client-core-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/avro-ipc-1.8.2.jar":"System Classpath","/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar":"System Classpath","/usr/lib/spark/jars/breeze_2.12-1.0.jar":"System Classpath","/usr/lib/spark/jars/spire-util_2.12-0.17.0-M1.jar":"System Classpath","/usr/lib/spark/jars/jcl-over-slf4j-1.7.30.jar":"System Classpath","/usr/lib/spark/jars/datanucleus-api-jdo-4.2.4.jar":"System Classpath","/usr/lib/spark/jars/spark-network-common_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/dropwizard-metrics-hadoop-metrics2-reporter-0.1.2.jar":"System Classpath","/usr/lib/spark/jars/guice-servlet-4.0.jar":"System Classpath","/usr/lib/spark/jars/jaxb-runtime-2.3.2.jar":"System Classpath","/usr/lib/spark/jars/bcpkix-jdk15on-1.60.jar":"System Classpath","/usr/lib/hadoop-lzo/lib/hadoop-lzo.jar":"System Classpath","/usr/lib/spark/jars/joda-time-2.10.5.jar":"System Classpath","/usr/lib/spark/jars/arpack_combined_all-0.1.jar":"System Classpath","/usr/lib/spark/jars/aopalliance-1.0.jar":"System Classpath","/usr/lib/spark/jars/jsp-api-2.1.jar":"System Classpath","/usr/lib/spark/jars/javassist-3.25.0-GA.jar":"System Classpath","/usr/lib/spark/jars/jackson-module-paranamer-2.10.5.jar":"System Classpath","/usr/lib/spark/jars/ion-java-1.0.2.jar":"System Classpath","/usr/lib/spark/jars/hadoop-annotations-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/spire_2.12-0.17.0-M1.jar":"System Classpath","/usr/lib/spark/jars/spark-hive_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/core-1.1.2.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_system-win-i686-1.1-natives.jar":"System Classpath","/usr/lib/spark/jars/kerb-admin-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/bcprov-ext-jdk15on-1.66.jar":"System Classpath","/usr/lib/spark/jars/hive-shims-2.3.7-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/arrow-format-2.0.0.jar":"System Classpath","/usr/lib/spark/jars/hadoop-yarn-api-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/jakarta.validation-api-2.0.2.jar":"System Classpath","/usr/lib/spark/jars/orc-core-1.5.12.jar":"System Classpath","/usr/lib/spark/jars/spark-unsafe_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/okio-1.14.0.jar":"System Classpath","/usr/lib/spark/jars/spark-sketch_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/scala-reflect-2.12.10.jar":"System Classpath","/usr/lib/spark/jars/secret-agent-interface-1.4.0.jar":"System Classpath","/usr/lib/spark/jars/hive-common-2.3.7-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/fluent-hc-4.5.6.jar":"System Classpath","/usr/lib/spark/jars/geronimo-jcache_1.0_spec-1.0-alpha-1.jar":"System Classpath","/usr/lib/spark/jars/arrow-memory-netty-2.0.0.jar":"System Classpath","/usr/lib/spark/jars/velocity-1.5.jar":"System Classpath","/docker/usr/share/aws/emr/security/lib/*":"System Classpath","/usr/lib/spark/jars/chill_2.12-0.9.5.jar":"System Classpath","/usr/lib/spark/jars/super-csv-2.2.0.jar":"System Classpath","/usr/lib/spark/jars/jodd-core-3.5.2.jar":"System Classpath","/usr/lib/spark/jars/spark-graphx_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/hadoop-yarn-registry-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/mockito-core-1.10.19.jar":"System Classpath","/usr/lib/spark/jars/ivy-2.4.0.jar":"System Classpath","/usr/lib/spark/jars/kerb-simplekdc-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/scala-parser-combinators_2.12-1.1.2.jar":"System Classpath","/usr/lib/spark/jars/hk2-api-2.6.1.jar":"System Classpath","/usr/lib/hadoop/hadoop-aws.jar":"System Classpath","/usr/lib/spark/jars/spark-mllib-local_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/jakarta.ws.rs-api-2.1.6.jar":"System Classpath","/usr/lib/spark/jars/jul-to-slf4j-1.7.30.jar":"System Classpath","/usr/lib/spark/jars/ST4-4.0.4.jar":"System Classpath","/usr/lib/spark/jars/opencsv-2.3.jar":"System Classpath","/usr/lib/spark/jars/stax-api-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/javolution-5.5.1.jar":"System Classpath","/usr/lib/spark/jars/spark-tags_2.12-3.1.1-amzn-0.jar":"System Classpath","/usr/lib/spark/jars/hadoop-mapreduce-client-jobclient-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/logging-interceptor-3.12.12.jar":"System Classpath","/usr/lib/spark/jars/xbean-asm7-shaded-4.15.jar":"System Classpath","/usr/lib/spark/jars/mariadb-connector-java.jar":"System Classpath","/usr/lib/spark/jars/algebra_2.12-2.0.0-M2.jar":"System Classpath","/usr/lib/spark/jars/kerb-crypto-1.0.1.jar":"System Classpath","/usr/lib/spark/jars/jersey-container-servlet-2.30.jar":"System Classpath","/usr/lib/spark/jars/kerb-identity-1.0.1.jar":"System Classpath","/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar":"System Classpath","/usr/lib/spark/jars/parquet-encoding-1.10.1-spark-amzn-4.jar":"System Classpath","/usr/lib/spark/jars/guava-14.0.1.jar":"System Classpath","/usr/lib/spark/jars/antlr4-runtime-4.8-1.jar":"System Classpath","/usr/lib/spark/jars/hadoop-auth-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/commons-compiler-3.0.16.jar":"System Classpath","/usr/lib/spark/jars/jcip-annotations-1.0-1.jar":"System Classpath","/usr/lib/spark/jars/hadoop-yarn-server-common-3.2.1-amzn-3.jar":"System Classpath","/usr/lib/spark/jars/pyrolite-4.30.jar":"System Classpath","/usr/lib/spark/jars/json4s-scalap_2.12-3.7.0-M5.jar":"System Classpath","/usr/lib/spark/jars/jakarta.xml.bind-api-2.3.2.jar":"System Classpath","/usr/lib/spark/jars/netlib-native_ref-win-i686-1.1-natives.jar":"System Classpath","/docker/usr/lib/hadoop-lzo/lib/*":"System Classpath"}}
{"Event":"SparkListenerApplicationStart","App Name":"PySparkShell","App ID":"application_1691339165261_0001","Timestamp":1691340091107,"User":"hadoop"}
{"Event":"SparkListenerExecutorAdded","Timestamp":1691340117706,"Executor ID":"2","Executor Info":{"Host":"ip-10-0-10-52.us-west-2.compute.internal","Total Cores":4,"Log Urls":{"stdout":"http://ip-10-0-10-52.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000004/hadoop/stdout?start=-4096","stderr":"http://ip-10-0-10-52.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000004/hadoop/stderr?start=-4096"},"Attributes":{"NM_HTTP_ADDRESS":"ip-10-0-10-52.us-west-2.compute.internal:8042","USER":"hadoop","LOG_FILES":"stderr,stdout","NM_HTTP_PORT":"8042","CLUSTER_ID":"","NM_PORT":"8041","HTTP_SCHEME":"http://","NM_HOST":"ip-10-0-10-52.us-west-2.compute.internal","CONTAINER_ID":"container_1691339165261_0001_01_000004"},"Resources":{},"Resource Profile Id":0}}
{"Event":"SparkListenerBlockManagerAdded","Block Manager ID":{"Executor ID":"2","Host":"ip-10-0-10-52.us-west-2.compute.internal","Port":42251},"Maximum Memory":2199493017,"Timestamp":1691340118225,"Maximum Onheap Memory":2199493017,"Maximum Offheap Memory":0}
{"Event":"SparkListenerExecutorAdded","Timestamp":1691340121623,"Executor ID":"1","Executor Info":{"Host":"ip-10-0-10-231.us-west-2.compute.internal","Total Cores":4,"Log Urls":{"stdout":"http://ip-10-0-10-231.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000002/hadoop/stdout?start=-4096","stderr":"http://ip-10-0-10-231.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000002/hadoop/stderr?start=-4096"},"Attributes":{"NM_HTTP_ADDRESS":"ip-10-0-10-231.us-west-2.compute.internal:8042","USER":"hadoop","LOG_FILES":"stderr,stdout","NM_HTTP_PORT":"8042","CLUSTER_ID":"","NM_PORT":"8041","HTTP_SCHEME":"http://","NM_HOST":"ip-10-0-10-231.us-west-2.compute.internal","CONTAINER_ID":"container_1691339165261_0001_01_000002"},"Resources":{},"Resource Profile Id":0}}
{"Event":"SparkListenerBlockManagerAdded","Block Manager ID":{"Executor ID":"1","Host":"ip-10-0-10-231.us-west-2.compute.internal","Port":36789},"Maximum Memory":2199493017,"Timestamp":1691340122139,"Maximum Onheap Memory":2199493017,"Maximum Offheap Memory":0}
{"Event":"SparkListenerBlockManagerRemoved","Block Manager ID":{"Executor ID":"2","Host":"ip-10-0-10-52.us-west-2.compute.internal","Port":42251},"Timestamp":1691340181036}
{"Event":"SparkListenerExecutorRemoved","Timestamp":1691340181066,"Executor ID":"2","Removed Reason":"Container container_1691339165261_0001_01_000004 exited from explicit termination request."}
{"Event":"SparkListenerBlockManagerRemoved","Block Manager ID":{"Executor ID":"1","Host":"ip-10-0-10-231.us-west-2.compute.internal","Port":36789},"Timestamp":1691340184311}
{"Event":"SparkListenerExecutorRemoved","Timestamp":1691340184318,"Executor ID":"1","Removed Reason":"Container container_1691339165261_0001_01_000002 exited from explicit termination request."}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":0,"description":"csv at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nGlobalLimit 1\n+- LocalLimit 1\n   +- Filter (length(trim(value#6, None)) > 0)\n      +- Project [value#0 AS value#6]\n         +- Project [value#0]\n            +- Relation[value#0] text\n\n== Analyzed Logical Plan ==\nvalue: string\nGlobalLimit 1\n+- LocalLimit 1\n   +- Filter (length(trim(value#6, None)) > 0)\n      +- Project [value#0 AS value#6]\n         +- Project [value#0]\n            +- Relation[value#0] text\n\n== Optimized Logical Plan ==\nGlobalLimit 1\n+- LocalLimit 1\n   +- Filter (length(trim(value#0, None)) > 0)\n      +- Relation[value#0] text\n\n== Physical Plan ==\nCollectLimit 1\n+- *(1) Filter (length(trim(value#0, None)) > 0)\n   +- FileScan text [value#0] Batched: false, DataFilters: [(length(trim(value#0, None)) > 0)], Format: Text, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<value:string>\n","sparkPlanInfo":{"nodeName":"CollectLimit","simpleString":"CollectLimit 1","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Filter","simpleString":"Filter (length(trim(value#0, None)) > 0)","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan text ","simpleString":"FileScan text [value#0] Batched: false, DataFilters: [(length(trim(value#0, None)) > 0)], Format: Text, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<value:string>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv]","ReadSchema":"struct<value:string>","Format":"Text","Batched":"false","PartitionFilters":"[]","PushedFilters":"[]","DataFilters":"[(length(trim(value#0, None)) > 0)]"},"metrics":[{"name":"number of output rows","accumulatorId":13,"metricType":"sum"},{"name":"number of files read","accumulatorId":14,"metricType":"sum"},{"name":"metadata time","accumulatorId":15,"metricType":"timing"},{"name":"size of files read","accumulatorId":16,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":12,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":11,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":9,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":10,"metricType":"nsTiming"},{"name":"records read","accumulatorId":7,"metricType":"sum"},{"name":"local bytes read","accumulatorId":5,"metricType":"size"},{"name":"fetch wait time","accumulatorId":6,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":3,"metricType":"size"},{"name":"local blocks read","accumulatorId":2,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":1,"metricType":"sum"},{"name":"remote bytes read to disk","accumulatorId":4,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":8,"metricType":"size"}]},"time":1691340240396}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":0,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":0,"accumUpdates":[[14,1],[15,5],[16,196138]]}
{"Event":"SparkListenerJobStart","Job ID":0,"Submission Time":1691340241897,"Stage Infos":[{"Stage ID":0,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":3,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"4\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[2],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":0,"Name":"FileScanRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":2,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"0\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[1],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":1,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[0],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[0],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.driver.memory":"2048M","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"0","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":0,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":3,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"4\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[2],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":0,"Name":"FileScanRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":2,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"0\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[1],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":1,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[0],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340242019,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.driver.memory":"2048M","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"0","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerExecutorAdded","Timestamp":1691340247707,"Executor ID":"3","Executor Info":{"Host":"ip-10-0-10-52.us-west-2.compute.internal","Total Cores":4,"Log Urls":{"stdout":"http://ip-10-0-10-52.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000005/hadoop/stdout?start=-4096","stderr":"http://ip-10-0-10-52.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000005/hadoop/stderr?start=-4096"},"Attributes":{"NM_HTTP_ADDRESS":"ip-10-0-10-52.us-west-2.compute.internal:8042","USER":"hadoop","LOG_FILES":"stderr,stdout","NM_HTTP_PORT":"8042","CLUSTER_ID":"","NM_PORT":"8041","HTTP_SCHEME":"http://","NM_HOST":"ip-10-0-10-52.us-west-2.compute.internal","CONTAINER_ID":"container_1691339165261_0001_01_000005"},"Resources":{},"Resource Profile Id":0}}
{"Event":"SparkListenerBlockManagerAdded","Block Manager ID":{"Executor ID":"3","Host":"ip-10-0-10-52.us-west-2.compute.internal","Port":35449},"Maximum Memory":2199493017,"Timestamp":1691340248156,"Maximum Onheap Memory":2199493017,"Maximum Offheap Memory":0}
{"Event":"SparkListenerTaskStart","Stage ID":0,"Stage Attempt ID":0,"Task Info":{"Task ID":0,"Index":0,"Attempt":0,"Launch Time":1691340248352,"Executor ID":"3","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":0,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":0,"Index":0,"Attempt":0,"Launch Time":1691340248352,"Executor ID":"3","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340254104,"Failed":false,"Killed":false,"Accumulables":[{"ID":12,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":13,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":17,"Name":"internal.metrics.executorDeserializeTime","Update":2185,"Value":2185,"Internal":true,"Count Failed Values":true},{"ID":18,"Name":"internal.metrics.executorDeserializeCpuTime","Update":1100024902,"Value":1100024902,"Internal":true,"Count Failed Values":true},{"ID":19,"Name":"internal.metrics.executorRunTime","Update":3328,"Value":3328,"Internal":true,"Count Failed Values":true},{"ID":20,"Name":"internal.metrics.executorCpuTime","Update":2133968574,"Value":2133968574,"Internal":true,"Count Failed Values":true},{"ID":21,"Name":"internal.metrics.resultSize","Update":1658,"Value":1658,"Internal":true,"Count Failed Values":true},{"ID":22,"Name":"internal.metrics.jvmGCTime","Update":215,"Value":215,"Internal":true,"Count Failed Values":true},{"ID":23,"Name":"internal.metrics.resultSerializationTime","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":38,"Name":"internal.metrics.input.bytesRead","Update":15699,"Value":15699,"Internal":true,"Count Failed Values":true},{"ID":39,"Name":"internal.metrics.input.recordsRead","Update":1,"Value":1,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":2185,"Executor Deserialize CPU Time":1100024902,"Executor Run Time":3328,"Executor CPU Time":2133968574,"Peak Execution Memory":0,"Result Size":1658,"JVM GC Time":215,"Result Serialization Time":1,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":15699,"Records Read":1},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":0,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":3,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"4\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[2],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":0,"Name":"FileScanRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":2,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"0\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[1],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":1,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"3\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[0],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340242019,"Completion Time":1691340254127,"Accumulables":[{"ID":12,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":13,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":17,"Name":"internal.metrics.executorDeserializeTime","Value":2185,"Internal":true,"Count Failed Values":true},{"ID":18,"Name":"internal.metrics.executorDeserializeCpuTime","Value":1100024902,"Internal":true,"Count Failed Values":true},{"ID":19,"Name":"internal.metrics.executorRunTime","Value":3328,"Internal":true,"Count Failed Values":true},{"ID":20,"Name":"internal.metrics.executorCpuTime","Value":2133968574,"Internal":true,"Count Failed Values":true},{"ID":21,"Name":"internal.metrics.resultSize","Value":1658,"Internal":true,"Count Failed Values":true},{"ID":22,"Name":"internal.metrics.jvmGCTime","Value":215,"Internal":true,"Count Failed Values":true},{"ID":23,"Name":"internal.metrics.resultSerializationTime","Value":1,"Internal":true,"Count Failed Values":true},{"ID":38,"Name":"internal.metrics.input.bytesRead","Value":15699,"Internal":true,"Count Failed Values":true},{"ID":39,"Name":"internal.metrics.input.recordsRead","Value":1,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":0,"Completion Time":1691340254138,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":0,"timePerRule":{"PruneFileSourcePartitions":2869920,"ReassignLambdaVariableID":2232176,"PushPredicateThroughNonJoin":30490,"Analyzer$ResolveEncodersInUDF":60018,"Analyzer$HandleNullInputsForUDF":56025,"OptimizeUpdateFields":247810,"Analyzer$ResolveSubqueryColumnAliases":12197,"ResolveTimeZone":29813,"Analyzer$ResolveNamespace":12148,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":16559,"RelationConversions":12179,"RewriteCorrelatedScalarSubquery":4658420,"RemoveLiteralFromGroupExpressions":997828,"PushProjectionThroughUnion":818482,"EliminateSubqueryAliases":1004917,"ResolveCatalogs":12745,"PushLeftSemiLeftAntiThroughJoin":1627394,"Analyzer$ResolveUserSpecifiedColumns":10875,"FlattenScalarSubqueriesWithAggregates":1276912,"LikeSimplification":1042851,"CollapseRepartition":1283643,"ResolveHints$ResolveCoalesceHints":14680,"Analyzer$ExtractGenerator":82635,"RewriteIntersectAll":2888248,"Analyzer$AddMetadataColumns":156929,"ResolveHints$ResolveJoinStrategyHints":18470,"TypeCoercion$MapZipWithCoercion":25639,"NullPropagation":3538940,"EliminateAggregateFilter":2330737,"PullupCorrelatedPredicates":2801435,"UpdateOuterReferences":19612,"ExtractPythonUDFs":3119463,"Analyzer$WindowsSubstitution":37092,"CombineUnions":731512,"ExtractGroupingPythonUDFFromAggregate":776283,"ReorderAssociativeOperator":8773506,"CleanupDynamicPruningFilters":987644,"ResolveHints$RemoveAllHints":17084,"SimplifyBinaryComparison":5321028,"ResolveTableValuedFunctions":15930,"EliminateSerialization":910612,"OptimizeJsonExprs":2277748,"GetCurrentDatabaseAndCatalog":4549992,"TypeCoercion$BooleanEquality":28821,"package$ExpressionCanonicalizer$CleanExpressions":904001,"EliminateLimits":1899663,"ReplaceIntersectWithSemiJoin":1195212,"ConstantPropagation":937866,"PushExtraPredicateThroughJoin":1867219,"CostBasedJoinReorder":77875,"Analyzer$ResolveReferences":113620,"CTESubstitution":881921,"RemoveRedundantAliases":4831767,"TypeCoercion$ImplicitTypeCasts":28072,"RewriteExceptAll":1340036,"UpdateAttributeNullability":1180406,"PropagateEmptyRelation":1670468,"InferFiltersFromGenerate":1121197,"SimplifyCasts":179180,"EliminateMapObjects":770092,"DetectAmbiguousSelfJoin":79818,"ReplaceExpressions":1068343,"ResolveInlineTables":15445,"ResolveUnion":75321,"OptimizeIn":3816010,"CollapseWindow":1560232,"TypeCoercion$IfCoercion":26744,"ResolveSessionCatalog":17822,"PartitionPruning":1520356,"BooleanSimplification":2655772,"TypeCoercion$PromoteStrings":39920,"Analyzer$ResolveAliases":12186,"DecimalAggregates":4276149,"PruneFilters":9909626,"PruneHiveTablePartitions":1020618,"Analyzer$ResolveMissingReferences":11074,"TransposeWindow":1208947,"Analyzer$ResolveRelations":22812,"EliminateUnions":16609,"RewritePredicateSubquery":4247374,"ObjectSerializerPruning":2736648,"LimitPushDown":1042254,"SimplifyCaseConversionExpressions":1396204,"ResolvePartitionSpec":13078,"Analyzer$ResolveNaturalAndUsingJoin":12624,"UnwrapCastInBinaryComparison":1553273,"EliminateView":936405,"CombineTypedFilters":784712,"ReplaceUpdateFieldsExpression":772115,"OptimizeLimitZero":1074044,"CheckCartesianProducts":149686,"ExtractPythonUDFFromAggregate":944061,"Analyzer$ExtractWindowExpressions":20002,"ReplaceExceptWithAntiJoin":1171221,"ResolveLambdaVariables":17599,"FallBackFileSourceV2":11031,"Analyzer$ResolveTables":29293,"SubstituteUnresolvedOrdinals":12240,"TypeCoercion$CaseWhenCoercion":24816,"DecimalPrecision":72363,"EliminateSorts":55389,"PushDownLeftSemiAntiJoin":2517450,"ExtractPythonUDFFromJoinCondition":1138122,"TypeCoercion$StackCoercion":27214,"Analyzer$ResolveAggAliasInGroupBy":11677,"TypeCoercion$StringLiteralCoercion":30390,"FoldablePropagation":3769543,"ResolveHiveSerdeTable":11914,"V2ScanRelationPushDown":8424889,"EliminateDistinct":538190,"InferFiltersFromConstraints":8416752,"DetermineTableStats":16041,"Analyzer$PullOutNondeterministic":1035273,"Analyzer$ResolveFunctions":24233,"ReplaceNullWithFalseInPredicate":1734839,"ResolveHigherOrderFunctions":26566,"Analyzer$ResolvePivot":11770,"CollapseProject":7100338,"Analyzer$ResolveNewInstance":16280,"ColumnPruning":11291508,"Analyzer$ResolveWindowOrder":81806,"TypeCoercion$ConcatCoercion":44601,"PushDownPredicates":9126870,"TimeWindowing":153349,"Optimizer$OptimizeSubqueries":1046109,"RewriteNonCorrelatedExists":1084004,"TypeCoercion$Division":28277,"ComputeCurrentTime":1755206,"ResolveCreateNamedStruct":33265,"TypeCoercion$EltCoercion":39031,"ConvertToLocalRelation":989516,"OptimizeWindowFunctions":1215009,"RemoveRepetitionFromGroupExpressions":858835,"ReplaceDistinctWithAggregate":806397,"PreprocessTableCreation":11836,"ResolveSQLOnFile":11622,"Analyzer$ResolveSubquery":28717,"CombineConcats":554072,"Analyzer$ResolveGroupingAnalytics":18946,"Analyzer$ResolveBinaryArithmetic":42846,"RemoveDispensableExpressions":779694,"Analyzer$ResolveAlterTableChanges":16860,"ResolveEncodersInScalaAgg":45362,"TypeCoercion$IntegralDivision":27294,"Analyzer$ResolveWindowFrame":27396,"Analyzer$ResolveDeserializer":18240,"RewriteDistinctAggregates":822099,"RemoveNoopOperators":1269045,"Analyzer$ResolveAggregateFunctions":12080,"NormalizeFloatingNumbers":1241082,"ReorderJoin":2181757,"Analyzer$ResolveUpCast":15371,"Analyzer$ResolveGenerate":13808,"TypeCoercion$WidenSetOperationTypes":214108,"EliminateOuterJoin":1085175,"SimplifyExtractValueOps":4779742,"OptimizeMetadataOnlyQuery":60104,"EliminateResolvedHint":1438579,"Analyzer$ResolveInsertInto":10624,"ReplaceExceptWithFilter":1140382,"CleanupAliases":25169,"SchemaPruning":6605863,"ResolveHints$DisableHints":37254,"Analyzer$ResolveOutputRelation":11956,"BloomFilterJoinRule":2770924,"HiveAnalysis":11430,"Analyzer$ResolveRandomSeed":11400,"TypeCoercion$WindowFrameCoercion":25799,"ConstantFolding":2840435,"TypeCoercion$DateTimeOperations":26269,"ResolveNoopDropTable":15677,"TypeCoercion$InConversion":43713,"FindDataSourceTable":13763,"ApplyCharTypePadding":57288,"SimplifyConditionals":2139385,"DataSourceAnalysis":14614,"TypeCoercion$FunctionArgumentConversion":37130,"Analyzer$GlobalAggregates":11362,"Analyzer$LookupFunctions":59107,"CombineFilters":137146,"ReplaceDeduplicateWithAggregate":2288861,"PreprocessTableInsertion":10937},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":1,"Analyzer$HandleNullInputsForUDF":1,"OptimizeUpdateFields":4,"Analyzer$ResolveSubqueryColumnAliases":1,"ResolveTimeZone":1,"Analyzer$ResolveNamespace":1,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":1,"RelationConversions":1,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":1,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":1,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":1,"Analyzer$ExtractGenerator":1,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":1,"ResolveHints$ResolveJoinStrategyHints":1,"TypeCoercion$MapZipWithCoercion":1,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":1,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":1,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":1,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":1,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":1,"package$ExpressionCanonicalizer$CleanExpressions":2,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":1,"CTESubstitution":1,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":1,"RewriteExceptAll":1,"UpdateAttributeNullability":3,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":1,"ReplaceExpressions":1,"ResolveInlineTables":1,"ResolveUnion":1,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":1,"ResolveSessionCatalog":1,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":1,"Analyzer$ResolveAliases":1,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":1,"TransposeWindow":3,"Analyzer$ResolveRelations":1,"EliminateUnions":1,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":1,"Analyzer$ResolveNaturalAndUsingJoin":1,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":1,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":1,"FallBackFileSourceV2":1,"Analyzer$ResolveTables":1,"SubstituteUnresolvedOrdinals":1,"TypeCoercion$CaseWhenCoercion":1,"DecimalPrecision":1,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":1,"Analyzer$ResolveAggAliasInGroupBy":1,"TypeCoercion$StringLiteralCoercion":1,"FoldablePropagation":3,"ResolveHiveSerdeTable":1,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":1,"Analyzer$PullOutNondeterministic":1,"Analyzer$ResolveFunctions":1,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":1,"Analyzer$ResolvePivot":1,"CollapseProject":4,"Analyzer$ResolveNewInstance":1,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":1,"TypeCoercion$ConcatCoercion":1,"PushDownPredicates":6,"TimeWindowing":1,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"TypeCoercion$Division":1,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":1,"TypeCoercion$EltCoercion":1,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":1,"ResolveSQLOnFile":1,"Analyzer$ResolveSubquery":1,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":1,"Analyzer$ResolveBinaryArithmetic":1,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":1,"ResolveEncodersInScalaAgg":1,"TypeCoercion$IntegralDivision":1,"Analyzer$ResolveWindowFrame":1,"Analyzer$ResolveDeserializer":1,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":1,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":1,"Analyzer$ResolveGenerate":1,"TypeCoercion$WidenSetOperationTypes":1,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":1,"ReplaceExceptWithFilter":1,"CleanupAliases":1,"SchemaPruning":1,"ResolveHints$DisableHints":1,"Analyzer$ResolveOutputRelation":1,"BloomFilterJoinRule":1,"HiveAnalysis":1,"Analyzer$ResolveRandomSeed":1,"TypeCoercion$WindowFrameCoercion":1,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":1,"ResolveNoopDropTable":1,"TypeCoercion$InConversion":1,"FindDataSourceTable":1,"ApplyCharTypePadding":1,"SimplifyConditionals":3,"DataSourceAnalysis":1,"TypeCoercion$FunctionArgumentConversion":1,"Analyzer$GlobalAggregates":1,"Analyzer$LookupFunctions":1,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":1},"numEffectiveRunsPerRule":{"RemoveNoopOperators":1,"PushDownPredicates":1,"CollapseProject":1,"RemoveRedundantAliases":1},"timeEffectiveRunsPerRule":{"RemoveNoopOperators":1204154,"PushDownPredicates":8925169,"CollapseProject":6995176,"RemoveRedundantAliases":4470662},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":0,"time":1691340254227}
{"Event":"SparkListenerJobStart","Job ID":1,"Submission Time":1691340254482,"Stage Infos":[{"Stage ID":1,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":9,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"12\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[8],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":6,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"9\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[5],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":4,"Name":"FileScanRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":5,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[4],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":8,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"11\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[7],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":7,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[6],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[1],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"13\",\"name\":\"aggregate\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":1,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":9,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"12\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[8],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":6,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"9\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[5],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":4,"Name":"FileScanRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":5,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[4],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":8,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"11\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[7],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":7,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[6],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340254489,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"13\",\"name\":\"aggregate\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":1,"Stage Attempt ID":0,"Task Info":{"Task ID":1,"Index":0,"Attempt":0,"Launch Time":1691340254537,"Executor ID":"3","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":1,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":1,"Index":0,"Attempt":0,"Launch Time":1691340254537,"Executor ID":"3","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340257534,"Failed":false,"Killed":false,"Accumulables":[{"ID":42,"Name":"number of output rows","Update":"1772","Value":"1772","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":46,"Name":"internal.metrics.executorDeserializeTime","Update":113,"Value":113,"Internal":true,"Count Failed Values":true},{"ID":47,"Name":"internal.metrics.executorDeserializeCpuTime","Update":101556205,"Value":101556205,"Internal":true,"Count Failed Values":true},{"ID":48,"Name":"internal.metrics.executorRunTime","Update":2852,"Value":2852,"Internal":true,"Count Failed Values":true},{"ID":49,"Name":"internal.metrics.executorCpuTime","Update":2089716889,"Value":2089716889,"Internal":true,"Count Failed Values":true},{"ID":50,"Name":"internal.metrics.resultSize","Update":1671,"Value":1671,"Internal":true,"Count Failed Values":true},{"ID":51,"Name":"internal.metrics.jvmGCTime","Update":48,"Value":48,"Internal":true,"Count Failed Values":true},{"ID":52,"Name":"internal.metrics.resultSerializationTime","Update":2,"Value":2,"Internal":true,"Count Failed Values":true},{"ID":67,"Name":"internal.metrics.input.bytesRead","Update":196138,"Value":196138,"Internal":true,"Count Failed Values":true},{"ID":68,"Name":"internal.metrics.input.recordsRead","Update":1772,"Value":1772,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":113,"Executor Deserialize CPU Time":101556205,"Executor Run Time":2852,"Executor CPU Time":2089716889,"Peak Execution Memory":0,"Result Size":1671,"JVM GC Time":48,"Result Serialization Time":2,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":196138,"Records Read":1772},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":1,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":9,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"12\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[8],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":6,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"9\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[5],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":4,"Name":"FileScanRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":5,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"10\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[4],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":8,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"11\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[7],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":7,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[6],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340254489,"Completion Time":1691340257536,"Accumulables":[{"ID":42,"Name":"number of output rows","Value":"1772","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":46,"Name":"internal.metrics.executorDeserializeTime","Value":113,"Internal":true,"Count Failed Values":true},{"ID":47,"Name":"internal.metrics.executorDeserializeCpuTime","Value":101556205,"Internal":true,"Count Failed Values":true},{"ID":48,"Name":"internal.metrics.executorRunTime","Value":2852,"Internal":true,"Count Failed Values":true},{"ID":49,"Name":"internal.metrics.executorCpuTime","Value":2089716889,"Internal":true,"Count Failed Values":true},{"ID":50,"Name":"internal.metrics.resultSize","Value":1671,"Internal":true,"Count Failed Values":true},{"ID":51,"Name":"internal.metrics.jvmGCTime","Value":48,"Internal":true,"Count Failed Values":true},{"ID":52,"Name":"internal.metrics.resultSerializationTime","Value":2,"Internal":true,"Count Failed Values":true},{"ID":67,"Name":"internal.metrics.input.bytesRead","Value":196138,"Internal":true,"Count Failed Values":true},{"ID":68,"Name":"internal.metrics.input.recordsRead","Value":1772,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":1,"Completion Time":1691340257537,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":1,"description":"showString at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nGlobalLimit 8\n+- LocalLimit 8\n   +- Project [cast(Trade_Date#16 as string) AS Trade_Date#40, cast(Ticker#17 as string) AS Ticker#41, cast(Close#21 as string) AS Close#42, cast(Volume#22 as string) AS Volume#43]\n      +- Sort [Trade_Date#16 ASC NULLS FIRST], true\n         +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n            +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Analyzed Logical Plan ==\nTrade_Date: string, Ticker: string, Close: string, Volume: string\nGlobalLimit 8\n+- LocalLimit 8\n   +- Project [cast(Trade_Date#16 as string) AS Trade_Date#40, cast(Ticker#17 as string) AS Ticker#41, cast(Close#21 as string) AS Close#42, cast(Volume#22 as string) AS Volume#43]\n      +- Sort [Trade_Date#16 ASC NULLS FIRST], true\n         +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n            +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Optimized Logical Plan ==\nGlobalLimit 8\n+- LocalLimit 8\n   +- Project [Trade_Date#16, Ticker#17, cast(Close#21 as string) AS Close#42, cast(Volume#22 as string) AS Volume#43]\n      +- Sort [Trade_Date#16 ASC NULLS FIRST], true\n         +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n            +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Physical Plan ==\nTakeOrderedAndProject(limit=8, orderBy=[Trade_Date#16 ASC NULLS FIRST], output=[Trade_Date#16,Ticker#17,Close#42,Volume#43])\n+- FileScan csv [Trade_Date#16,Ticker#17,Close#21,Volume#22] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>\n","sparkPlanInfo":{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=8, orderBy=[Trade_Date#16 ASC NULLS FIRST], output=[Trade_Date#16,Ticker#17,Close#42,Volume#43])","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [Trade_Date#16,Ticker#17,Close#21,Volume#22] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv]","ReadSchema":"struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[]","DataFilters":"[]"},"metrics":[{"name":"number of output rows","accumulatorId":81,"metricType":"sum"},{"name":"number of files read","accumulatorId":82,"metricType":"sum"},{"name":"metadata time","accumulatorId":83,"metricType":"timing"},{"name":"size of files read","accumulatorId":84,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":79,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":80,"metricType":"nsTiming"},{"name":"records read","accumulatorId":77,"metricType":"sum"},{"name":"local bytes read","accumulatorId":75,"metricType":"size"},{"name":"fetch wait time","accumulatorId":76,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":73,"metricType":"size"},{"name":"local blocks read","accumulatorId":72,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":71,"metricType":"sum"},{"name":"remote bytes read to disk","accumulatorId":74,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":78,"metricType":"size"}]},"time":1691340257778}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":1,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":1,"accumUpdates":[[82,1],[83,0],[84,196138]]}
{"Event":"SparkListenerJobStart","Job ID":2,"Submission Time":1691340257958,"Stage Infos":[{"Stage ID":2,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":13,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"22\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[12],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":10,"Name":"FileScanRDD","Scope":"{\"id\":\"20\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":12,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"21\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[11],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":11,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"20\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[10],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[2],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"22\",\"name\":\"takeOrdered\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"1","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":2,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":13,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"22\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[12],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":10,"Name":"FileScanRDD","Scope":"{\"id\":\"20\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":12,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"21\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[11],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":11,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"20\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[10],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340257963,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"22\",\"name\":\"takeOrdered\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"1","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":2,"Stage Attempt ID":0,"Task Info":{"Task ID":2,"Index":0,"Attempt":0,"Launch Time":1691340257999,"Executor ID":"3","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":2,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":2,"Index":0,"Attempt":0,"Launch Time":1691340257999,"Executor ID":"3","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340258525,"Failed":false,"Killed":false,"Accumulables":[{"ID":81,"Name":"number of output rows","Update":"1771","Value":"1771","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":85,"Name":"internal.metrics.executorDeserializeTime","Update":96,"Value":96,"Internal":true,"Count Failed Values":true},{"ID":86,"Name":"internal.metrics.executorDeserializeCpuTime","Update":86070154,"Value":86070154,"Internal":true,"Count Failed Values":true},{"ID":87,"Name":"internal.metrics.executorRunTime","Update":347,"Value":347,"Internal":true,"Count Failed Values":true},{"ID":88,"Name":"internal.metrics.executorCpuTime","Update":213705582,"Value":213705582,"Internal":true,"Count Failed Values":true},{"ID":89,"Name":"internal.metrics.resultSize","Update":4520,"Value":4520,"Internal":true,"Count Failed Values":true},{"ID":91,"Name":"internal.metrics.resultSerializationTime","Update":6,"Value":6,"Internal":true,"Count Failed Values":true},{"ID":106,"Name":"internal.metrics.input.bytesRead","Update":196138,"Value":196138,"Internal":true,"Count Failed Values":true},{"ID":107,"Name":"internal.metrics.input.recordsRead","Update":1771,"Value":1771,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":96,"Executor Deserialize CPU Time":86070154,"Executor Run Time":347,"Executor CPU Time":213705582,"Peak Execution Memory":0,"Result Size":4520,"JVM GC Time":0,"Result Serialization Time":6,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":196138,"Records Read":1771},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":2,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":13,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"22\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[12],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":10,"Name":"FileScanRDD","Scope":"{\"id\":\"20\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":12,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"21\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[11],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":11,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"20\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[10],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340257963,"Completion Time":1691340258526,"Accumulables":[{"ID":81,"Name":"number of output rows","Value":"1771","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":85,"Name":"internal.metrics.executorDeserializeTime","Value":96,"Internal":true,"Count Failed Values":true},{"ID":86,"Name":"internal.metrics.executorDeserializeCpuTime","Value":86070154,"Internal":true,"Count Failed Values":true},{"ID":87,"Name":"internal.metrics.executorRunTime","Value":347,"Internal":true,"Count Failed Values":true},{"ID":88,"Name":"internal.metrics.executorCpuTime","Value":213705582,"Internal":true,"Count Failed Values":true},{"ID":89,"Name":"internal.metrics.resultSize","Value":4520,"Internal":true,"Count Failed Values":true},{"ID":91,"Name":"internal.metrics.resultSerializationTime","Value":6,"Internal":true,"Count Failed Values":true},{"ID":106,"Name":"internal.metrics.input.bytesRead","Value":196138,"Internal":true,"Count Failed Values":true},{"ID":107,"Name":"internal.metrics.input.recordsRead","Value":1771,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":2,"Completion Time":1691340258537,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":1,"timePerRule":{"PruneFileSourcePartitions":665773,"ReassignLambdaVariableID":489654,"PushPredicateThroughNonJoin":27015,"Analyzer$ResolveEncodersInUDF":78948,"Analyzer$HandleNullInputsForUDF":159063,"OptimizeUpdateFields":381471,"Analyzer$ResolveSubqueryColumnAliases":20911,"ResolveTimeZone":101571,"Analyzer$ResolveNamespace":20262,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":31234,"RelationConversions":18934,"RewriteCorrelatedScalarSubquery":1473376,"RemoveLiteralFromGroupExpressions":38761,"PushProjectionThroughUnion":112471,"EliminateSubqueryAliases":64671,"ResolveCatalogs":25367,"PushLeftSemiLeftAntiThroughJoin":90545,"Analyzer$ResolveUserSpecifiedColumns":21814,"FlattenScalarSubqueriesWithAggregates":3791502,"LikeSimplification":334509,"CollapseRepartition":150061,"ResolveHints$ResolveCoalesceHints":16924,"Analyzer$ExtractGenerator":153801,"RewriteIntersectAll":31810,"Analyzer$AddMetadataColumns":139962,"ResolveHints$ResolveJoinStrategyHints":20470,"TypeCoercion$MapZipWithCoercion":108090,"NullPropagation":536584,"EliminateAggregateFilter":17723,"PullupCorrelatedPredicates":131973,"UpdateOuterReferences":24041,"ExtractPythonUDFs":463766,"Analyzer$WindowsSubstitution":23299,"CombineUnions":137505,"ExtractGroupingPythonUDFFromAggregate":31539,"ReorderAssociativeOperator":563287,"CleanupDynamicPruningFilters":1096515,"ResolveHints$RemoveAllHints":15669,"SimplifyBinaryComparison":454325,"ResolveTableValuedFunctions":24175,"EliminateSerialization":130023,"OptimizeJsonExprs":529418,"GetCurrentDatabaseAndCatalog":404455,"TypeCoercion$BooleanEquality":157612,"package$ExpressionCanonicalizer$CleanExpressions":271846,"EliminateLimits":132332,"ReplaceIntersectWithSemiJoin":35948,"ConstantPropagation":110091,"PushExtraPredicateThroughJoin":37412,"CostBasedJoinReorder":48689,"Analyzer$ResolveReferences":243432,"CTESubstitution":788782,"RemoveRedundantAliases":3859113,"TypeCoercion$ImplicitTypeCasts":143969,"RewriteExceptAll":43919,"UpdateAttributeNullability":2241738,"PropagateEmptyRelation":141885,"InferFiltersFromGenerate":810287,"SimplifyCasts":1294822,"EliminateMapObjects":102612,"DetectAmbiguousSelfJoin":117496,"ReplaceExpressions":130007,"ResolveInlineTables":27804,"ResolveUnion":37756,"OptimizeIn":341300,"CollapseWindow":168601,"TypeCoercion$IfCoercion":143847,"ResolveSessionCatalog":39623,"PartitionPruning":98816,"BooleanSimplification":1072364,"TypeCoercion$PromoteStrings":162803,"Analyzer$ResolveAliases":25913,"DecimalAggregates":99867,"PruneFilters":190310,"PruneHiveTablePartitions":213798,"Analyzer$ResolveMissingReferences":18265,"TransposeWindow":147747,"Analyzer$ResolveRelations":41045,"EliminateUnions":19065,"RewritePredicateSubquery":49002,"ObjectSerializerPruning":41397,"LimitPushDown":104972,"SimplifyCaseConversionExpressions":451561,"ResolvePartitionSpec":21103,"Analyzer$ResolveNaturalAndUsingJoin":21909,"UnwrapCastInBinaryComparison":408783,"EliminateView":59810,"CombineTypedFilters":37254,"ReplaceUpdateFieldsExpression":104385,"OptimizeLimitZero":125708,"CheckCartesianProducts":40815,"ExtractPythonUDFFromAggregate":41353,"Analyzer$ExtractWindowExpressions":38486,"ReplaceExceptWithAntiJoin":35193,"ResolveLambdaVariables":51600,"FallBackFileSourceV2":22863,"Analyzer$ResolveTables":38278,"SubstituteUnresolvedOrdinals":13213,"TypeCoercion$CaseWhenCoercion":107642,"DecimalPrecision":3625905,"EliminateSorts":1789600,"PushDownLeftSemiAntiJoin":101189,"ExtractPythonUDFFromJoinCondition":39844,"TypeCoercion$StackCoercion":101129,"Analyzer$ResolveAggAliasInGroupBy":19205,"TypeCoercion$StringLiteralCoercion":176774,"FoldablePropagation":2679633,"ResolveHiveSerdeTable":23704,"V2ScanRelationPushDown":1539084,"EliminateDistinct":12245,"InferFiltersFromConstraints":68187,"DetermineTableStats":18045,"Analyzer$PullOutNondeterministic":1536176,"Analyzer$ResolveFunctions":147064,"ReplaceNullWithFalseInPredicate":328169,"ResolveHigherOrderFunctions":118794,"Analyzer$ResolvePivot":20779,"CollapseProject":210254,"Analyzer$ResolveNewInstance":69665,"ColumnPruning":11201406,"Analyzer$ResolveWindowOrder":100281,"TypeCoercion$ConcatCoercion":149488,"PushDownPredicates":355995,"TimeWindowing":1499855,"Optimizer$OptimizeSubqueries":309138,"RewriteNonCorrelatedExists":112962,"TypeCoercion$Division":137798,"ComputeCurrentTime":242153,"ResolveCreateNamedStruct":124230,"TypeCoercion$EltCoercion":143854,"ConvertToLocalRelation":101734,"OptimizeWindowFunctions":99717,"RemoveRepetitionFromGroupExpressions":36799,"ReplaceDistinctWithAggregate":30088,"PreprocessTableCreation":20021,"ResolveSQLOnFile":17945,"Analyzer$ResolveSubquery":92259,"CombineConcats":15404,"Analyzer$ResolveGroupingAnalytics":42351,"Analyzer$ResolveBinaryArithmetic":145925,"RemoveDispensableExpressions":319657,"Analyzer$ResolveAlterTableChanges":19878,"ResolveEncodersInScalaAgg":136991,"TypeCoercion$IntegralDivision":154641,"Analyzer$ResolveWindowFrame":91347,"Analyzer$ResolveDeserializer":817356,"RewriteDistinctAggregates":52543,"RemoveNoopOperators":1134748,"Analyzer$ResolveAggregateFunctions":21315,"NormalizeFloatingNumbers":45008,"ReorderJoin":102285,"Analyzer$ResolveUpCast":29042,"Analyzer$ResolveGenerate":23008,"TypeCoercion$WidenSetOperationTypes":333417,"EliminateOuterJoin":94068,"SimplifyExtractValueOps":378005,"OptimizeMetadataOnlyQuery":19911,"EliminateResolvedHint":152863,"Analyzer$ResolveInsertInto":22888,"ReplaceExceptWithFilter":61447,"CleanupAliases":47911,"SchemaPruning":2539325,"ResolveHints$DisableHints":39944,"Analyzer$ResolveOutputRelation":23256,"BloomFilterJoinRule":64089,"HiveAnalysis":14936,"Analyzer$ResolveRandomSeed":28989,"TypeCoercion$WindowFrameCoercion":103652,"ConstantFolding":497924,"TypeCoercion$DateTimeOperations":147729,"ResolveNoopDropTable":16258,"TypeCoercion$InConversion":163731,"FindDataSourceTable":24064,"ApplyCharTypePadding":80730,"SimplifyConditionals":422759,"DataSourceAnalysis":24184,"TypeCoercion$FunctionArgumentConversion":184481,"Analyzer$GlobalAggregates":21784,"Analyzer$LookupFunctions":108689,"CombineFilters":196670,"ReplaceDeduplicateWithAggregate":285765,"PreprocessTableInsertion":1719441},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":2,"Analyzer$HandleNullInputsForUDF":2,"OptimizeUpdateFields":5,"Analyzer$ResolveSubqueryColumnAliases":3,"ResolveTimeZone":3,"Analyzer$ResolveNamespace":3,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":3,"RelationConversions":2,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":3,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":3,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":2,"Analyzer$ExtractGenerator":3,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":3,"ResolveHints$ResolveJoinStrategyHints":2,"TypeCoercion$MapZipWithCoercion":3,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":2,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":2,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":2,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":3,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":3,"package$ExpressionCanonicalizer$CleanExpressions":8,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":3,"CTESubstitution":2,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":3,"RewriteExceptAll":1,"UpdateAttributeNullability":4,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":2,"ReplaceExpressions":1,"ResolveInlineTables":3,"ResolveUnion":3,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":3,"ResolveSessionCatalog":3,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":3,"Analyzer$ResolveAliases":3,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":3,"TransposeWindow":3,"Analyzer$ResolveRelations":3,"EliminateUnions":2,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":3,"Analyzer$ResolveNaturalAndUsingJoin":3,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":3,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":3,"FallBackFileSourceV2":3,"Analyzer$ResolveTables":3,"SubstituteUnresolvedOrdinals":2,"TypeCoercion$CaseWhenCoercion":3,"DecimalPrecision":3,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":3,"Analyzer$ResolveAggAliasInGroupBy":3,"TypeCoercion$StringLiteralCoercion":3,"FoldablePropagation":3,"ResolveHiveSerdeTable":3,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":2,"Analyzer$PullOutNondeterministic":2,"Analyzer$ResolveFunctions":3,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":3,"Analyzer$ResolvePivot":3,"CollapseProject":4,"Analyzer$ResolveNewInstance":3,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":3,"TypeCoercion$ConcatCoercion":3,"PushDownPredicates":6,"TimeWindowing":3,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"TypeCoercion$Division":3,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":3,"TypeCoercion$EltCoercion":3,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":2,"ResolveSQLOnFile":3,"Analyzer$ResolveSubquery":3,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":3,"Analyzer$ResolveBinaryArithmetic":3,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":2,"ResolveEncodersInScalaAgg":3,"TypeCoercion$IntegralDivision":3,"Analyzer$ResolveWindowFrame":3,"Analyzer$ResolveDeserializer":3,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":3,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":3,"Analyzer$ResolveGenerate":3,"TypeCoercion$WidenSetOperationTypes":3,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":3,"ReplaceExceptWithFilter":1,"CleanupAliases":2,"SchemaPruning":1,"ResolveHints$DisableHints":2,"Analyzer$ResolveOutputRelation":3,"BloomFilterJoinRule":1,"HiveAnalysis":2,"Analyzer$ResolveRandomSeed":3,"TypeCoercion$WindowFrameCoercion":3,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":3,"ResolveNoopDropTable":2,"TypeCoercion$InConversion":3,"FindDataSourceTable":3,"ApplyCharTypePadding":2,"SimplifyConditionals":3,"DataSourceAnalysis":2,"TypeCoercion$FunctionArgumentConversion":3,"Analyzer$GlobalAggregates":3,"Analyzer$LookupFunctions":2,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":2},"numEffectiveRunsPerRule":{"Analyzer$ResolveDeserializer":1,"SimplifyCasts":1,"package$ExpressionCanonicalizer$CleanExpressions":2,"RemoveRedundantAliases":1},"timeEffectiveRunsPerRule":{"Analyzer$ResolveDeserializer":790329,"SimplifyCasts":1084762,"package$ExpressionCanonicalizer$CleanExpressions":83374,"RemoveRedundantAliases":2368831},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":1,"time":1691340258817}
{"Event":"SparkListenerBlockManagerRemoved","Block Manager ID":{"Executor ID":"3","Host":"ip-10-0-10-52.us-west-2.compute.internal","Port":35449},"Timestamp":1691340320286}
{"Event":"SparkListenerExecutorRemoved","Timestamp":1691340320299,"Executor ID":"3","Removed Reason":"Container container_1691339165261_0001_01_000005 exited from explicit termination request."}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":2,"description":"count at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nAggregate [count(1) AS count#62L]\n+- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n   +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Analyzed Logical Plan ==\ncount: bigint\nAggregate [count(1) AS count#62L]\n+- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n   +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Optimized Logical Plan ==\nAggregate [count(1) AS count#62L]\n+- Project\n   +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=false\n+- HashAggregate(keys=[], functions=[count(1)], output=[count#62L])\n   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#35]\n      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#65L])\n         +- FileScan csv [] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[count(1)])","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#35]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_count(1)])","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv]","ReadSchema":"struct<>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[]","DataFilters":"[]"},"metrics":[{"name":"number of output rows","accumulatorId":142,"metricType":"sum"},{"name":"number of files read","accumulatorId":143,"metricType":"sum"},{"name":"metadata time","accumulatorId":144,"metricType":"timing"},{"name":"size of files read","accumulatorId":145,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":139,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":140,"metricType":"timing"},{"name":"peak memory","accumulatorId":138,"metricType":"size"},{"name":"number of output rows","accumulatorId":137,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":141,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":119,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":120,"metricType":"nsTiming"},{"name":"records read","accumulatorId":117,"metricType":"sum"},{"name":"local bytes read","accumulatorId":115,"metricType":"size"},{"name":"fetch wait time","accumulatorId":116,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":113,"metricType":"size"},{"name":"local blocks read","accumulatorId":112,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":111,"metricType":"sum"},{"name":"data size","accumulatorId":110,"metricType":"size"},{"name":"remote bytes read to disk","accumulatorId":114,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":118,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":134,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":135,"metricType":"timing"},{"name":"peak memory","accumulatorId":133,"metricType":"size"},{"name":"number of output rows","accumulatorId":132,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":136,"metricType":"average"}]}],"metadata":{},"metrics":[]},"time":1691340329280}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":2,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":2,"physicalPlanDescription":"== Parsed Logical Plan ==\nAggregate [count(1) AS count#62L]\n+- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n   +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Analyzed Logical Plan ==\ncount: bigint\nAggregate [count(1) AS count#62L]\n+- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n   +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Optimized Logical Plan ==\nAggregate [count(1) AS count#62L]\n+- Project\n   +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=false\n+- == Current Plan ==\n   HashAggregate(keys=[], functions=[count(1)], output=[count#62L])\n   +- ShuffleQueryStage 0\n      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#44]\n         +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#65L])\n            +- FileScan csv [] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>\n+- == Initial Plan ==\n   HashAggregate(keys=[], functions=[count(1)], output=[count#62L])\n   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#35]\n      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#65L])\n         +- FileScan csv [] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[count(1)])","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#44]","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_count(1)])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv]","ReadSchema":"struct<>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[]","DataFilters":"[]"},"metrics":[{"name":"number of output rows","accumulatorId":142,"metricType":"sum"},{"name":"number of files read","accumulatorId":143,"metricType":"sum"},{"name":"metadata time","accumulatorId":144,"metricType":"timing"},{"name":"size of files read","accumulatorId":145,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":165,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":166,"metricType":"timing"},{"name":"peak memory","accumulatorId":164,"metricType":"size"},{"name":"number of output rows","accumulatorId":163,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":167,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":162,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":155,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":156,"metricType":"nsTiming"},{"name":"records read","accumulatorId":153,"metricType":"sum"},{"name":"local bytes read","accumulatorId":151,"metricType":"size"},{"name":"fetch wait time","accumulatorId":152,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":149,"metricType":"size"},{"name":"local blocks read","accumulatorId":148,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":147,"metricType":"sum"},{"name":"data size","accumulatorId":146,"metricType":"size"},{"name":"remote bytes read to disk","accumulatorId":150,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":154,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":159,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":160,"metricType":"timing"},{"name":"peak memory","accumulatorId":158,"metricType":"size"},{"name":"number of output rows","accumulatorId":157,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":161,"metricType":"average"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":2,"accumUpdates":[[143,1],[144,0],[145,196138]]}
{"Event":"SparkListenerJobStart","Job ID":3,"Submission Time":1691340329565,"Stage Infos":[{"Stage ID":3,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":17,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"27\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[16],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":15,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"31\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[14],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":16,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"28\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[15],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":14,"Name":"FileScanRDD","Scope":"{\"id\":\"31\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[3],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"27\",\"name\":\"ShuffleQueryStage\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"2","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":3,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":17,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"27\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[16],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":15,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"31\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[14],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":16,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"28\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[15],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":14,"Name":"FileScanRDD","Scope":"{\"id\":\"31\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340329581,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"27\",\"name\":\"ShuffleQueryStage\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"2","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerExecutorAdded","Timestamp":1691340334792,"Executor ID":"4","Executor Info":{"Host":"ip-10-0-10-231.us-west-2.compute.internal","Total Cores":4,"Log Urls":{"stdout":"http://ip-10-0-10-231.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000008/hadoop/stdout?start=-4096","stderr":"http://ip-10-0-10-231.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000008/hadoop/stderr?start=-4096"},"Attributes":{"NM_HTTP_ADDRESS":"ip-10-0-10-231.us-west-2.compute.internal:8042","USER":"hadoop","LOG_FILES":"stderr,stdout","NM_HTTP_PORT":"8042","CLUSTER_ID":"","NM_PORT":"8041","HTTP_SCHEME":"http://","NM_HOST":"ip-10-0-10-231.us-west-2.compute.internal","CONTAINER_ID":"container_1691339165261_0001_01_000008"},"Resources":{},"Resource Profile Id":0}}
{"Event":"SparkListenerBlockManagerAdded","Block Manager ID":{"Executor ID":"4","Host":"ip-10-0-10-231.us-west-2.compute.internal","Port":32903},"Maximum Memory":2199493017,"Timestamp":1691340335095,"Maximum Onheap Memory":2199493017,"Maximum Offheap Memory":0}
{"Event":"SparkListenerTaskStart","Stage ID":3,"Stage Attempt ID":0,"Task Info":{"Task ID":3,"Index":0,"Attempt":0,"Launch Time":1691340335291,"Executor ID":"4","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":3,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":3,"Index":0,"Attempt":0,"Launch Time":1691340335291,"Executor ID":"4","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340341480,"Failed":false,"Killed":false,"Accumulables":[{"ID":142,"Name":"number of output rows","Update":"1771","Value":"1771","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":146,"Name":"data size","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":154,"Name":"shuffle bytes written","Update":"59","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":155,"Name":"shuffle records written","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":156,"Name":"shuffle write time","Update":"17468741","Value":"17468741","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":162,"Name":"duration","Update":"2631","Value":"2631","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":163,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":166,"Name":"time in aggregation build","Update":"2567","Value":"2567","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"internal.metrics.executorDeserializeTime","Update":2178,"Value":2178,"Internal":true,"Count Failed Values":true},{"ID":169,"Name":"internal.metrics.executorDeserializeCpuTime","Update":1044225015,"Value":1044225015,"Internal":true,"Count Failed Values":true},{"ID":170,"Name":"internal.metrics.executorRunTime","Update":3913,"Value":3913,"Internal":true,"Count Failed Values":true},{"ID":171,"Name":"internal.metrics.executorCpuTime","Update":2369148066,"Value":2369148066,"Internal":true,"Count Failed Values":true},{"ID":172,"Name":"internal.metrics.resultSize","Update":2034,"Value":2034,"Internal":true,"Count Failed Values":true},{"ID":173,"Name":"internal.metrics.jvmGCTime","Update":330,"Value":330,"Internal":true,"Count Failed Values":true},{"ID":174,"Name":"internal.metrics.resultSerializationTime","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":59,"Value":59,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":188,"Name":"internal.metrics.shuffle.write.writeTime","Update":17468741,"Value":17468741,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.input.bytesRead","Update":196138,"Value":196138,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.input.recordsRead","Update":1771,"Value":1771,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":2178,"Executor Deserialize CPU Time":1044225015,"Executor Run Time":3913,"Executor CPU Time":2369148066,"Peak Execution Memory":0,"Result Size":2034,"JVM GC Time":330,"Result Serialization Time":1,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":59,"Shuffle Write Time":17468741,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":196138,"Records Read":1771},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":3,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":17,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"27\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[16],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":15,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"31\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[14],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":16,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"28\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[15],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":14,"Name":"FileScanRDD","Scope":"{\"id\":\"31\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340329581,"Completion Time":1691340341483,"Accumulables":[{"ID":142,"Name":"number of output rows","Value":"1771","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":146,"Name":"data size","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":154,"Name":"shuffle bytes written","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":155,"Name":"shuffle records written","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":156,"Name":"shuffle write time","Value":"17468741","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":162,"Name":"duration","Value":"2631","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":163,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":166,"Name":"time in aggregation build","Value":"2567","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":168,"Name":"internal.metrics.executorDeserializeTime","Value":2178,"Internal":true,"Count Failed Values":true},{"ID":169,"Name":"internal.metrics.executorDeserializeCpuTime","Value":1044225015,"Internal":true,"Count Failed Values":true},{"ID":170,"Name":"internal.metrics.executorRunTime","Value":3913,"Internal":true,"Count Failed Values":true},{"ID":171,"Name":"internal.metrics.executorCpuTime","Value":2369148066,"Internal":true,"Count Failed Values":true},{"ID":172,"Name":"internal.metrics.resultSize","Value":2034,"Internal":true,"Count Failed Values":true},{"ID":173,"Name":"internal.metrics.jvmGCTime","Value":330,"Internal":true,"Count Failed Values":true},{"ID":174,"Name":"internal.metrics.resultSerializationTime","Value":1,"Internal":true,"Count Failed Values":true},{"ID":186,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":59,"Internal":true,"Count Failed Values":true},{"ID":187,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":1,"Internal":true,"Count Failed Values":true},{"ID":188,"Name":"internal.metrics.shuffle.write.writeTime","Value":17468741,"Internal":true,"Count Failed Values":true},{"ID":189,"Name":"internal.metrics.input.bytesRead","Value":196138,"Internal":true,"Count Failed Values":true},{"ID":190,"Name":"internal.metrics.input.recordsRead","Value":1771,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":3,"Completion Time":1691340341496,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":2,"physicalPlanDescription":"== Parsed Logical Plan ==\nAggregate [count(1) AS count#62L]\n+- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n   +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Analyzed Logical Plan ==\ncount: bigint\nAggregate [count(1) AS count#62L]\n+- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n   +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Optimized Logical Plan ==\nAggregate [count(1) AS count#62L]\n+- Project\n   +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=true\n+- == Final Plan ==\n   *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#62L])\n   +- ShuffleQueryStage 0\n      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#44]\n         +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#65L])\n            +- FileScan csv [] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>\n+- == Initial Plan ==\n   HashAggregate(keys=[], functions=[count(1)], output=[count#62L])\n   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#35]\n      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#65L])\n         +- FileScan csv [] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=true","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[count(1)])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#44]","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_count(1)])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv]","ReadSchema":"struct<>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[]","DataFilters":"[]"},"metrics":[{"name":"number of output rows","accumulatorId":142,"metricType":"sum"},{"name":"number of files read","accumulatorId":143,"metricType":"sum"},{"name":"metadata time","accumulatorId":144,"metricType":"timing"},{"name":"size of files read","accumulatorId":145,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":165,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":166,"metricType":"timing"},{"name":"peak memory","accumulatorId":164,"metricType":"size"},{"name":"number of output rows","accumulatorId":163,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":167,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":162,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":155,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":156,"metricType":"nsTiming"},{"name":"records read","accumulatorId":153,"metricType":"sum"},{"name":"local bytes read","accumulatorId":151,"metricType":"size"},{"name":"fetch wait time","accumulatorId":152,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":149,"metricType":"size"},{"name":"local blocks read","accumulatorId":148,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":147,"metricType":"sum"},{"name":"data size","accumulatorId":146,"metricType":"size"},{"name":"remote bytes read to disk","accumulatorId":150,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":154,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":196,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":197,"metricType":"timing"},{"name":"peak memory","accumulatorId":195,"metricType":"size"},{"name":"number of output rows","accumulatorId":194,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":198,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":193,"metricType":"timing"}]}],"metadata":{},"metrics":[]}}
{"Event":"SparkListenerJobStart","Job ID":4,"Submission Time":1691340341616,"Stage Infos":[{"Stage ID":5,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":20,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"38\",\"name\":\"mapPartitionsInternal\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[19],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":18,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"37\",\"name\":\"Exchange\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[17],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":19,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"33\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[18],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[4],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0},{"Stage ID":4,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":17,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"27\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[16],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":15,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"31\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[14],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":16,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"28\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[15],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":14,"Name":"FileScanRDD","Scope":"{\"id\":\"31\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[5,4],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"39\",\"name\":\"collect\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"2","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":5,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":20,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"38\",\"name\":\"mapPartitionsInternal\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[19],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":18,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"37\",\"name\":\"Exchange\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[17],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":19,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"33\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[18],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[4],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340341624,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"39\",\"name\":\"collect\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"2","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":5,"Stage Attempt ID":0,"Task Info":{"Task ID":4,"Index":0,"Attempt":0,"Launch Time":1691340341640,"Executor ID":"4","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":5,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":4,"Index":0,"Attempt":0,"Launch Time":1691340341640,"Executor ID":"4","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340342178,"Failed":false,"Killed":false,"Accumulables":[{"ID":148,"Name":"local blocks read","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":151,"Name":"local bytes read","Update":"59","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":152,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":153,"Name":"records read","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":193,"Name":"duration","Update":"18","Value":"18","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":194,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":197,"Name":"time in aggregation build","Update":"18","Value":"18","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":199,"Name":"internal.metrics.executorDeserializeTime","Update":295,"Value":295,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.executorDeserializeCpuTime","Update":198874712,"Value":198874712,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.executorRunTime","Update":219,"Value":219,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.executorCpuTime","Update":123157198,"Value":123157198,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.resultSize","Update":2691,"Value":2691,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.resultSerializationTime","Update":2,"Value":2,"Internal":true,"Count Failed Values":true},{"ID":210,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":211,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":212,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":213,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":214,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":59,"Value":59,"Internal":true,"Count Failed Values":true},{"ID":215,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":216,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1,"Value":1,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":295,"Executor Deserialize CPU Time":198874712,"Executor Run Time":219,"Executor CPU Time":123157198,"Peak Execution Memory":0,"Result Size":2691,"JVM GC Time":0,"Result Serialization Time":2,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":1,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":59,"Total Records Read":1},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":5,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":20,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"38\",\"name\":\"mapPartitionsInternal\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[19],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":18,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"37\",\"name\":\"Exchange\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[17],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":19,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"33\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[18],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[4],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340341624,"Completion Time":1691340342180,"Accumulables":[{"ID":148,"Name":"local blocks read","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":151,"Name":"local bytes read","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":152,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":153,"Name":"records read","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":193,"Name":"duration","Value":"18","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":194,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":197,"Name":"time in aggregation build","Value":"18","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":199,"Name":"internal.metrics.executorDeserializeTime","Value":295,"Internal":true,"Count Failed Values":true},{"ID":200,"Name":"internal.metrics.executorDeserializeCpuTime","Value":198874712,"Internal":true,"Count Failed Values":true},{"ID":201,"Name":"internal.metrics.executorRunTime","Value":219,"Internal":true,"Count Failed Values":true},{"ID":202,"Name":"internal.metrics.executorCpuTime","Value":123157198,"Internal":true,"Count Failed Values":true},{"ID":203,"Name":"internal.metrics.resultSize","Value":2691,"Internal":true,"Count Failed Values":true},{"ID":205,"Name":"internal.metrics.resultSerializationTime","Value":2,"Internal":true,"Count Failed Values":true},{"ID":210,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":211,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":1,"Internal":true,"Count Failed Values":true},{"ID":212,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":213,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":214,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":59,"Internal":true,"Count Failed Values":true},{"ID":215,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":216,"Name":"internal.metrics.shuffle.read.recordsRead","Value":1,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":4,"Completion Time":1691340342180,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":2,"timePerRule":{"PruneFileSourcePartitions":162687,"ReassignLambdaVariableID":61388,"PushPredicateThroughNonJoin":12115,"Analyzer$ResolveEncodersInUDF":187565,"Analyzer$HandleNullInputsForUDF":42605,"OptimizeUpdateFields":255439,"Analyzer$ResolveSubqueryColumnAliases":9273,"ResolveTimeZone":25076,"Analyzer$ResolveNamespace":10235,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":966436,"RelationConversions":9190,"RewriteCorrelatedScalarSubquery":986323,"RemoveLiteralFromGroupExpressions":34280,"PushProjectionThroughUnion":41370,"EliminateSubqueryAliases":23591,"ResolveCatalogs":12235,"PushLeftSemiLeftAntiThroughJoin":30643,"Analyzer$ResolveUserSpecifiedColumns":8885,"EliminateJoinToEmptyRelation":1208077,"FlattenScalarSubqueriesWithAggregates":51738,"LikeSimplification":192713,"CollapseRepartition":54091,"ResolveHints$ResolveCoalesceHints":11337,"Analyzer$ExtractGenerator":2101636,"RewriteIntersectAll":13314,"Analyzer$AddMetadataColumns":2365827,"ResolveHints$ResolveJoinStrategyHints":17192,"TypeCoercion$MapZipWithCoercion":25244,"NullPropagation":2885957,"EliminateAggregateFilter":92381,"PullupCorrelatedPredicates":49722,"UpdateOuterReferences":12207,"ExtractPythonUDFs":279205,"Analyzer$WindowsSubstitution":12135,"CombineUnions":46139,"ExtractGroupingPythonUDFFromAggregate":544081,"ReorderAssociativeOperator":288848,"CleanupDynamicPruningFilters":99022,"ResolveHints$RemoveAllHints":11589,"SimplifyBinaryComparison":161492,"ResolveTableValuedFunctions":9823,"EliminateSerialization":45776,"OptimizeJsonExprs":257851,"GetCurrentDatabaseAndCatalog":232251,"TypeCoercion$BooleanEquality":41931,"EliminateLimits":33428,"ReplaceIntersectWithSemiJoin":12690,"ConstantPropagation":43318,"PushExtraPredicateThroughJoin":16202,"CostBasedJoinReorder":23599,"Analyzer$ResolveReferences":2814997,"CTESubstitution":1652471,"RemoveRedundantAliases":884556,"TypeCoercion$ImplicitTypeCasts":42459,"RewriteExceptAll":15471,"UpdateAttributeNullability":435840,"PropagateEmptyRelation":54701,"InferFiltersFromGenerate":23683,"SimplifyCasts":172415,"EliminateMapObjects":60503,"DetectAmbiguousSelfJoin":54635,"ReplaceExpressions":56964,"ResolveInlineTables":12407,"ResolveUnion":14731,"OptimizeIn":180765,"CollapseWindow":62398,"TypeCoercion$IfCoercion":47056,"ResolveSessionCatalog":21134,"PartitionPruning":41300,"BooleanSimplification":226258,"TypeCoercion$PromoteStrings":56485,"Analyzer$ResolveAliases":35600,"DecimalAggregates":59727,"PruneFilters":47365,"PruneHiveTablePartitions":68748,"Analyzer$ResolveMissingReferences":21951,"TransposeWindow":61070,"Analyzer$ResolveRelations":18864,"EliminateUnions":12174,"RewritePredicateSubquery":16719,"ObjectSerializerPruning":12899,"LimitPushDown":29515,"SimplifyCaseConversionExpressions":169242,"ResolvePartitionSpec":8685,"Analyzer$ResolveNaturalAndUsingJoin":9901,"UnwrapCastInBinaryComparison":152473,"EliminateView":18507,"CombineTypedFilters":11957,"ReplaceUpdateFieldsExpression":50933,"OptimizeLimitZero":25574,"CheckCartesianProducts":35776,"ExtractPythonUDFFromAggregate":1257258,"Analyzer$ExtractWindowExpressions":41550,"ReplaceExceptWithAntiJoin":11932,"ResolveLambdaVariables":17685,"FallBackFileSourceV2":8258,"Analyzer$ResolveTables":14262,"SubstituteUnresolvedOrdinals":512834,"TypeCoercion$CaseWhenCoercion":43522,"DecimalPrecision":98076,"EliminateSorts":1019518,"PushDownLeftSemiAntiJoin":38375,"ExtractPythonUDFFromJoinCondition":19801,"TypeCoercion$StackCoercion":26020,"Analyzer$ResolveAggAliasInGroupBy":1034701,"TypeCoercion$StringLiteralCoercion":39961,"FoldablePropagation":1349798,"ResolveHiveSerdeTable":12841,"V2ScanRelationPushDown":71709,"EliminateDistinct":88826,"InferFiltersFromConstraints":27225,"DetermineTableStats":9860,"Analyzer$PullOutNondeterministic":988877,"Analyzer$ResolveFunctions":47104,"ReplaceNullWithFalseInPredicate":116477,"ResolveHigherOrderFunctions":28939,"Analyzer$ResolvePivot":12598,"CollapseProject":945692,"Analyzer$ResolveNewInstance":15315,"ColumnPruning":4504598,"Analyzer$ResolveWindowOrder":28886,"TypeCoercion$ConcatCoercion":34053,"PushDownPredicates":176367,"TimeWindowing":91950,"Optimizer$OptimizeSubqueries":140842,"RewriteNonCorrelatedExists":49663,"DemoteBroadcastHashJoin":801152,"TypeCoercion$Division":37275,"ComputeCurrentTime":141106,"ResolveCreateNamedStruct":44858,"TypeCoercion$EltCoercion":807464,"ConvertToLocalRelation":29145,"OptimizeWindowFunctions":145549,"RemoveRepetitionFromGroupExpressions":25093,"ReplaceDistinctWithAggregate":11820,"PreprocessTableCreation":10823,"ResolveSQLOnFile":8180,"Analyzer$ResolveSubquery":29669,"CombineConcats":39237,"Analyzer$ResolveGroupingAnalytics":51141,"Analyzer$ResolveBinaryArithmetic":48220,"RemoveDispensableExpressions":135015,"Analyzer$ResolveAlterTableChanges":10985,"ResolveEncodersInScalaAgg":40169,"TypeCoercion$IntegralDivision":36909,"Analyzer$ResolveWindowFrame":26904,"Analyzer$ResolveDeserializer":68447,"RewriteDistinctAggregates":2318902,"RemoveNoopOperators":86292,"Analyzer$ResolveAggregateFunctions":9719,"NormalizeFloatingNumbers":17910,"ReorderJoin":40751,"Analyzer$ResolveUpCast":10949,"Analyzer$ResolveGenerate":25398,"TypeCoercion$WidenSetOperationTypes":110281,"EliminateOuterJoin":33620,"SimplifyExtractValueOps":130825,"OptimizeMetadataOnlyQuery":15352,"EliminateResolvedHint":56907,"Analyzer$ResolveInsertInto":8412,"ReplaceExceptWithFilter":36362,"CleanupAliases":1015304,"SchemaPruning":117663,"ResolveHints$DisableHints":23535,"Analyzer$ResolveOutputRelation":10033,"BloomFilterJoinRule":37050,"HiveAnalysis":7775,"Analyzer$ResolveRandomSeed":10201,"TypeCoercion$WindowFrameCoercion":25964,"ConstantFolding":230931,"TypeCoercion$DateTimeOperations":35882,"ResolveNoopDropTable":11898,"TypeCoercion$InConversion":70161,"FindDataSourceTable":10520,"ApplyCharTypePadding":36417,"SimplifyConditionals":189161,"DataSourceAnalysis":7821,"TypeCoercion$FunctionArgumentConversion":54014,"Analyzer$GlobalAggregates":8831,"Analyzer$LookupFunctions":45120,"CombineFilters":45556,"ReplaceDeduplicateWithAggregate":129127,"PreprocessTableInsertion":7347},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":1,"Analyzer$HandleNullInputsForUDF":1,"OptimizeUpdateFields":4,"Analyzer$ResolveSubqueryColumnAliases":1,"ResolveTimeZone":1,"Analyzer$ResolveNamespace":1,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":1,"RelationConversions":1,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":1,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":1,"EliminateJoinToEmptyRelation":1,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":1,"Analyzer$ExtractGenerator":1,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":1,"ResolveHints$ResolveJoinStrategyHints":1,"TypeCoercion$MapZipWithCoercion":1,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":1,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":1,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":1,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":1,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":1,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":1,"CTESubstitution":1,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":1,"RewriteExceptAll":1,"UpdateAttributeNullability":3,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":1,"ReplaceExpressions":1,"ResolveInlineTables":1,"ResolveUnion":1,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":1,"ResolveSessionCatalog":1,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":1,"Analyzer$ResolveAliases":1,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":1,"TransposeWindow":3,"Analyzer$ResolveRelations":1,"EliminateUnions":1,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":1,"Analyzer$ResolveNaturalAndUsingJoin":1,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":1,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":1,"FallBackFileSourceV2":1,"Analyzer$ResolveTables":1,"SubstituteUnresolvedOrdinals":1,"TypeCoercion$CaseWhenCoercion":1,"DecimalPrecision":1,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":1,"Analyzer$ResolveAggAliasInGroupBy":1,"TypeCoercion$StringLiteralCoercion":1,"FoldablePropagation":3,"ResolveHiveSerdeTable":1,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":1,"Analyzer$PullOutNondeterministic":1,"Analyzer$ResolveFunctions":1,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":1,"Analyzer$ResolvePivot":1,"CollapseProject":4,"Analyzer$ResolveNewInstance":1,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":1,"TypeCoercion$ConcatCoercion":1,"PushDownPredicates":6,"TimeWindowing":1,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"DemoteBroadcastHashJoin":1,"TypeCoercion$Division":1,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":1,"TypeCoercion$EltCoercion":1,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":1,"ResolveSQLOnFile":1,"Analyzer$ResolveSubquery":1,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":1,"Analyzer$ResolveBinaryArithmetic":1,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":1,"ResolveEncodersInScalaAgg":1,"TypeCoercion$IntegralDivision":1,"Analyzer$ResolveWindowFrame":1,"Analyzer$ResolveDeserializer":1,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":1,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":1,"Analyzer$ResolveGenerate":1,"TypeCoercion$WidenSetOperationTypes":1,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":1,"ReplaceExceptWithFilter":1,"CleanupAliases":2,"SchemaPruning":1,"ResolveHints$DisableHints":1,"Analyzer$ResolveOutputRelation":1,"BloomFilterJoinRule":1,"HiveAnalysis":1,"Analyzer$ResolveRandomSeed":1,"TypeCoercion$WindowFrameCoercion":1,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":1,"ResolveNoopDropTable":1,"TypeCoercion$InConversion":1,"FindDataSourceTable":1,"ApplyCharTypePadding":1,"SimplifyConditionals":3,"DataSourceAnalysis":1,"TypeCoercion$FunctionArgumentConversion":1,"Analyzer$GlobalAggregates":1,"Analyzer$LookupFunctions":1,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":1},"numEffectiveRunsPerRule":{"ColumnPruning":1,"CollapseProject":1,"CleanupAliases":1},"timeEffectiveRunsPerRule":{"ColumnPruning":1952235,"CollapseProject":900296,"CleanupAliases":954377},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":2,"time":1691340342198}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":3,"description":"showString at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nGlobalLimit 11\n+- LocalLimit 11\n   +- Project [cast(Trade_Date#16 as string) AS Trade_Date#70, cast(Ticker#17 as string) AS Ticker#71, cast(Close#21 as string) AS Close#72, cast(Volume#22 as string) AS Volume#73]\n      +- Sort [Volume#22 DESC NULLS LAST], true\n         +- Filter (Volume#22 > cast(10000000 as double))\n            +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n               +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Analyzed Logical Plan ==\nTrade_Date: string, Ticker: string, Close: string, Volume: string\nGlobalLimit 11\n+- LocalLimit 11\n   +- Project [cast(Trade_Date#16 as string) AS Trade_Date#70, cast(Ticker#17 as string) AS Ticker#71, cast(Close#21 as string) AS Close#72, cast(Volume#22 as string) AS Volume#73]\n      +- Sort [Volume#22 DESC NULLS LAST], true\n         +- Filter (Volume#22 > cast(10000000 as double))\n            +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n               +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Optimized Logical Plan ==\nGlobalLimit 11\n+- LocalLimit 11\n   +- Project [Trade_Date#16, Ticker#17, cast(Close#21 as string) AS Close#72, cast(Volume#22 as string) AS Volume#73]\n      +- Sort [Volume#22 DESC NULLS LAST], true\n         +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n            +- Filter (isnotnull(Volume#22) AND (Volume#22 > 1.0E7))\n               +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Physical Plan ==\nTakeOrderedAndProject(limit=11, orderBy=[Volume#22 DESC NULLS LAST], output=[Trade_Date#16,Ticker#17,Close#72,Volume#73])\n+- *(1) Filter (isnotnull(Volume#22) AND (Volume#22 > 1.0E7))\n   +- FileScan csv [Trade_Date#16,Ticker#17,Close#21,Volume#22] Batched: false, DataFilters: [isnotnull(Volume#22), (Volume#22 > 1.0E7)], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [IsNotNull(Volume), GreaterThan(Volume,1.0E7)], ReadSchema: struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>\n","sparkPlanInfo":{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=11, orderBy=[Volume#22 DESC NULLS LAST], output=[Trade_Date#16,Ticker#17,Close#72,Volume#73])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(Volume#22) AND (Volume#22 > 1.0E7))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [Trade_Date#16,Ticker#17,Close#21,Volume#22] Batched: false, DataFilters: [isnotnull(Volume#22), (Volume#22 > 1.0E7)], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [IsNotNull(Volume), GreaterThan(Volume,1.0E7)], ReadSchema: struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv]","ReadSchema":"struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Volume), GreaterThan(Volume,1.0E7)]","DataFilters":"[isnotnull(Volume#22), (Volume#22 > 1.0E7)]"},"metrics":[{"name":"number of output rows","accumulatorId":236,"metricType":"sum"},{"name":"number of files read","accumulatorId":237,"metricType":"sum"},{"name":"metadata time","accumulatorId":238,"metricType":"timing"},{"name":"size of files read","accumulatorId":239,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":235,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":234,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":232,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":233,"metricType":"nsTiming"},{"name":"records read","accumulatorId":230,"metricType":"sum"},{"name":"local bytes read","accumulatorId":228,"metricType":"size"},{"name":"fetch wait time","accumulatorId":229,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":226,"metricType":"size"},{"name":"local blocks read","accumulatorId":225,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":224,"metricType":"sum"},{"name":"remote bytes read to disk","accumulatorId":227,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":231,"metricType":"size"}]},"time":1691340360611}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":3,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":3,"accumUpdates":[[237,1],[238,0],[239,196138]]}
{"Event":"SparkListenerJobStart","Job ID":5,"Submission Time":1691340360797,"Stage Infos":[{"Stage ID":6,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":25,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"52\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[24],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":23,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"47\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[22],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":24,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"51\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[23],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":22,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"50\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[21],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":21,"Name":"FileScanRDD","Scope":"{\"id\":\"50\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[6],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"52\",\"name\":\"takeOrdered\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"3","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":6,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":25,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"52\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[24],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":23,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"47\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[22],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":24,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"51\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[23],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":22,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"50\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[21],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":21,"Name":"FileScanRDD","Scope":"{\"id\":\"50\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340360802,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"52\",\"name\":\"takeOrdered\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"3","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":6,"Stage Attempt ID":0,"Task Info":{"Task ID":5,"Index":0,"Attempt":0,"Launch Time":1691340360818,"Executor ID":"4","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":6,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":5,"Index":0,"Attempt":0,"Launch Time":1691340360818,"Executor ID":"4","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340361572,"Failed":false,"Killed":false,"Accumulables":[{"ID":234,"Name":"duration","Update":"542","Value":"542","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":235,"Name":"number of output rows","Update":"1400","Value":"1400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":236,"Name":"number of output rows","Update":"1400","Value":"1400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":240,"Name":"internal.metrics.executorDeserializeTime","Update":148,"Value":148,"Internal":true,"Count Failed Values":true},{"ID":241,"Name":"internal.metrics.executorDeserializeCpuTime","Update":132759155,"Value":132759155,"Internal":true,"Count Failed Values":true},{"ID":242,"Name":"internal.metrics.executorRunTime","Update":575,"Value":575,"Internal":true,"Count Failed Values":true},{"ID":243,"Name":"internal.metrics.executorCpuTime","Update":392087209,"Value":392087209,"Internal":true,"Count Failed Values":true},{"ID":244,"Name":"internal.metrics.resultSize","Update":4571,"Value":4571,"Internal":true,"Count Failed Values":true},{"ID":246,"Name":"internal.metrics.resultSerializationTime","Update":11,"Value":11,"Internal":true,"Count Failed Values":true},{"ID":261,"Name":"internal.metrics.input.bytesRead","Update":196138,"Value":196138,"Internal":true,"Count Failed Values":true},{"ID":262,"Name":"internal.metrics.input.recordsRead","Update":1400,"Value":1400,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":148,"Executor Deserialize CPU Time":132759155,"Executor Run Time":575,"Executor CPU Time":392087209,"Peak Execution Memory":0,"Result Size":4571,"JVM GC Time":0,"Result Serialization Time":11,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":196138,"Records Read":1400},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":6,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":25,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"52\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[24],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":23,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"47\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[22],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":24,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"51\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[23],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":22,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"50\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[21],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":21,"Name":"FileScanRDD","Scope":"{\"id\":\"50\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340360802,"Completion Time":1691340361573,"Accumulables":[{"ID":234,"Name":"duration","Value":"542","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":235,"Name":"number of output rows","Value":"1400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":236,"Name":"number of output rows","Value":"1400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":240,"Name":"internal.metrics.executorDeserializeTime","Value":148,"Internal":true,"Count Failed Values":true},{"ID":241,"Name":"internal.metrics.executorDeserializeCpuTime","Value":132759155,"Internal":true,"Count Failed Values":true},{"ID":242,"Name":"internal.metrics.executorRunTime","Value":575,"Internal":true,"Count Failed Values":true},{"ID":243,"Name":"internal.metrics.executorCpuTime","Value":392087209,"Internal":true,"Count Failed Values":true},{"ID":244,"Name":"internal.metrics.resultSize","Value":4571,"Internal":true,"Count Failed Values":true},{"ID":246,"Name":"internal.metrics.resultSerializationTime","Value":11,"Internal":true,"Count Failed Values":true},{"ID":261,"Name":"internal.metrics.input.bytesRead","Value":196138,"Internal":true,"Count Failed Values":true},{"ID":262,"Name":"internal.metrics.input.recordsRead","Value":1400,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":5,"Completion Time":1691340361579,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":3,"timePerRule":{"PruneFileSourcePartitions":544746,"ReassignLambdaVariableID":80332,"PushPredicateThroughNonJoin":112206,"Analyzer$ResolveEncodersInUDF":55042,"Analyzer$HandleNullInputsForUDF":73959,"OptimizeUpdateFields":454291,"Analyzer$ResolveSubqueryColumnAliases":19938,"ResolveTimeZone":70596,"Analyzer$ResolveNamespace":16592,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":22766,"RelationConversions":13554,"RewriteCorrelatedScalarSubquery":836704,"RemoveLiteralFromGroupExpressions":21500,"PushProjectionThroughUnion":77103,"EliminateSubqueryAliases":32956,"ResolveCatalogs":21657,"PushLeftSemiLeftAntiThroughJoin":61464,"Analyzer$ResolveUserSpecifiedColumns":14322,"FlattenScalarSubqueriesWithAggregates":142328,"LikeSimplification":301226,"CollapseRepartition":148149,"ResolveHints$ResolveCoalesceHints":12390,"Analyzer$ExtractGenerator":215095,"RewriteIntersectAll":22237,"Analyzer$AddMetadataColumns":184315,"ResolveHints$ResolveJoinStrategyHints":14993,"TypeCoercion$MapZipWithCoercion":71148,"NullPropagation":421179,"EliminateAggregateFilter":22551,"PullupCorrelatedPredicates":80119,"UpdateOuterReferences":20204,"ExtractPythonUDFs":355756,"Analyzer$WindowsSubstitution":14083,"CombineUnions":80811,"ExtractGroupingPythonUDFFromAggregate":23534,"ReorderAssociativeOperator":345865,"CleanupDynamicPruningFilters":390496,"ResolveHints$RemoveAllHints":12754,"SimplifyBinaryComparison":324124,"ResolveTableValuedFunctions":19189,"EliminateSerialization":86998,"OptimizeJsonExprs":538763,"GetCurrentDatabaseAndCatalog":243673,"TypeCoercion$BooleanEquality":102948,"package$ExpressionCanonicalizer$CleanExpressions":201561,"EliminateLimits":100713,"ReplaceIntersectWithSemiJoin":22345,"ConstantPropagation":114921,"PushExtraPredicateThroughJoin":91359,"CostBasedJoinReorder":20587,"Analyzer$ResolveReferences":196400,"CTESubstitution":490872,"RemoveRedundantAliases":1347052,"TypeCoercion$ImplicitTypeCasts":97778,"RewriteExceptAll":27798,"UpdateAttributeNullability":1127450,"PropagateEmptyRelation":87077,"InferFiltersFromGenerate":32509,"SimplifyCasts":860642,"EliminateMapObjects":72875,"DetectAmbiguousSelfJoin":87756,"ReplaceExpressions":91372,"ResolveInlineTables":23686,"ResolveUnion":33114,"OptimizeIn":275058,"CollapseWindow":140038,"TypeCoercion$IfCoercion":105443,"ResolveSessionCatalog":41421,"PartitionPruning":57385,"BooleanSimplification":1986174,"TypeCoercion$PromoteStrings":126592,"Analyzer$ResolveAliases":22174,"DecimalAggregates":78093,"PruneFilters":683921,"PruneHiveTablePartitions":283771,"Analyzer$ResolveMissingReferences":21121,"TransposeWindow":90931,"Analyzer$ResolveRelations":34334,"EliminateUnions":16146,"RewritePredicateSubquery":208820,"ObjectSerializerPruning":24522,"LimitPushDown":67641,"SimplifyCaseConversionExpressions":427966,"ResolvePartitionSpec":16788,"Analyzer$ResolveNaturalAndUsingJoin":23381,"UnwrapCastInBinaryComparison":334393,"EliminateView":24820,"CombineTypedFilters":24024,"ReplaceUpdateFieldsExpression":82416,"OptimizeLimitZero":35979,"CheckCartesianProducts":36830,"ExtractPythonUDFFromAggregate":27633,"Analyzer$ExtractWindowExpressions":40606,"ReplaceExceptWithAntiJoin":21791,"ResolveLambdaVariables":65664,"FallBackFileSourceV2":16602,"Analyzer$ResolveTables":27722,"SubstituteUnresolvedOrdinals":10747,"TypeCoercion$CaseWhenCoercion":77007,"DecimalPrecision":250548,"EliminateSorts":108411,"PushDownLeftSemiAntiJoin":85726,"ExtractPythonUDFFromJoinCondition":28765,"TypeCoercion$StackCoercion":79119,"Analyzer$ResolveAggAliasInGroupBy":43019,"TypeCoercion$StringLiteralCoercion":134679,"FoldablePropagation":1167560,"ResolveHiveSerdeTable":22876,"V2ScanRelationPushDown":431338,"EliminateDistinct":10148,"InferFiltersFromConstraints":2088938,"DetermineTableStats":17628,"Analyzer$PullOutNondeterministic":272966,"Analyzer$ResolveFunctions":121147,"ReplaceNullWithFalseInPredicate":401314,"ResolveHigherOrderFunctions":83635,"Analyzer$ResolvePivot":16952,"CollapseProject":131399,"Analyzer$ResolveNewInstance":44509,"ColumnPruning":10878876,"Analyzer$ResolveWindowOrder":83274,"TypeCoercion$ConcatCoercion":121781,"PushDownPredicates":821879,"TimeWindowing":133840,"Optimizer$OptimizeSubqueries":232171,"RewriteNonCorrelatedExists":77952,"TypeCoercion$Division":96913,"ComputeCurrentTime":214592,"ResolveCreateNamedStruct":75312,"TypeCoercion$EltCoercion":142140,"ConvertToLocalRelation":67827,"OptimizeWindowFunctions":194217,"RemoveRepetitionFromGroupExpressions":19753,"ReplaceDistinctWithAggregate":21321,"PreprocessTableCreation":14076,"ResolveSQLOnFile":17366,"Analyzer$ResolveSubquery":71227,"CombineConcats":14455,"Analyzer$ResolveGroupingAnalytics":28616,"Analyzer$ResolveBinaryArithmetic":119965,"RemoveDispensableExpressions":224604,"Analyzer$ResolveAlterTableChanges":15813,"ResolveEncodersInScalaAgg":115856,"TypeCoercion$IntegralDivision":88330,"Analyzer$ResolveWindowFrame":1838728,"Analyzer$ResolveDeserializer":359989,"RewriteDistinctAggregates":28729,"RemoveNoopOperators":503741,"Analyzer$ResolveAggregateFunctions":23109,"NormalizeFloatingNumbers":25083,"ReorderJoin":72675,"Analyzer$ResolveUpCast":20524,"Analyzer$ResolveGenerate":27453,"TypeCoercion$WidenSetOperationTypes":373765,"EliminateOuterJoin":66526,"SimplifyExtractValueOps":370143,"OptimizeMetadataOnlyQuery":16199,"EliminateResolvedHint":127244,"Analyzer$ResolveInsertInto":19375,"ReplaceExceptWithFilter":43335,"CleanupAliases":31906,"SchemaPruning":480757,"ResolveHints$DisableHints":24420,"Analyzer$ResolveOutputRelation":22180,"BloomFilterJoinRule":47042,"HiveAnalysis":13630,"Analyzer$ResolveRandomSeed":21163,"TypeCoercion$WindowFrameCoercion":64424,"ConstantFolding":1567760,"TypeCoercion$DateTimeOperations":94805,"ResolveNoopDropTable":14796,"TypeCoercion$InConversion":113139,"FindDataSourceTable":23419,"ApplyCharTypePadding":71504,"SimplifyConditionals":468785,"DataSourceAnalysis":13704,"TypeCoercion$FunctionArgumentConversion":140055,"Analyzer$GlobalAggregates":17847,"Analyzer$LookupFunctions":49407,"CombineFilters":89028,"ReplaceDeduplicateWithAggregate":195477,"PreprocessTableInsertion":11774},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":2,"Analyzer$HandleNullInputsForUDF":2,"OptimizeUpdateFields":5,"Analyzer$ResolveSubqueryColumnAliases":3,"ResolveTimeZone":3,"Analyzer$ResolveNamespace":3,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":3,"RelationConversions":2,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":3,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":3,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":2,"Analyzer$ExtractGenerator":3,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":3,"ResolveHints$ResolveJoinStrategyHints":2,"TypeCoercion$MapZipWithCoercion":3,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":2,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":2,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":2,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":3,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":3,"package$ExpressionCanonicalizer$CleanExpressions":10,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":3,"CTESubstitution":2,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":3,"RewriteExceptAll":1,"UpdateAttributeNullability":4,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":2,"ReplaceExpressions":1,"ResolveInlineTables":3,"ResolveUnion":3,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":3,"ResolveSessionCatalog":3,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":3,"Analyzer$ResolveAliases":3,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":3,"TransposeWindow":3,"Analyzer$ResolveRelations":3,"EliminateUnions":2,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":3,"Analyzer$ResolveNaturalAndUsingJoin":3,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":3,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":3,"FallBackFileSourceV2":3,"Analyzer$ResolveTables":3,"SubstituteUnresolvedOrdinals":2,"TypeCoercion$CaseWhenCoercion":3,"DecimalPrecision":3,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":3,"Analyzer$ResolveAggAliasInGroupBy":3,"TypeCoercion$StringLiteralCoercion":3,"FoldablePropagation":3,"ResolveHiveSerdeTable":3,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":2,"Analyzer$PullOutNondeterministic":2,"Analyzer$ResolveFunctions":3,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":3,"Analyzer$ResolvePivot":3,"CollapseProject":4,"Analyzer$ResolveNewInstance":3,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":3,"TypeCoercion$ConcatCoercion":3,"PushDownPredicates":6,"TimeWindowing":3,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"TypeCoercion$Division":3,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":3,"TypeCoercion$EltCoercion":3,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":2,"ResolveSQLOnFile":3,"Analyzer$ResolveSubquery":3,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":3,"Analyzer$ResolveBinaryArithmetic":3,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":2,"ResolveEncodersInScalaAgg":3,"TypeCoercion$IntegralDivision":3,"Analyzer$ResolveWindowFrame":3,"Analyzer$ResolveDeserializer":3,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":3,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":3,"Analyzer$ResolveGenerate":3,"TypeCoercion$WidenSetOperationTypes":3,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":3,"ReplaceExceptWithFilter":1,"CleanupAliases":2,"SchemaPruning":1,"ResolveHints$DisableHints":2,"Analyzer$ResolveOutputRelation":3,"BloomFilterJoinRule":1,"HiveAnalysis":2,"Analyzer$ResolveRandomSeed":3,"TypeCoercion$WindowFrameCoercion":3,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":3,"ResolveNoopDropTable":2,"TypeCoercion$InConversion":3,"FindDataSourceTable":3,"ApplyCharTypePadding":2,"SimplifyConditionals":3,"DataSourceAnalysis":2,"TypeCoercion$FunctionArgumentConversion":3,"Analyzer$GlobalAggregates":3,"Analyzer$LookupFunctions":2,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":2},"numEffectiveRunsPerRule":{"package$ExpressionCanonicalizer$CleanExpressions":2,"RemoveRedundantAliases":1,"SimplifyCasts":1,"InferFiltersFromConstraints":1,"PushDownPredicates":1,"Analyzer$ResolveDeserializer":1,"ConstantFolding":1},"timeEffectiveRunsPerRule":{"package$ExpressionCanonicalizer$CleanExpressions":35767,"RemoveRedundantAliases":687374,"SimplifyCasts":678320,"InferFiltersFromConstraints":2088938,"PushDownPredicates":533704,"Analyzer$ResolveDeserializer":340688,"ConstantFolding":1293038},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":3,"time":1691340361651}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":4,"description":"createOrReplaceTempView at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.createOrReplaceTempView(Dataset.scala:3341)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nCreateViewCommand `stockprice`, false, true, LocalTempView\n   +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n      +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Analyzed Logical Plan ==\n\nCreateViewCommand `stockprice`, false, true, LocalTempView\n   +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n      +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Optimized Logical Plan ==\nCreateViewCommand `stockprice`, false, true, LocalTempView\n   +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n      +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Physical Plan ==\nExecute CreateViewCommand\n   +- CreateViewCommand `stockprice`, false, true, LocalTempView\n         +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n            +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n","sparkPlanInfo":{"nodeName":"Execute CreateViewCommand","simpleString":"Execute CreateViewCommand","children":[],"metadata":{},"metrics":[]},"time":1691340393742}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":4,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":4,"timePerRule":{"PruneFileSourcePartitions":12933,"ReassignLambdaVariableID":14308,"PushPredicateThroughNonJoin":4669,"Analyzer$ResolveEncodersInUDF":11922,"Analyzer$HandleNullInputsForUDF":14493,"OptimizeUpdateFields":157144,"Analyzer$ResolveSubqueryColumnAliases":5835,"ResolveTimeZone":14809,"Analyzer$ResolveNamespace":5875,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":9269,"RelationConversions":5903,"RewriteCorrelatedScalarSubquery":110616,"RemoveLiteralFromGroupExpressions":5125,"PushProjectionThroughUnion":8452,"EliminateSubqueryAliases":11902,"ResolveCatalogs":8377,"PushLeftSemiLeftAntiThroughJoin":9974,"Analyzer$ResolveUserSpecifiedColumns":4741,"FlattenScalarSubqueriesWithAggregates":9814,"LikeSimplification":38367,"CollapseRepartition":9366,"ResolveHints$ResolveCoalesceHints":5919,"Analyzer$ExtractGenerator":27036,"RewriteIntersectAll":5944,"Analyzer$AddMetadataColumns":13275,"ResolveHints$ResolveJoinStrategyHints":7902,"TypeCoercion$MapZipWithCoercion":10438,"NullPropagation":23172,"EliminateAggregateFilter":12016,"PullupCorrelatedPredicates":7815,"UpdateOuterReferences":6939,"ExtractPythonUDFs":90408,"Analyzer$WindowsSubstitution":7582,"CombineUnions":13575,"ExtractGroupingPythonUDFFromAggregate":6067,"ReorderAssociativeOperator":40973,"CleanupDynamicPruningFilters":85164,"ResolveHints$RemoveAllHints":4612,"SimplifyBinaryComparison":18545,"ResolveTableValuedFunctions":5918,"EliminateSerialization":11235,"OptimizeJsonExprs":48736,"GetCurrentDatabaseAndCatalog":128582,"TypeCoercion$BooleanEquality":10274,"EliminateLimits":8579,"ReplaceIntersectWithSemiJoin":5540,"ConstantPropagation":8503,"PushExtraPredicateThroughJoin":6263,"CostBasedJoinReorder":8432,"Analyzer$ResolveReferences":54934,"CTESubstitution":273173,"RemoveRedundantAliases":32457,"TypeCoercion$ImplicitTypeCasts":11116,"RewriteExceptAll":6479,"UpdateAttributeNullability":79801,"PropagateEmptyRelation":10941,"InferFiltersFromGenerate":9359,"SimplifyCasts":27989,"EliminateMapObjects":9936,"DetectAmbiguousSelfJoin":40614,"ReplaceExpressions":21610,"ResolveInlineTables":5629,"ResolveUnion":13971,"OptimizeIn":19278,"CollapseWindow":11641,"TypeCoercion$IfCoercion":10585,"ResolveSessionCatalog":13150,"PartitionPruning":28398,"BooleanSimplification":22816,"TypeCoercion$PromoteStrings":22272,"Analyzer$ResolveAliases":5632,"DecimalAggregates":7281,"PruneFilters":14709,"PruneHiveTablePartitions":2754,"Analyzer$ResolveMissingReferences":5506,"TransposeWindow":10063,"Analyzer$ResolveRelations":11448,"EliminateUnions":8117,"RewritePredicateSubquery":4362,"ObjectSerializerPruning":3696,"LimitPushDown":7589,"SimplifyCaseConversionExpressions":16353,"ResolvePartitionSpec":6185,"Analyzer$ResolveNaturalAndUsingJoin":5949,"UnwrapCastInBinaryComparison":17089,"EliminateView":7220,"CombineTypedFilters":3488,"ReplaceUpdateFieldsExpression":16223,"OptimizeLimitZero":8593,"CheckCartesianProducts":21805,"ExtractPythonUDFFromAggregate":7389,"Analyzer$ExtractWindowExpressions":13188,"ReplaceExceptWithAntiJoin":4922,"ResolveLambdaVariables":12290,"FallBackFileSourceV2":5142,"Analyzer$ResolveTables":8169,"SubstituteUnresolvedOrdinals":5581,"TypeCoercion$CaseWhenCoercion":10494,"DecimalPrecision":26998,"EliminateSorts":4430,"PushDownLeftSemiAntiJoin":9817,"ExtractPythonUDFFromJoinCondition":9054,"TypeCoercion$StackCoercion":10469,"Analyzer$ResolveAggAliasInGroupBy":5664,"TypeCoercion$StringLiteralCoercion":15050,"FoldablePropagation":15265,"ResolveHiveSerdeTable":7110,"V2ScanRelationPushDown":12763,"EliminateDistinct":13361,"InferFiltersFromConstraints":17334,"DetermineTableStats":6531,"Analyzer$PullOutNondeterministic":6068,"Analyzer$ResolveFunctions":14266,"ReplaceNullWithFalseInPredicate":17634,"ResolveHigherOrderFunctions":12251,"Analyzer$ResolvePivot":5310,"CollapseProject":14898,"Analyzer$ResolveNewInstance":10871,"ColumnPruning":90730,"Analyzer$ResolveWindowOrder":13653,"TypeCoercion$ConcatCoercion":12512,"PushDownPredicates":81987,"TimeWindowing":12506,"Optimizer$OptimizeSubqueries":49514,"RewriteNonCorrelatedExists":9886,"TypeCoercion$Division":10802,"ComputeCurrentTime":113863,"ResolveCreateNamedStruct":12423,"TypeCoercion$EltCoercion":12395,"ConvertToLocalRelation":9014,"OptimizeWindowFunctions":6195,"RemoveRepetitionFromGroupExpressions":4246,"ReplaceDistinctWithAggregate":4950,"PreprocessTableCreation":6425,"ResolveSQLOnFile":5295,"Analyzer$ResolveSubquery":5959,"CombineConcats":11365,"Analyzer$ResolveGroupingAnalytics":11734,"Analyzer$ResolveBinaryArithmetic":13731,"RemoveDispensableExpressions":24923,"Analyzer$ResolveAlterTableChanges":6351,"ResolveEncodersInScalaAgg":14225,"TypeCoercion$IntegralDivision":14365,"Analyzer$ResolveWindowFrame":11805,"Analyzer$ResolveDeserializer":59981,"RewriteDistinctAggregates":6542,"RemoveNoopOperators":12602,"Analyzer$ResolveAggregateFunctions":6431,"NormalizeFloatingNumbers":7393,"ReorderJoin":9981,"Analyzer$ResolveUpCast":8603,"Analyzer$ResolveGenerate":5700,"TypeCoercion$WidenSetOperationTypes":89491,"EliminateOuterJoin":7202,"SimplifyExtractValueOps":15913,"OptimizeMetadataOnlyQuery":29177,"EliminateResolvedHint":26789,"Analyzer$ResolveInsertInto":4892,"ReplaceExceptWithFilter":22241,"CleanupAliases":14757,"SchemaPruning":27516,"ResolveHints$DisableHints":16532,"Analyzer$ResolveOutputRelation":6399,"BloomFilterJoinRule":17653,"HiveAnalysis":5578,"Analyzer$ResolveRandomSeed":6179,"TypeCoercion$WindowFrameCoercion":12265,"ConstantFolding":15870,"TypeCoercion$DateTimeOperations":9864,"ResolveNoopDropTable":5536,"TypeCoercion$InConversion":12646,"FindDataSourceTable":6162,"ApplyCharTypePadding":13678,"SimplifyConditionals":16762,"DataSourceAnalysis":5648,"TypeCoercion$FunctionArgumentConversion":10632,"Analyzer$GlobalAggregates":5002,"Analyzer$LookupFunctions":24635,"CombineFilters":9930,"ReplaceDeduplicateWithAggregate":67314,"PreprocessTableInsertion":4865},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":1,"Analyzer$HandleNullInputsForUDF":1,"OptimizeUpdateFields":3,"Analyzer$ResolveSubqueryColumnAliases":1,"ResolveTimeZone":1,"Analyzer$ResolveNamespace":1,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":1,"RelationConversions":1,"RewriteCorrelatedScalarSubquery":2,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":2,"EliminateSubqueryAliases":1,"ResolveCatalogs":1,"PushLeftSemiLeftAntiThroughJoin":2,"Analyzer$ResolveUserSpecifiedColumns":1,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":2,"CollapseRepartition":2,"ResolveHints$ResolveCoalesceHints":1,"Analyzer$ExtractGenerator":1,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":1,"ResolveHints$ResolveJoinStrategyHints":1,"TypeCoercion$MapZipWithCoercion":1,"NullPropagation":2,"EliminateAggregateFilter":2,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":1,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":1,"CombineUnions":3,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":2,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":1,"SimplifyBinaryComparison":2,"ResolveTableValuedFunctions":1,"EliminateSerialization":2,"OptimizeJsonExprs":2,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":1,"EliminateLimits":2,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":2,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":1,"CTESubstitution":1,"RemoveRedundantAliases":2,"TypeCoercion$ImplicitTypeCasts":1,"RewriteExceptAll":1,"UpdateAttributeNullability":3,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":2,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":1,"ReplaceExpressions":1,"ResolveInlineTables":1,"ResolveUnion":1,"OptimizeIn":2,"CollapseWindow":2,"TypeCoercion$IfCoercion":1,"ResolveSessionCatalog":1,"PartitionPruning":1,"BooleanSimplification":2,"TypeCoercion$PromoteStrings":1,"Analyzer$ResolveAliases":1,"DecimalAggregates":1,"PruneFilters":3,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":1,"TransposeWindow":2,"Analyzer$ResolveRelations":1,"EliminateUnions":1,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":2,"SimplifyCaseConversionExpressions":2,"ResolvePartitionSpec":1,"Analyzer$ResolveNaturalAndUsingJoin":1,"UnwrapCastInBinaryComparison":2,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":1,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":1,"FallBackFileSourceV2":1,"Analyzer$ResolveTables":1,"SubstituteUnresolvedOrdinals":1,"TypeCoercion$CaseWhenCoercion":1,"DecimalPrecision":1,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":2,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":1,"Analyzer$ResolveAggAliasInGroupBy":1,"TypeCoercion$StringLiteralCoercion":1,"FoldablePropagation":2,"ResolveHiveSerdeTable":1,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":1,"Analyzer$PullOutNondeterministic":1,"Analyzer$ResolveFunctions":1,"ReplaceNullWithFalseInPredicate":2,"ResolveHigherOrderFunctions":1,"Analyzer$ResolvePivot":1,"CollapseProject":3,"Analyzer$ResolveNewInstance":1,"ColumnPruning":4,"Analyzer$ResolveWindowOrder":1,"TypeCoercion$ConcatCoercion":1,"PushDownPredicates":5,"TimeWindowing":1,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"TypeCoercion$Division":1,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":1,"TypeCoercion$EltCoercion":1,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":2,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":1,"ResolveSQLOnFile":1,"Analyzer$ResolveSubquery":1,"CombineConcats":2,"Analyzer$ResolveGroupingAnalytics":1,"Analyzer$ResolveBinaryArithmetic":1,"RemoveDispensableExpressions":2,"Analyzer$ResolveAlterTableChanges":1,"ResolveEncodersInScalaAgg":1,"TypeCoercion$IntegralDivision":1,"Analyzer$ResolveWindowFrame":1,"Analyzer$ResolveDeserializer":1,"RewriteDistinctAggregates":1,"RemoveNoopOperators":4,"Analyzer$ResolveAggregateFunctions":1,"NormalizeFloatingNumbers":1,"ReorderJoin":2,"Analyzer$ResolveUpCast":1,"Analyzer$ResolveGenerate":1,"TypeCoercion$WidenSetOperationTypes":1,"EliminateOuterJoin":2,"SimplifyExtractValueOps":2,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":1,"ReplaceExceptWithFilter":1,"CleanupAliases":1,"SchemaPruning":1,"ResolveHints$DisableHints":1,"Analyzer$ResolveOutputRelation":1,"BloomFilterJoinRule":1,"HiveAnalysis":1,"Analyzer$ResolveRandomSeed":1,"TypeCoercion$WindowFrameCoercion":1,"ConstantFolding":2,"TypeCoercion$DateTimeOperations":1,"ResolveNoopDropTable":1,"TypeCoercion$InConversion":1,"FindDataSourceTable":1,"ApplyCharTypePadding":1,"SimplifyConditionals":2,"DataSourceAnalysis":1,"TypeCoercion$FunctionArgumentConversion":1,"Analyzer$GlobalAggregates":1,"Analyzer$LookupFunctions":1,"CombineFilters":3,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":1},"numEffectiveRunsPerRule":{},"timeEffectiveRunsPerRule":{},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":4,"time":1691340393763}
{"Event":"SparkListenerBlockManagerRemoved","Block Manager ID":{"Executor ID":"4","Host":"ip-10-0-10-231.us-west-2.compute.internal","Port":32903},"Timestamp":1691340422909}
{"Event":"SparkListenerExecutorRemoved","Timestamp":1691340422914,"Executor ID":"4","Removed Reason":"Container container_1691339165261_0001_01_000008 exited from explicit termination request."}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":5,"description":"showString at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nGlobalLimit 21\n+- LocalLimit 21\n   +- Project [cast(Trade_Date#16 as string) AS Trade_Date#96, cast(Ticker#17 as string) AS Ticker#97, cast(Closing_Value#87 as string) AS Closing_Value#98, cast(Volume#22 as string) AS Volume#99]\n      +- Sort [Volume#22 DESC NULLS LAST], true\n         +- GlobalLimit 10\n            +- LocalLimit 10\n               +- Project [Trade_Date#16, Ticker#17, Closing_Value#87, Volume#22]\n                  +- Sort [Close#21 DESC NULLS LAST], true\n                     +- Project [Trade_Date#16, Ticker#17, round(cast(Close#21 as double), 2) AS Closing_Value#87, Volume#22, Close#21]\n                        +- Filter (Volume#22 > cast(10000000 as double))\n                           +- SubqueryAlias stockprice\n                              +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n                                 +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Analyzed Logical Plan ==\nTrade_Date: string, Ticker: string, Closing_Value: string, Volume: string\nGlobalLimit 21\n+- LocalLimit 21\n   +- Project [cast(Trade_Date#16 as string) AS Trade_Date#96, cast(Ticker#17 as string) AS Ticker#97, cast(Closing_Value#87 as string) AS Closing_Value#98, cast(Volume#22 as string) AS Volume#99]\n      +- Sort [Volume#22 DESC NULLS LAST], true\n         +- GlobalLimit 10\n            +- LocalLimit 10\n               +- Project [Trade_Date#16, Ticker#17, Closing_Value#87, Volume#22]\n                  +- Sort [Close#21 DESC NULLS LAST], true\n                     +- Project [Trade_Date#16, Ticker#17, round(cast(Close#21 as double), 2) AS Closing_Value#87, Volume#22, Close#21]\n                        +- Filter (Volume#22 > cast(10000000 as double))\n                           +- SubqueryAlias stockprice\n                              +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n                                 +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Optimized Logical Plan ==\nProject [Trade_Date#16, Ticker#17, cast(Closing_Value#87 as string) AS Closing_Value#98, cast(Volume#22 as string) AS Volume#99]\n+- Sort [Volume#22 DESC NULLS LAST], true\n   +- GlobalLimit 10\n      +- LocalLimit 10\n         +- Project [Trade_Date#16, Ticker#17, Closing_Value#87, Volume#22]\n            +- Sort [Close#21 DESC NULLS LAST], true\n               +- Project [Trade_Date#16, Ticker#17, round(Close#21, 2) AS Closing_Value#87, Volume#22, Close#21]\n                  +- Filter (isnotnull(Volume#22) AND (Volume#22 > 1.0E7))\n                     +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=false\n+- Project [Trade_Date#16, Ticker#17, cast(Closing_Value#87 as string) AS Closing_Value#98, cast(Volume#22 as string) AS Volume#99]\n   +- Sort [Volume#22 DESC NULLS LAST], true, 0\n      +- TakeOrderedAndProject(limit=10, orderBy=[Close#21 DESC NULLS LAST], output=[Trade_Date#16,Ticker#17,Closing_Value#87,Volume#22])\n         +- Project [Trade_Date#16, Ticker#17, round(Close#21, 2) AS Closing_Value#87, Volume#22, Close#21]\n            +- Filter (isnotnull(Volume#22) AND (Volume#22 > 1.0E7))\n               +- FileScan csv [Trade_Date#16,Ticker#17,Close#21,Volume#22] Batched: false, DataFilters: [isnotnull(Volume#22), (Volume#22 > 1.0E7)], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [IsNotNull(Volume), GreaterThan(Volume,1.0E7)], ReadSchema: struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"Project","simpleString":"Project [Trade_Date#16, Ticker#17, cast(Closing_Value#87 as string) AS Closing_Value#98, cast(Volume#22 as string) AS Volume#99]","children":[{"nodeName":"Sort","simpleString":"Sort [Volume#22 DESC NULLS LAST], true, 0","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=10, orderBy=[Close#21 DESC NULLS LAST], output=[Trade_Date#16,Ticker#17,Closing_Value#87,Volume#22])","children":[{"nodeName":"Project","simpleString":"Project [Trade_Date#16, Ticker#17, round(Close#21, 2) AS Closing_Value#87, Volume#22, Close#21]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(Volume#22) AND (Volume#22 > 1.0E7))","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [Trade_Date#16,Ticker#17,Close#21,Volume#22] Batched: false, DataFilters: [isnotnull(Volume#22), (Volume#22 > 1.0E7)], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [IsNotNull(Volume), GreaterThan(Volume,1.0E7)], ReadSchema: struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv]","ReadSchema":"struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Volume), GreaterThan(Volume,1.0E7)]","DataFilters":"[isnotnull(Volume#22), (Volume#22 > 1.0E7)]"},"metrics":[{"name":"number of output rows","accumulatorId":279,"metricType":"sum"},{"name":"number of files read","accumulatorId":280,"metricType":"sum"},{"name":"metadata time","accumulatorId":281,"metricType":"timing"},{"name":"size of files read","accumulatorId":282,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":278,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":276,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":277,"metricType":"nsTiming"},{"name":"records read","accumulatorId":274,"metricType":"sum"},{"name":"local bytes read","accumulatorId":272,"metricType":"size"},{"name":"fetch wait time","accumulatorId":273,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":270,"metricType":"size"},{"name":"local blocks read","accumulatorId":269,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":268,"metricType":"sum"},{"name":"remote bytes read to disk","accumulatorId":271,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":275,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":265,"metricType":"timing"},{"name":"peak memory","accumulatorId":266,"metricType":"size"},{"name":"spill size","accumulatorId":267,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]},"time":1691340431407}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":5,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":5,"physicalPlanDescription":"== Parsed Logical Plan ==\nGlobalLimit 21\n+- LocalLimit 21\n   +- Project [cast(Trade_Date#16 as string) AS Trade_Date#96, cast(Ticker#17 as string) AS Ticker#97, cast(Closing_Value#87 as string) AS Closing_Value#98, cast(Volume#22 as string) AS Volume#99]\n      +- Sort [Volume#22 DESC NULLS LAST], true\n         +- GlobalLimit 10\n            +- LocalLimit 10\n               +- Project [Trade_Date#16, Ticker#17, Closing_Value#87, Volume#22]\n                  +- Sort [Close#21 DESC NULLS LAST], true\n                     +- Project [Trade_Date#16, Ticker#17, round(cast(Close#21 as double), 2) AS Closing_Value#87, Volume#22, Close#21]\n                        +- Filter (Volume#22 > cast(10000000 as double))\n                           +- SubqueryAlias stockprice\n                              +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n                                 +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Analyzed Logical Plan ==\nTrade_Date: string, Ticker: string, Closing_Value: string, Volume: string\nGlobalLimit 21\n+- LocalLimit 21\n   +- Project [cast(Trade_Date#16 as string) AS Trade_Date#96, cast(Ticker#17 as string) AS Ticker#97, cast(Closing_Value#87 as string) AS Closing_Value#98, cast(Volume#22 as string) AS Volume#99]\n      +- Sort [Volume#22 DESC NULLS LAST], true\n         +- GlobalLimit 10\n            +- LocalLimit 10\n               +- Project [Trade_Date#16, Ticker#17, Closing_Value#87, Volume#22]\n                  +- Sort [Close#21 DESC NULLS LAST], true\n                     +- Project [Trade_Date#16, Ticker#17, round(cast(Close#21 as double), 2) AS Closing_Value#87, Volume#22, Close#21]\n                        +- Filter (Volume#22 > cast(10000000 as double))\n                           +- SubqueryAlias stockprice\n                              +- Project [Trade_Date#16, Ticker#17, Close#21, Volume#22]\n                                 +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Optimized Logical Plan ==\nProject [Trade_Date#16, Ticker#17, cast(Closing_Value#87 as string) AS Closing_Value#98, cast(Volume#22 as string) AS Volume#99]\n+- Sort [Volume#22 DESC NULLS LAST], true\n   +- GlobalLimit 10\n      +- LocalLimit 10\n         +- Project [Trade_Date#16, Ticker#17, Closing_Value#87, Volume#22]\n            +- Sort [Close#21 DESC NULLS LAST], true\n               +- Project [Trade_Date#16, Ticker#17, round(Close#21, 2) AS Closing_Value#87, Volume#22, Close#21]\n                  +- Filter (isnotnull(Volume#22) AND (Volume#22 > 1.0E7))\n                     +- Relation[Trade_Date#16,Ticker#17,High#18,Low#19,Open#20,Close#21,Volume#22,Adj_Close#23] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=true\n+- == Final Plan ==\n   *(2) Project [Trade_Date#16, Ticker#17, cast(Closing_Value#87 as string) AS Closing_Value#98, cast(Volume#22 as string) AS Volume#99]\n   +- *(2) Sort [Volume#22 DESC NULLS LAST], true, 0\n      +- TakeOrderedAndProject(limit=10, orderBy=[Close#21 DESC NULLS LAST], output=[Trade_Date#16,Ticker#17,Closing_Value#87,Volume#22])\n         +- *(1) Project [Trade_Date#16, Ticker#17, round(Close#21, 2) AS Closing_Value#87, Volume#22, Close#21]\n            +- *(1) Filter (isnotnull(Volume#22) AND (Volume#22 > 1.0E7))\n               +- FileScan csv [Trade_Date#16,Ticker#17,Close#21,Volume#22] Batched: false, DataFilters: [isnotnull(Volume#22), (Volume#22 > 1.0E7)], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [IsNotNull(Volume), GreaterThan(Volume,1.0E7)], ReadSchema: struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>\n+- == Initial Plan ==\n   Project [Trade_Date#16, Ticker#17, cast(Closing_Value#87 as string) AS Closing_Value#98, cast(Volume#22 as string) AS Volume#99]\n   +- Sort [Volume#22 DESC NULLS LAST], true, 0\n      +- TakeOrderedAndProject(limit=10, orderBy=[Close#21 DESC NULLS LAST], output=[Trade_Date#16,Ticker#17,Closing_Value#87,Volume#22])\n         +- Project [Trade_Date#16, Ticker#17, round(Close#21, 2) AS Closing_Value#87, Volume#22, Close#21]\n            +- Filter (isnotnull(Volume#22) AND (Volume#22 > 1.0E7))\n               +- FileScan csv [Trade_Date#16,Ticker#17,Close#21,Volume#22] Batched: false, DataFilters: [isnotnull(Volume#22), (Volume#22 > 1.0E7)], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [IsNotNull(Volume), GreaterThan(Volume,1.0E7)], ReadSchema: struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=true","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"Project","simpleString":"Project [Trade_Date#16, Ticker#17, cast(Closing_Value#87 as string) AS Closing_Value#98, cast(Volume#22 as string) AS Volume#99]","children":[{"nodeName":"Sort","simpleString":"Sort [Volume#22 DESC NULLS LAST], true, 0","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=10, orderBy=[Close#21 DESC NULLS LAST], output=[Trade_Date#16,Ticker#17,Closing_Value#87,Volume#22])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Project","simpleString":"Project [Trade_Date#16, Ticker#17, round(Close#21, 2) AS Closing_Value#87, Volume#22, Close#21]","children":[{"nodeName":"Filter","simpleString":"Filter (isnotnull(Volume#22) AND (Volume#22 > 1.0E7))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [Trade_Date#16,Ticker#17,Close#21,Volume#22] Batched: false, DataFilters: [isnotnull(Volume#22), (Volume#22 > 1.0E7)], Format: CSV, Location: InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv], PartitionFilters: [], PushedFilters: [IsNotNull(Volume), GreaterThan(Volume,1.0E7)], ReadSchema: struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://databucket-us-west-2-165206281/data/stock_prices.csv]","ReadSchema":"struct<Trade_Date:string,Ticker:string,Close:double,Volume:double>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[IsNotNull(Volume), GreaterThan(Volume,1.0E7)]","DataFilters":"[isnotnull(Volume#22), (Volume#22 > 1.0E7)]"},"metrics":[{"name":"number of output rows","accumulatorId":279,"metricType":"sum"},{"name":"number of files read","accumulatorId":280,"metricType":"sum"},{"name":"metadata time","accumulatorId":281,"metricType":"timing"},{"name":"size of files read","accumulatorId":282,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":298,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":297,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":295,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":296,"metricType":"nsTiming"},{"name":"records read","accumulatorId":293,"metricType":"sum"},{"name":"local bytes read","accumulatorId":291,"metricType":"size"},{"name":"fetch wait time","accumulatorId":292,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":289,"metricType":"size"},{"name":"local blocks read","accumulatorId":288,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":287,"metricType":"sum"},{"name":"remote bytes read to disk","accumulatorId":290,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":294,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"sort time","accumulatorId":284,"metricType":"timing"},{"name":"peak memory","accumulatorId":285,"metricType":"size"},{"name":"spill size","accumulatorId":286,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":283,"metricType":"timing"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":5,"accumUpdates":[[280,1],[281,0],[282,196138]]}
{"Event":"SparkListenerJobStart","Job ID":6,"Submission Time":1691340431796,"Stage Infos":[{"Stage ID":7,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":31,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[30],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":28,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"63\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[27],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":26,"Name":"FileScanRDD","Scope":"{\"id\":\"67\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":29,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[28],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":30,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[29],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":27,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"67\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[26],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0},{"Stage ID":8,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":35,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"68\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[34],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":34,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"58\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[33],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":32,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[31],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":33,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[32],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[7],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[7,8],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"69\",\"name\":\"collect\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"5","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":7,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":31,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[30],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":28,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"63\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[27],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":26,"Name":"FileScanRDD","Scope":"{\"id\":\"67\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":29,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[28],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":30,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[29],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":27,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"67\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[26],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340431802,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"69\",\"name\":\"collect\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"5","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerExecutorAdded","Timestamp":1691340437077,"Executor ID":"5","Executor Info":{"Host":"ip-10-0-10-231.us-west-2.compute.internal","Total Cores":4,"Log Urls":{"stdout":"http://ip-10-0-10-231.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000011/hadoop/stdout?start=-4096","stderr":"http://ip-10-0-10-231.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000011/hadoop/stderr?start=-4096"},"Attributes":{"NM_HTTP_ADDRESS":"ip-10-0-10-231.us-west-2.compute.internal:8042","USER":"hadoop","LOG_FILES":"stderr,stdout","NM_HTTP_PORT":"8042","CLUSTER_ID":"","NM_PORT":"8041","HTTP_SCHEME":"http://","NM_HOST":"ip-10-0-10-231.us-west-2.compute.internal","CONTAINER_ID":"container_1691339165261_0001_01_000011"},"Resources":{},"Resource Profile Id":0}}
{"Event":"SparkListenerBlockManagerAdded","Block Manager ID":{"Executor ID":"5","Host":"ip-10-0-10-231.us-west-2.compute.internal","Port":40845},"Maximum Memory":2199493017,"Timestamp":1691340437488,"Maximum Onheap Memory":2199493017,"Maximum Offheap Memory":0}
{"Event":"SparkListenerTaskStart","Stage ID":7,"Stage Attempt ID":0,"Task Info":{"Task ID":6,"Index":0,"Attempt":0,"Launch Time":1691340437606,"Executor ID":"5","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":7,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":6,"Index":0,"Attempt":0,"Launch Time":1691340437606,"Executor ID":"5","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340443694,"Failed":false,"Killed":false,"Accumulables":[{"ID":279,"Name":"number of output rows","Update":"1400","Value":"1400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":294,"Name":"shuffle bytes written","Update":"391","Value":"391","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":295,"Name":"shuffle records written","Update":"10","Value":"10","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":296,"Name":"shuffle write time","Update":"16900848","Value":"16900848","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":297,"Name":"duration","Update":"2301","Value":"2301","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":298,"Name":"number of output rows","Update":"1400","Value":"1400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":299,"Name":"internal.metrics.executorDeserializeTime","Update":3349,"Value":3349,"Internal":true,"Count Failed Values":true},{"ID":300,"Name":"internal.metrics.executorDeserializeCpuTime","Update":1724887193,"Value":1724887193,"Internal":true,"Count Failed Values":true},{"ID":301,"Name":"internal.metrics.executorRunTime","Update":2684,"Value":2684,"Internal":true,"Count Failed Values":true},{"ID":302,"Name":"internal.metrics.executorCpuTime","Update":1965713969,"Value":1965713969,"Internal":true,"Count Failed Values":true},{"ID":303,"Name":"internal.metrics.resultSize","Update":2651,"Value":2651,"Internal":true,"Count Failed Values":true},{"ID":304,"Name":"internal.metrics.jvmGCTime","Update":240,"Value":240,"Internal":true,"Count Failed Values":true},{"ID":305,"Name":"internal.metrics.resultSerializationTime","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":317,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":391,"Value":391,"Internal":true,"Count Failed Values":true},{"ID":318,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":10,"Value":10,"Internal":true,"Count Failed Values":true},{"ID":319,"Name":"internal.metrics.shuffle.write.writeTime","Update":16900848,"Value":16900848,"Internal":true,"Count Failed Values":true},{"ID":320,"Name":"internal.metrics.input.bytesRead","Update":196138,"Value":196138,"Internal":true,"Count Failed Values":true},{"ID":321,"Name":"internal.metrics.input.recordsRead","Update":1400,"Value":1400,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":3349,"Executor Deserialize CPU Time":1724887193,"Executor Run Time":2684,"Executor CPU Time":1965713969,"Peak Execution Memory":0,"Result Size":2651,"JVM GC Time":240,"Result Serialization Time":1,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":391,"Shuffle Write Time":16900848,"Shuffle Records Written":10},"Input Metrics":{"Bytes Read":196138,"Records Read":1400},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":7,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":31,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[30],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":28,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"63\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[27],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":26,"Name":"FileScanRDD","Scope":"{\"id\":\"67\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":29,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[28],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":30,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[29],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":27,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"67\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[26],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340431802,"Completion Time":1691340443696,"Accumulables":[{"ID":279,"Name":"number of output rows","Value":"1400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":294,"Name":"shuffle bytes written","Value":"391","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":295,"Name":"shuffle records written","Value":"10","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":296,"Name":"shuffle write time","Value":"16900848","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":297,"Name":"duration","Value":"2301","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":298,"Name":"number of output rows","Value":"1400","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":299,"Name":"internal.metrics.executorDeserializeTime","Value":3349,"Internal":true,"Count Failed Values":true},{"ID":300,"Name":"internal.metrics.executorDeserializeCpuTime","Value":1724887193,"Internal":true,"Count Failed Values":true},{"ID":301,"Name":"internal.metrics.executorRunTime","Value":2684,"Internal":true,"Count Failed Values":true},{"ID":302,"Name":"internal.metrics.executorCpuTime","Value":1965713969,"Internal":true,"Count Failed Values":true},{"ID":303,"Name":"internal.metrics.resultSize","Value":2651,"Internal":true,"Count Failed Values":true},{"ID":304,"Name":"internal.metrics.jvmGCTime","Value":240,"Internal":true,"Count Failed Values":true},{"ID":305,"Name":"internal.metrics.resultSerializationTime","Value":1,"Internal":true,"Count Failed Values":true},{"ID":317,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":391,"Internal":true,"Count Failed Values":true},{"ID":318,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":10,"Internal":true,"Count Failed Values":true},{"ID":319,"Name":"internal.metrics.shuffle.write.writeTime","Value":16900848,"Internal":true,"Count Failed Values":true},{"ID":320,"Name":"internal.metrics.input.bytesRead","Value":196138,"Internal":true,"Count Failed Values":true},{"ID":321,"Name":"internal.metrics.input.recordsRead","Value":1400,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":8,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":35,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"68\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[34],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":34,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"58\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[33],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":32,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[31],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":33,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[32],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[7],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340443699,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"stock-summary","spark.rdd.scope":"{\"id\":\"69\",\"name\":\"collect\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"5","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":8,"Stage Attempt ID":0,"Task Info":{"Task ID":7,"Index":0,"Attempt":0,"Launch Time":1691340443709,"Executor ID":"5","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":8,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":7,"Index":0,"Attempt":0,"Launch Time":1691340443709,"Executor ID":"5","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340444270,"Failed":false,"Killed":false,"Accumulables":[{"ID":283,"Name":"duration","Update":"116","Value":"116","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":284,"Name":"sort time","Update":"2","Value":"2","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":285,"Name":"peak memory","Update":"33619968","Value":"33619968","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":286,"Name":"spill size","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":288,"Name":"local blocks read","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":291,"Name":"local bytes read","Update":"391","Value":"391","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":292,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":293,"Name":"records read","Update":"10","Value":"10","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":324,"Name":"internal.metrics.executorDeserializeTime","Update":241,"Value":241,"Internal":true,"Count Failed Values":true},{"ID":325,"Name":"internal.metrics.executorDeserializeCpuTime","Update":207657356,"Value":207657356,"Internal":true,"Count Failed Values":true},{"ID":326,"Name":"internal.metrics.executorRunTime","Update":304,"Value":304,"Internal":true,"Count Failed Values":true},{"ID":327,"Name":"internal.metrics.executorCpuTime","Update":236001017,"Value":236001017,"Internal":true,"Count Failed Values":true},{"ID":328,"Name":"internal.metrics.resultSize","Update":3454,"Value":3454,"Internal":true,"Count Failed Values":true},{"ID":333,"Name":"internal.metrics.peakExecutionMemory","Update":33619968,"Value":33619968,"Internal":true,"Count Failed Values":true},{"ID":335,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":336,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":337,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":338,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":339,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":391,"Value":391,"Internal":true,"Count Failed Values":true},{"ID":340,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":341,"Name":"internal.metrics.shuffle.read.recordsRead","Update":10,"Value":10,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":241,"Executor Deserialize CPU Time":207657356,"Executor Run Time":304,"Executor CPU Time":236001017,"Peak Execution Memory":33619968,"Result Size":3454,"JVM GC Time":0,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":1,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":391,"Total Records Read":10},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":8,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":35,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"68\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[34],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":34,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"58\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[33],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":32,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[31],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":33,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"62\",\"name\":\"TakeOrderedAndProject\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[32],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[7],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340443699,"Completion Time":1691340444271,"Accumulables":[{"ID":283,"Name":"duration","Value":"116","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":284,"Name":"sort time","Value":"2","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":285,"Name":"peak memory","Value":"33619968","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":286,"Name":"spill size","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":288,"Name":"local blocks read","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":291,"Name":"local bytes read","Value":"391","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":292,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":293,"Name":"records read","Value":"10","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":324,"Name":"internal.metrics.executorDeserializeTime","Value":241,"Internal":true,"Count Failed Values":true},{"ID":325,"Name":"internal.metrics.executorDeserializeCpuTime","Value":207657356,"Internal":true,"Count Failed Values":true},{"ID":326,"Name":"internal.metrics.executorRunTime","Value":304,"Internal":true,"Count Failed Values":true},{"ID":327,"Name":"internal.metrics.executorCpuTime","Value":236001017,"Internal":true,"Count Failed Values":true},{"ID":328,"Name":"internal.metrics.resultSize","Value":3454,"Internal":true,"Count Failed Values":true},{"ID":333,"Name":"internal.metrics.peakExecutionMemory","Value":33619968,"Internal":true,"Count Failed Values":true},{"ID":335,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":336,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":1,"Internal":true,"Count Failed Values":true},{"ID":337,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":338,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":339,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":391,"Internal":true,"Count Failed Values":true},{"ID":340,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":341,"Name":"internal.metrics.shuffle.read.recordsRead","Value":10,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":6,"Completion Time":1691340444272,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":5,"timePerRule":{"PruneFileSourcePartitions":3386526,"ReassignLambdaVariableID":125164,"PushPredicateThroughNonJoin":53164,"Analyzer$ResolveEncodersInUDF":53454,"Analyzer$HandleNullInputsForUDF":70573,"OptimizeUpdateFields":466886,"Analyzer$ResolveSubqueryColumnAliases":21122,"ResolveTimeZone":67985,"Analyzer$ResolveNamespace":20354,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":24616,"RelationConversions":14372,"RewriteCorrelatedScalarSubquery":1677396,"RemoveLiteralFromGroupExpressions":373651,"PushProjectionThroughUnion":98342,"EliminateSubqueryAliases":1266648,"ResolveCatalogs":26502,"PushLeftSemiLeftAntiThroughJoin":133767,"Analyzer$ResolveUserSpecifiedColumns":18584,"FlattenScalarSubqueriesWithAggregates":169329,"LikeSimplification":655134,"CollapseRepartition":186520,"ResolveHints$ResolveCoalesceHints":16237,"Analyzer$ExtractGenerator":121561,"RewriteIntersectAll":32895,"Analyzer$AddMetadataColumns":115702,"ResolveHints$ResolveJoinStrategyHints":19478,"TypeCoercion$MapZipWithCoercion":73303,"NullPropagation":1068580,"EliminateAggregateFilter":63917,"PullupCorrelatedPredicates":125596,"UpdateOuterReferences":21021,"ExtractPythonUDFs":402714,"Analyzer$WindowsSubstitution":18240,"CombineUnions":117174,"ExtractGroupingPythonUDFFromAggregate":30770,"ReorderAssociativeOperator":821057,"CleanupDynamicPruningFilters":3487371,"ResolveHints$RemoveAllHints":13854,"SimplifyBinaryComparison":807114,"ResolveTableValuedFunctions":23671,"EliminateSerialization":103032,"OptimizeJsonExprs":1106911,"GetCurrentDatabaseAndCatalog":228016,"TypeCoercion$BooleanEquality":168635,"package$ExpressionCanonicalizer$CleanExpressions":98037,"EliminateLimits":191959,"ReplaceIntersectWithSemiJoin":32862,"ConstantPropagation":260460,"PushExtraPredicateThroughJoin":33638,"CostBasedJoinReorder":24409,"Analyzer$ResolveReferences":343201,"CTESubstitution":1329538,"RemoveRedundantAliases":1697885,"TypeCoercion$ImplicitTypeCasts":95201,"RewriteExceptAll":89821,"UpdateAttributeNullability":4919933,"PropagateEmptyRelation":139768,"InferFiltersFromGenerate":36411,"SimplifyCasts":1019916,"EliminateMapObjects":117509,"DetectAmbiguousSelfJoin":91144,"ReplaceExpressions":131043,"ResolveInlineTables":23497,"ResolveUnion":32843,"OptimizeIn":630135,"CollapseWindow":112927,"TypeCoercion$IfCoercion":98383,"ResolveSessionCatalog":40260,"PartitionPruning":65221,"BooleanSimplification":1956970,"TypeCoercion$PromoteStrings":128979,"Analyzer$ResolveAliases":22984,"DecimalAggregates":123414,"PruneFilters":1282169,"PruneHiveTablePartitions":539874,"Analyzer$ResolveMissingReferences":18662,"TransposeWindow":114859,"Analyzer$ResolveRelations":41704,"EliminateUnions":19449,"RewritePredicateSubquery":754743,"ObjectSerializerPruning":33869,"LimitPushDown":119997,"SimplifyCaseConversionExpressions":717528,"ResolvePartitionSpec":22473,"Analyzer$ResolveNaturalAndUsingJoin":22001,"UnwrapCastInBinaryComparison":771632,"EliminateView":73604,"CombineTypedFilters":32469,"ReplaceUpdateFieldsExpression":120343,"OptimizeLimitZero":58607,"CheckCartesianProducts":38928,"ExtractPythonUDFFromAggregate":38063,"Analyzer$ExtractWindowExpressions":28487,"ReplaceExceptWithAntiJoin":35812,"ResolveLambdaVariables":46065,"FallBackFileSourceV2":17051,"Analyzer$ResolveTables":33420,"SubstituteUnresolvedOrdinals":12529,"TypeCoercion$CaseWhenCoercion":70159,"DecimalPrecision":273510,"EliminateSorts":1805108,"PushDownLeftSemiAntiJoin":106585,"ExtractPythonUDFFromJoinCondition":36602,"TypeCoercion$StackCoercion":64718,"Analyzer$ResolveAggAliasInGroupBy":18701,"TypeCoercion$StringLiteralCoercion":88414,"FoldablePropagation":3560757,"ResolveHiveSerdeTable":23314,"V2ScanRelationPushDown":495143,"EliminateDistinct":11823,"InferFiltersFromConstraints":1816956,"DetermineTableStats":17094,"Analyzer$PullOutNondeterministic":172646,"Analyzer$ResolveFunctions":108641,"ReplaceNullWithFalseInPredicate":658499,"ResolveHigherOrderFunctions":72130,"Analyzer$ResolvePivot":21621,"CollapseProject":1010020,"Analyzer$ResolveNewInstance":56613,"ColumnPruning":13445873,"Analyzer$ResolveWindowOrder":69782,"TypeCoercion$ConcatCoercion":158155,"PushDownPredicates":1148075,"TimeWindowing":120169,"Optimizer$OptimizeSubqueries":627431,"RewriteNonCorrelatedExists":114799,"TypeCoercion$Division":89404,"ComputeCurrentTime":192157,"ResolveCreateNamedStruct":93833,"TypeCoercion$EltCoercion":101663,"ConvertToLocalRelation":90940,"OptimizeWindowFunctions":466428,"RemoveRepetitionFromGroupExpressions":48300,"ReplaceDistinctWithAggregate":77261,"PreprocessTableCreation":15147,"ResolveSQLOnFile":18364,"Analyzer$ResolveSubquery":66696,"CombineConcats":42643,"Analyzer$ResolveGroupingAnalytics":33156,"Analyzer$ResolveBinaryArithmetic":137799,"RemoveDispensableExpressions":584150,"Analyzer$ResolveAlterTableChanges":16487,"ResolveEncodersInScalaAgg":91456,"TypeCoercion$IntegralDivision":85642,"Analyzer$ResolveWindowFrame":66517,"Analyzer$ResolveDeserializer":461103,"RewriteDistinctAggregates":48547,"RemoveNoopOperators":552105,"Analyzer$ResolveAggregateFunctions":21761,"NormalizeFloatingNumbers":32421,"ReorderJoin":92729,"Analyzer$ResolveUpCast":23813,"Analyzer$ResolveGenerate":21893,"TypeCoercion$WidenSetOperationTypes":868483,"EliminateOuterJoin":80937,"SimplifyExtractValueOps":1413965,"OptimizeMetadataOnlyQuery":15717,"EliminateResolvedHint":115714,"Analyzer$ResolveInsertInto":18039,"ReplaceExceptWithFilter":119709,"CleanupAliases":31769,"SchemaPruning":711481,"ResolveHints$DisableHints":27819,"Analyzer$ResolveOutputRelation":21234,"BloomFilterJoinRule":49663,"HiveAnalysis":13668,"Analyzer$ResolveRandomSeed":20314,"TypeCoercion$WindowFrameCoercion":65631,"ConstantFolding":2959136,"TypeCoercion$DateTimeOperations":95983,"ResolveNoopDropTable":17054,"TypeCoercion$InConversion":98888,"FindDataSourceTable":23353,"ApplyCharTypePadding":66133,"SimplifyConditionals":983873,"DataSourceAnalysis":13435,"TypeCoercion$FunctionArgumentConversion":117502,"Analyzer$GlobalAggregates":18576,"Analyzer$LookupFunctions":66118,"CombineFilters":382501,"ReplaceDeduplicateWithAggregate":338361,"PreprocessTableInsertion":12309},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":2,"Analyzer$HandleNullInputsForUDF":2,"OptimizeUpdateFields":5,"Analyzer$ResolveSubqueryColumnAliases":3,"ResolveTimeZone":3,"Analyzer$ResolveNamespace":3,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":3,"RelationConversions":2,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":3,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":3,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":2,"Analyzer$ExtractGenerator":3,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":3,"ResolveHints$ResolveJoinStrategyHints":2,"TypeCoercion$MapZipWithCoercion":3,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":2,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":2,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":2,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":3,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":3,"package$ExpressionCanonicalizer$CleanExpressions":4,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":3,"CTESubstitution":2,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":3,"RewriteExceptAll":1,"UpdateAttributeNullability":4,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":2,"ReplaceExpressions":1,"ResolveInlineTables":3,"ResolveUnion":3,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":3,"ResolveSessionCatalog":3,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":3,"Analyzer$ResolveAliases":3,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":3,"TransposeWindow":3,"Analyzer$ResolveRelations":3,"EliminateUnions":2,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":3,"Analyzer$ResolveNaturalAndUsingJoin":3,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":3,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":3,"FallBackFileSourceV2":3,"Analyzer$ResolveTables":3,"SubstituteUnresolvedOrdinals":2,"TypeCoercion$CaseWhenCoercion":3,"DecimalPrecision":3,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":3,"Analyzer$ResolveAggAliasInGroupBy":3,"TypeCoercion$StringLiteralCoercion":3,"FoldablePropagation":3,"ResolveHiveSerdeTable":3,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":2,"Analyzer$PullOutNondeterministic":2,"Analyzer$ResolveFunctions":3,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":3,"Analyzer$ResolvePivot":3,"CollapseProject":4,"Analyzer$ResolveNewInstance":3,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":3,"TypeCoercion$ConcatCoercion":3,"PushDownPredicates":6,"TimeWindowing":3,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"TypeCoercion$Division":3,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":3,"TypeCoercion$EltCoercion":3,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":2,"ResolveSQLOnFile":3,"Analyzer$ResolveSubquery":3,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":3,"Analyzer$ResolveBinaryArithmetic":3,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":2,"ResolveEncodersInScalaAgg":3,"TypeCoercion$IntegralDivision":3,"Analyzer$ResolveWindowFrame":3,"Analyzer$ResolveDeserializer":3,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":3,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":3,"Analyzer$ResolveGenerate":3,"TypeCoercion$WidenSetOperationTypes":3,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":3,"ReplaceExceptWithFilter":1,"CleanupAliases":2,"SchemaPruning":1,"ResolveHints$DisableHints":2,"Analyzer$ResolveOutputRelation":3,"BloomFilterJoinRule":1,"HiveAnalysis":2,"Analyzer$ResolveRandomSeed":3,"TypeCoercion$WindowFrameCoercion":3,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":3,"ResolveNoopDropTable":2,"TypeCoercion$InConversion":3,"FindDataSourceTable":3,"ApplyCharTypePadding":2,"SimplifyConditionals":3,"DataSourceAnalysis":2,"TypeCoercion$FunctionArgumentConversion":3,"Analyzer$GlobalAggregates":3,"Analyzer$LookupFunctions":2,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":2},"numEffectiveRunsPerRule":{"EliminateSubqueryAliases":1,"EliminateLimits":1,"RemoveRedundantAliases":1,"SimplifyCasts":1,"InferFiltersFromConstraints":1,"CollapseProject":1,"PushDownPredicates":1,"Analyzer$ResolveDeserializer":1,"ConstantFolding":1},"timeEffectiveRunsPerRule":{"EliminateSubqueryAliases":1266648,"EliminateLimits":119411,"RemoveRedundantAliases":805532,"SimplifyCasts":861133,"InferFiltersFromConstraints":1816956,"CollapseProject":862081,"PushDownPredicates":466171,"Analyzer$ResolveDeserializer":438389,"ConstantFolding":2273118},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":5,"time":1691340444283}
{"Event":"SparkListenerBlockManagerRemoved","Block Manager ID":{"Executor ID":"5","Host":"ip-10-0-10-231.us-west-2.compute.internal","Port":40845},"Timestamp":1691340504689}
{"Event":"SparkListenerExecutorRemoved","Timestamp":1691340504695,"Executor ID":"5","Removed Reason":"Container container_1691339165261_0001_01_000011 exited from explicit termination request."}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":6,"description":"csv at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nGlobalLimit 1\n+- LocalLimit 1\n   +- Filter (length(trim(value#119, None)) > 0)\n      +- Project [value#113 AS value#119]\n         +- Project [value#113]\n            +- Relation[value#113] text\n\n== Analyzed Logical Plan ==\nvalue: string\nGlobalLimit 1\n+- LocalLimit 1\n   +- Filter (length(trim(value#119, None)) > 0)\n      +- Project [value#113 AS value#119]\n         +- Project [value#113]\n            +- Relation[value#113] text\n\n== Optimized Logical Plan ==\nGlobalLimit 1\n+- LocalLimit 1\n   +- Filter (length(trim(value#113, None)) > 0)\n      +- Relation[value#113] text\n\n== Physical Plan ==\nCollectLimit 1\n+- *(1) Filter (length(trim(value#113, None)) > 0)\n   +- FileScan text [value#113] Batched: false, DataFilters: [(length(trim(value#113, None)) > 0)], Format: Text, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<value:string>\n","sparkPlanInfo":{"nodeName":"CollectLimit","simpleString":"CollectLimit 1","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Filter","simpleString":"Filter (length(trim(value#113, None)) > 0)","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan text ","simpleString":"FileScan text [value#113] Batched: false, DataFilters: [(length(trim(value#113, None)) > 0)], Format: Text, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<value:string>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv]","ReadSchema":"struct<value:string>","Format":"Text","Batched":"false","PartitionFilters":"[]","PushedFilters":"[]","DataFilters":"[(length(trim(value#113, None)) > 0)]"},"metrics":[{"name":"number of output rows","accumulatorId":361,"metricType":"sum"},{"name":"number of files read","accumulatorId":362,"metricType":"sum"},{"name":"metadata time","accumulatorId":363,"metricType":"timing"},{"name":"size of files read","accumulatorId":364,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":360,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":359,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":357,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":358,"metricType":"nsTiming"},{"name":"records read","accumulatorId":355,"metricType":"sum"},{"name":"local bytes read","accumulatorId":353,"metricType":"size"},{"name":"fetch wait time","accumulatorId":354,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":351,"metricType":"size"},{"name":"local blocks read","accumulatorId":350,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":349,"metricType":"sum"},{"name":"remote bytes read to disk","accumulatorId":352,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":356,"metricType":"size"}]},"time":1691340889157}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":6,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":6,"accumUpdates":[[362,1],[363,0],[364,497937]]}
{"Event":"SparkListenerJobStart","Job ID":7,"Submission Time":1691340889225,"Stage Infos":[{"Stage ID":9,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":39,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"84\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[38],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":37,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"83\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[36],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":38,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"80\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[37],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":36,"Name":"FileScanRDD","Scope":"{\"id\":\"83\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[9],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movie-summary","spark.driver.memory":"2048M","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"6","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":9,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":39,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"84\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[38],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":37,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"83\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[36],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":38,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"80\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[37],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":36,"Name":"FileScanRDD","Scope":"{\"id\":\"83\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340889228,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movie-summary","spark.driver.memory":"2048M","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"6","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerExecutorAdded","Timestamp":1691340894400,"Executor ID":"6","Executor Info":{"Host":"ip-10-0-10-231.us-west-2.compute.internal","Total Cores":4,"Log Urls":{"stdout":"http://ip-10-0-10-231.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000014/hadoop/stdout?start=-4096","stderr":"http://ip-10-0-10-231.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000014/hadoop/stderr?start=-4096"},"Attributes":{"NM_HTTP_ADDRESS":"ip-10-0-10-231.us-west-2.compute.internal:8042","USER":"hadoop","LOG_FILES":"stderr,stdout","NM_HTTP_PORT":"8042","CLUSTER_ID":"","NM_PORT":"8041","HTTP_SCHEME":"http://","NM_HOST":"ip-10-0-10-231.us-west-2.compute.internal","CONTAINER_ID":"container_1691339165261_0001_01_000014"},"Resources":{},"Resource Profile Id":0}}
{"Event":"SparkListenerBlockManagerAdded","Block Manager ID":{"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Port":40521},"Maximum Memory":2199493017,"Timestamp":1691340894856,"Maximum Onheap Memory":2199493017,"Maximum Offheap Memory":0}
{"Event":"SparkListenerTaskStart","Stage ID":9,"Stage Attempt ID":0,"Task Info":{"Task ID":8,"Index":0,"Attempt":0,"Launch Time":1691340895057,"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":9,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":8,"Index":0,"Attempt":0,"Launch Time":1691340895057,"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340900949,"Failed":false,"Killed":false,"Accumulables":[{"ID":360,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":361,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":365,"Name":"internal.metrics.executorDeserializeTime","Update":2339,"Value":2339,"Internal":true,"Count Failed Values":true},{"ID":366,"Name":"internal.metrics.executorDeserializeCpuTime","Update":1092938201,"Value":1092938201,"Internal":true,"Count Failed Values":true},{"ID":367,"Name":"internal.metrics.executorRunTime","Update":3473,"Value":3473,"Internal":true,"Count Failed Values":true},{"ID":368,"Name":"internal.metrics.executorCpuTime","Update":2156734283,"Value":2156734283,"Internal":true,"Count Failed Values":true},{"ID":369,"Name":"internal.metrics.resultSize","Update":1696,"Value":1696,"Internal":true,"Count Failed Values":true},{"ID":370,"Name":"internal.metrics.jvmGCTime","Update":322,"Value":322,"Internal":true,"Count Failed Values":true},{"ID":371,"Name":"internal.metrics.resultSerializationTime","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":386,"Name":"internal.metrics.input.bytesRead","Update":15700,"Value":15700,"Internal":true,"Count Failed Values":true},{"ID":387,"Name":"internal.metrics.input.recordsRead","Update":1,"Value":1,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":2339,"Executor Deserialize CPU Time":1092938201,"Executor Run Time":3473,"Executor CPU Time":2156734283,"Peak Execution Memory":0,"Result Size":1696,"JVM GC Time":322,"Result Serialization Time":1,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":15700,"Records Read":1},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":9,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":39,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"84\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[38],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":37,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"83\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[36],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":38,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"80\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[37],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":36,"Name":"FileScanRDD","Scope":"{\"id\":\"83\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340889228,"Completion Time":1691340900951,"Accumulables":[{"ID":360,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":361,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":365,"Name":"internal.metrics.executorDeserializeTime","Value":2339,"Internal":true,"Count Failed Values":true},{"ID":366,"Name":"internal.metrics.executorDeserializeCpuTime","Value":1092938201,"Internal":true,"Count Failed Values":true},{"ID":367,"Name":"internal.metrics.executorRunTime","Value":3473,"Internal":true,"Count Failed Values":true},{"ID":368,"Name":"internal.metrics.executorCpuTime","Value":2156734283,"Internal":true,"Count Failed Values":true},{"ID":369,"Name":"internal.metrics.resultSize","Value":1696,"Internal":true,"Count Failed Values":true},{"ID":370,"Name":"internal.metrics.jvmGCTime","Value":322,"Internal":true,"Count Failed Values":true},{"ID":371,"Name":"internal.metrics.resultSerializationTime","Value":1,"Internal":true,"Count Failed Values":true},{"ID":386,"Name":"internal.metrics.input.bytesRead","Value":15700,"Internal":true,"Count Failed Values":true},{"ID":387,"Name":"internal.metrics.input.recordsRead","Value":1,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":7,"Completion Time":1691340900952,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":6,"timePerRule":{"PruneFileSourcePartitions":64265,"ReassignLambdaVariableID":35516,"PushPredicateThroughNonJoin":17540,"Analyzer$ResolveEncodersInUDF":11116,"Analyzer$HandleNullInputsForUDF":16598,"OptimizeUpdateFields":94636,"Analyzer$ResolveSubqueryColumnAliases":6071,"ResolveTimeZone":8453,"Analyzer$ResolveNamespace":6407,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":8346,"RelationConversions":5810,"RewriteCorrelatedScalarSubquery":275715,"RemoveLiteralFromGroupExpressions":17624,"PushProjectionThroughUnion":40411,"EliminateSubqueryAliases":25326,"ResolveCatalogs":256877,"PushLeftSemiLeftAntiThroughJoin":33996,"Analyzer$ResolveUserSpecifiedColumns":6947,"FlattenScalarSubqueriesWithAggregates":20835,"LikeSimplification":107496,"CollapseRepartition":41539,"ResolveHints$ResolveCoalesceHints":7582,"Analyzer$ExtractGenerator":19429,"RewriteIntersectAll":18681,"Analyzer$AddMetadataColumns":47897,"ResolveHints$ResolveJoinStrategyHints":8564,"TypeCoercion$MapZipWithCoercion":7941,"NullPropagation":391502,"EliminateAggregateFilter":13357,"PullupCorrelatedPredicates":52749,"UpdateOuterReferences":9638,"ExtractPythonUDFs":153070,"Analyzer$WindowsSubstitution":7639,"CombineUnions":52246,"ExtractGroupingPythonUDFFromAggregate":11447,"ReorderAssociativeOperator":150644,"CleanupDynamicPruningFilters":86382,"ResolveHints$RemoveAllHints":6060,"SimplifyBinaryComparison":2870199,"ResolveTableValuedFunctions":6769,"EliminateSerialization":43002,"OptimizeJsonExprs":180498,"GetCurrentDatabaseAndCatalog":140154,"TypeCoercion$BooleanEquality":10550,"package$ExpressionCanonicalizer$CleanExpressions":60475,"EliminateLimits":62179,"ReplaceIntersectWithSemiJoin":17105,"ConstantPropagation":1089569,"PushExtraPredicateThroughJoin":11846,"CostBasedJoinReorder":14584,"Analyzer$ResolveReferences":37276,"CTESubstitution":257888,"RemoveRedundantAliases":522198,"TypeCoercion$ImplicitTypeCasts":9330,"RewriteExceptAll":21085,"UpdateAttributeNullability":401185,"PropagateEmptyRelation":64567,"InferFiltersFromGenerate":15676,"SimplifyCasts":106266,"EliminateMapObjects":47962,"DetectAmbiguousSelfJoin":34647,"ReplaceExpressions":56004,"ResolveInlineTables":7637,"ResolveUnion":10258,"OptimizeIn":98837,"CollapseWindow":41364,"TypeCoercion$IfCoercion":9418,"ResolveSessionCatalog":13512,"PartitionPruning":31827,"BooleanSimplification":160780,"TypeCoercion$PromoteStrings":18578,"Analyzer$ResolveAliases":7153,"DecimalAggregates":1969657,"PruneFilters":1789759,"PruneHiveTablePartitions":37254,"Analyzer$ResolveMissingReferences":5797,"TransposeWindow":37865,"Analyzer$ResolveRelations":13641,"EliminateUnions":8404,"RewritePredicateSubquery":74563,"ObjectSerializerPruning":10053,"LimitPushDown":35527,"SimplifyCaseConversionExpressions":107866,"ResolvePartitionSpec":6524,"Analyzer$ResolveNaturalAndUsingJoin":5980,"UnwrapCastInBinaryComparison":134825,"EliminateView":24322,"CombineTypedFilters":10675,"ReplaceUpdateFieldsExpression":31606,"OptimizeLimitZero":29377,"CheckCartesianProducts":27661,"ExtractPythonUDFFromAggregate":12406,"Analyzer$ExtractWindowExpressions":8597,"ReplaceExceptWithAntiJoin":18346,"ResolveLambdaVariables":10241,"FallBackFileSourceV2":5184,"Analyzer$ResolveTables":10160,"SubstituteUnresolvedOrdinals":5811,"TypeCoercion$CaseWhenCoercion":7787,"DecimalPrecision":24365,"EliminateSorts":16818,"PushDownLeftSemiAntiJoin":49942,"ExtractPythonUDFFromJoinCondition":13624,"TypeCoercion$StackCoercion":7599,"Analyzer$ResolveAggAliasInGroupBy":5797,"TypeCoercion$StringLiteralCoercion":9227,"FoldablePropagation":865505,"ResolveHiveSerdeTable":6167,"V2ScanRelationPushDown":94787,"EliminateDistinct":9859,"InferFiltersFromConstraints":484573,"DetermineTableStats":8708,"Analyzer$PullOutNondeterministic":86962,"Analyzer$ResolveFunctions":11717,"ReplaceNullWithFalseInPredicate":210652,"ResolveHigherOrderFunctions":9457,"Analyzer$ResolvePivot":6095,"CollapseProject":239334,"Analyzer$ResolveNewInstance":7386,"ColumnPruning":609365,"Analyzer$ResolveWindowOrder":9520,"TypeCoercion$ConcatCoercion":13047,"PushDownPredicates":4948352,"TimeWindowing":38054,"Optimizer$OptimizeSubqueries":114316,"RewriteNonCorrelatedExists":43665,"TypeCoercion$Division":8721,"ComputeCurrentTime":120814,"ResolveCreateNamedStruct":13163,"TypeCoercion$EltCoercion":11245,"ConvertToLocalRelation":50368,"OptimizeWindowFunctions":93842,"RemoveRepetitionFromGroupExpressions":16734,"ReplaceDistinctWithAggregate":17308,"PreprocessTableCreation":6471,"ResolveSQLOnFile":5291,"Analyzer$ResolveSubquery":14136,"CombineConcats":11499,"Analyzer$ResolveGroupingAnalytics":9244,"Analyzer$ResolveBinaryArithmetic":15272,"RemoveDispensableExpressions":96826,"Analyzer$ResolveAlterTableChanges":7216,"ResolveEncodersInScalaAgg":64810,"TypeCoercion$IntegralDivision":8434,"Analyzer$ResolveWindowFrame":7713,"Analyzer$ResolveDeserializer":9002,"RewriteDistinctAggregates":18578,"RemoveNoopOperators":160860,"Analyzer$ResolveAggregateFunctions":6240,"NormalizeFloatingNumbers":11004,"ReorderJoin":43026,"Analyzer$ResolveUpCast":6871,"Analyzer$ResolveGenerate":6800,"TypeCoercion$WidenSetOperationTypes":62718,"EliminateOuterJoin":35898,"SimplifyExtractValueOps":93701,"OptimizeMetadataOnlyQuery":10728,"EliminateResolvedHint":66142,"Analyzer$ResolveInsertInto":5554,"ReplaceExceptWithFilter":36484,"CleanupAliases":12165,"SchemaPruning":104859,"ResolveHints$DisableHints":12191,"Analyzer$ResolveOutputRelation":6459,"BloomFilterJoinRule":21078,"HiveAnalysis":6009,"Analyzer$ResolveRandomSeed":6736,"TypeCoercion$WindowFrameCoercion":7887,"ConstantFolding":187460,"TypeCoercion$DateTimeOperations":9081,"ResolveNoopDropTable":7090,"TypeCoercion$InConversion":12306,"FindDataSourceTable":6353,"ApplyCharTypePadding":15262,"SimplifyConditionals":133268,"DataSourceAnalysis":6936,"TypeCoercion$FunctionArgumentConversion":10761,"Analyzer$GlobalAggregates":5486,"Analyzer$LookupFunctions":15704,"CombineFilters":41770,"ReplaceDeduplicateWithAggregate":143504,"PreprocessTableInsertion":5642},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":1,"Analyzer$HandleNullInputsForUDF":1,"OptimizeUpdateFields":4,"Analyzer$ResolveSubqueryColumnAliases":1,"ResolveTimeZone":1,"Analyzer$ResolveNamespace":1,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":1,"RelationConversions":1,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":1,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":1,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":1,"Analyzer$ExtractGenerator":1,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":1,"ResolveHints$ResolveJoinStrategyHints":1,"TypeCoercion$MapZipWithCoercion":1,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":1,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":1,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":1,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":1,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":1,"package$ExpressionCanonicalizer$CleanExpressions":2,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":1,"CTESubstitution":1,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":1,"RewriteExceptAll":1,"UpdateAttributeNullability":3,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":1,"ReplaceExpressions":1,"ResolveInlineTables":1,"ResolveUnion":1,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":1,"ResolveSessionCatalog":1,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":1,"Analyzer$ResolveAliases":1,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":1,"TransposeWindow":3,"Analyzer$ResolveRelations":1,"EliminateUnions":1,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":1,"Analyzer$ResolveNaturalAndUsingJoin":1,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":1,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":1,"FallBackFileSourceV2":1,"Analyzer$ResolveTables":1,"SubstituteUnresolvedOrdinals":1,"TypeCoercion$CaseWhenCoercion":1,"DecimalPrecision":1,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":1,"Analyzer$ResolveAggAliasInGroupBy":1,"TypeCoercion$StringLiteralCoercion":1,"FoldablePropagation":3,"ResolveHiveSerdeTable":1,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":1,"Analyzer$PullOutNondeterministic":1,"Analyzer$ResolveFunctions":1,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":1,"Analyzer$ResolvePivot":1,"CollapseProject":4,"Analyzer$ResolveNewInstance":1,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":1,"TypeCoercion$ConcatCoercion":1,"PushDownPredicates":6,"TimeWindowing":1,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"TypeCoercion$Division":1,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":1,"TypeCoercion$EltCoercion":1,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":1,"ResolveSQLOnFile":1,"Analyzer$ResolveSubquery":1,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":1,"Analyzer$ResolveBinaryArithmetic":1,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":1,"ResolveEncodersInScalaAgg":1,"TypeCoercion$IntegralDivision":1,"Analyzer$ResolveWindowFrame":1,"Analyzer$ResolveDeserializer":1,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":1,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":1,"Analyzer$ResolveGenerate":1,"TypeCoercion$WidenSetOperationTypes":1,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":1,"ReplaceExceptWithFilter":1,"CleanupAliases":1,"SchemaPruning":1,"ResolveHints$DisableHints":1,"Analyzer$ResolveOutputRelation":1,"BloomFilterJoinRule":1,"HiveAnalysis":1,"Analyzer$ResolveRandomSeed":1,"TypeCoercion$WindowFrameCoercion":1,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":1,"ResolveNoopDropTable":1,"TypeCoercion$InConversion":1,"FindDataSourceTable":1,"ApplyCharTypePadding":1,"SimplifyConditionals":3,"DataSourceAnalysis":1,"TypeCoercion$FunctionArgumentConversion":1,"Analyzer$GlobalAggregates":1,"Analyzer$LookupFunctions":1,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":1},"numEffectiveRunsPerRule":{"RemoveNoopOperators":1,"PushDownPredicates":1,"CollapseProject":1,"RemoveRedundantAliases":1},"timeEffectiveRunsPerRule":{"RemoveNoopOperators":126353,"PushDownPredicates":4854153,"CollapseProject":208059,"RemoveRedundantAliases":273504},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":6,"time":1691340900956}
{"Event":"SparkListenerJobStart","Job ID":8,"Submission Time":1691340901048,"Stage Infos":[{"Stage ID":10,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":45,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"92\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[44],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":42,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"89\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[41],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":41,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"90\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[40],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":40,"Name":"FileScanRDD","Scope":"{\"id\":\"90\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":43,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[42],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":44,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"91\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[43],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[10],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movie-summary","spark.rdd.scope":"{\"id\":\"93\",\"name\":\"aggregate\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":10,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":45,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"92\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[44],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":42,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"89\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[41],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":41,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"90\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[40],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":40,"Name":"FileScanRDD","Scope":"{\"id\":\"90\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":43,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[42],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":44,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"91\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[43],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340901051,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movie-summary","spark.rdd.scope":"{\"id\":\"93\",\"name\":\"aggregate\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":10,"Stage Attempt ID":0,"Task Info":{"Task ID":9,"Index":0,"Attempt":0,"Launch Time":1691340901067,"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":10,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":9,"Index":0,"Attempt":0,"Launch Time":1691340901067,"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340904155,"Failed":false,"Killed":false,"Accumulables":[{"ID":390,"Name":"number of output rows","Update":"4610","Value":"4610","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":394,"Name":"internal.metrics.executorDeserializeTime","Update":125,"Value":125,"Internal":true,"Count Failed Values":true},{"ID":395,"Name":"internal.metrics.executorDeserializeCpuTime","Update":103704546,"Value":103704546,"Internal":true,"Count Failed Values":true},{"ID":396,"Name":"internal.metrics.executorRunTime","Update":2947,"Value":2947,"Internal":true,"Count Failed Values":true},{"ID":397,"Name":"internal.metrics.executorCpuTime","Update":2279781836,"Value":2279781836,"Internal":true,"Count Failed Values":true},{"ID":398,"Name":"internal.metrics.resultSize","Update":1707,"Value":1707,"Internal":true,"Count Failed Values":true},{"ID":400,"Name":"internal.metrics.resultSerializationTime","Update":3,"Value":3,"Internal":true,"Count Failed Values":true},{"ID":415,"Name":"internal.metrics.input.bytesRead","Update":497937,"Value":497937,"Internal":true,"Count Failed Values":true},{"ID":416,"Name":"internal.metrics.input.recordsRead","Update":4610,"Value":4610,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":125,"Executor Deserialize CPU Time":103704546,"Executor Run Time":2947,"Executor CPU Time":2279781836,"Peak Execution Memory":0,"Result Size":1707,"JVM GC Time":0,"Result Serialization Time":3,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":497937,"Records Read":4610},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":10,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":45,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"92\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[44],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":42,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"89\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[41],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":41,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"90\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[40],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":40,"Name":"FileScanRDD","Scope":"{\"id\":\"90\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":43,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[42],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":44,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"91\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[43],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340901051,"Completion Time":1691340904156,"Accumulables":[{"ID":390,"Name":"number of output rows","Value":"4610","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":394,"Name":"internal.metrics.executorDeserializeTime","Value":125,"Internal":true,"Count Failed Values":true},{"ID":395,"Name":"internal.metrics.executorDeserializeCpuTime","Value":103704546,"Internal":true,"Count Failed Values":true},{"ID":396,"Name":"internal.metrics.executorRunTime","Value":2947,"Internal":true,"Count Failed Values":true},{"ID":397,"Name":"internal.metrics.executorCpuTime","Value":2279781836,"Internal":true,"Count Failed Values":true},{"ID":398,"Name":"internal.metrics.resultSize","Value":1707,"Internal":true,"Count Failed Values":true},{"ID":400,"Name":"internal.metrics.resultSerializationTime","Value":3,"Internal":true,"Count Failed Values":true},{"ID":415,"Name":"internal.metrics.input.bytesRead","Value":497937,"Internal":true,"Count Failed Values":true},{"ID":416,"Name":"internal.metrics.input.recordsRead","Value":4610,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":8,"Completion Time":1691340904156,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":7,"description":"count at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nAggregate [count(1) AS count#170L]\n+- Sort [year#129 ASC NULLS FIRST], true\n   +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n      +- Project [year#129, title#130, directors_0#131, rating#132, actors_0#137, actors_1#138, actors_2#139]\n         +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Analyzed Logical Plan ==\ncount: bigint\nAggregate [count(1) AS count#170L]\n+- Sort [year#129 ASC NULLS FIRST], true\n   +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n      +- Project [year#129, title#130, directors_0#131, rating#132, actors_0#137, actors_1#138, actors_2#139]\n         +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Optimized Logical Plan ==\nAggregate [count(1) AS count#170L]\n+- Project\n   +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n      +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=false\n+- HashAggregate(keys=[], functions=[count(1)], output=[count#170L])\n   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#131]\n      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#173L])\n         +- Project\n            +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n               +- FileScan csv [actors_0#137,actors_1#138,actors_2#139] Batched: false, DataFilters: [(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[count(1)])","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#131]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_count(1)])","children":[{"nodeName":"Project","simpleString":"Project","children":[{"nodeName":"Filter","simpleString":"Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [actors_0#137,actors_1#138,actors_2#139] Batched: false, DataFilters: [(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv]","ReadSchema":"struct<actors_0:string,actors_1:string,actors_2:string>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Foster))]","DataFilters":"[(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))]"},"metrics":[{"name":"number of output rows","accumulatorId":452,"metricType":"sum"},{"name":"number of files read","accumulatorId":453,"metricType":"sum"},{"name":"metadata time","accumulatorId":454,"metricType":"timing"},{"name":"size of files read","accumulatorId":455,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":451,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":448,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":449,"metricType":"timing"},{"name":"peak memory","accumulatorId":447,"metricType":"size"},{"name":"number of output rows","accumulatorId":446,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":450,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":428,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":429,"metricType":"nsTiming"},{"name":"records read","accumulatorId":426,"metricType":"sum"},{"name":"local bytes read","accumulatorId":424,"metricType":"size"},{"name":"fetch wait time","accumulatorId":425,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":422,"metricType":"size"},{"name":"local blocks read","accumulatorId":421,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":420,"metricType":"sum"},{"name":"data size","accumulatorId":419,"metricType":"size"},{"name":"remote bytes read to disk","accumulatorId":423,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":427,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":443,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":444,"metricType":"timing"},{"name":"peak memory","accumulatorId":442,"metricType":"size"},{"name":"number of output rows","accumulatorId":441,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":445,"metricType":"average"}]}],"metadata":{},"metrics":[]},"time":1691340935189}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":7,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":7,"physicalPlanDescription":"== Parsed Logical Plan ==\nAggregate [count(1) AS count#170L]\n+- Sort [year#129 ASC NULLS FIRST], true\n   +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n      +- Project [year#129, title#130, directors_0#131, rating#132, actors_0#137, actors_1#138, actors_2#139]\n         +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Analyzed Logical Plan ==\ncount: bigint\nAggregate [count(1) AS count#170L]\n+- Sort [year#129 ASC NULLS FIRST], true\n   +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n      +- Project [year#129, title#130, directors_0#131, rating#132, actors_0#137, actors_1#138, actors_2#139]\n         +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Optimized Logical Plan ==\nAggregate [count(1) AS count#170L]\n+- Project\n   +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n      +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=false\n+- == Current Plan ==\n   HashAggregate(keys=[], functions=[count(1)], output=[count#170L])\n   +- ShuffleQueryStage 0\n      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#146]\n         +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#173L])\n            +- *(1) Project\n               +- *(1) Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n                  +- FileScan csv [actors_0#137,actors_1#138,actors_2#139] Batched: false, DataFilters: [(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>\n+- == Initial Plan ==\n   HashAggregate(keys=[], functions=[count(1)], output=[count#170L])\n   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#131]\n      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#173L])\n         +- Project\n            +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n               +- FileScan csv [actors_0#137,actors_1#138,actors_2#139] Batched: false, DataFilters: [(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[count(1)])","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#146]","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_count(1)])","children":[{"nodeName":"Project","simpleString":"Project","children":[{"nodeName":"Filter","simpleString":"Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [actors_0#137,actors_1#138,actors_2#139] Batched: false, DataFilters: [(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv]","ReadSchema":"struct<actors_0:string,actors_1:string,actors_2:string>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Foster))]","DataFilters":"[(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))]"},"metrics":[{"name":"number of output rows","accumulatorId":452,"metricType":"sum"},{"name":"number of files read","accumulatorId":453,"metricType":"sum"},{"name":"metadata time","accumulatorId":454,"metricType":"timing"},{"name":"size of files read","accumulatorId":455,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":478,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":475,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":476,"metricType":"timing"},{"name":"peak memory","accumulatorId":474,"metricType":"size"},{"name":"number of output rows","accumulatorId":473,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":477,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":472,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":465,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":466,"metricType":"nsTiming"},{"name":"records read","accumulatorId":463,"metricType":"sum"},{"name":"local bytes read","accumulatorId":461,"metricType":"size"},{"name":"fetch wait time","accumulatorId":462,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":459,"metricType":"size"},{"name":"local blocks read","accumulatorId":458,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":457,"metricType":"sum"},{"name":"data size","accumulatorId":456,"metricType":"size"},{"name":"remote bytes read to disk","accumulatorId":460,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":464,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":469,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":470,"metricType":"timing"},{"name":"peak memory","accumulatorId":468,"metricType":"size"},{"name":"number of output rows","accumulatorId":467,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":471,"metricType":"average"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":7,"accumUpdates":[[453,1],[454,0],[455,497937]]}
{"Event":"SparkListenerJobStart","Job ID":9,"Submission Time":1691340935296,"Stage Infos":[{"Stage ID":11,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":49,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"100\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[48],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":46,"Name":"FileScanRDD","Scope":"{\"id\":\"106\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":47,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"106\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[46],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":48,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"101\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[47],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[11],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movie-summary","spark.rdd.scope":"{\"id\":\"100\",\"name\":\"ShuffleQueryStage\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"7","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":11,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":49,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"100\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[48],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":46,"Name":"FileScanRDD","Scope":"{\"id\":\"106\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":47,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"106\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[46],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":48,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"101\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[47],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340935298,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movie-summary","spark.rdd.scope":"{\"id\":\"100\",\"name\":\"ShuffleQueryStage\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"7","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":11,"Stage Attempt ID":0,"Task Info":{"Task ID":10,"Index":0,"Attempt":0,"Launch Time":1691340935311,"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":11,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":10,"Index":0,"Attempt":0,"Launch Time":1691340935311,"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340936044,"Failed":false,"Killed":false,"Accumulables":[{"ID":452,"Name":"number of output rows","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":456,"Name":"data size","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":464,"Name":"shuffle bytes written","Update":"59","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":465,"Name":"shuffle records written","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":466,"Name":"shuffle write time","Update":"17725023","Value":"17725023","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"duration","Update":"560","Value":"560","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":476,"Name":"time in aggregation build","Update":"526","Value":"526","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":478,"Name":"number of output rows","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":479,"Name":"internal.metrics.executorDeserializeTime","Update":76,"Value":76,"Internal":true,"Count Failed Values":true},{"ID":480,"Name":"internal.metrics.executorDeserializeCpuTime","Update":67974889,"Value":67974889,"Internal":true,"Count Failed Values":true},{"ID":481,"Name":"internal.metrics.executorRunTime","Update":636,"Value":636,"Internal":true,"Count Failed Values":true},{"ID":482,"Name":"internal.metrics.executorCpuTime","Update":463317853,"Value":463317853,"Internal":true,"Count Failed Values":true},{"ID":483,"Name":"internal.metrics.resultSize","Update":2053,"Value":2053,"Internal":true,"Count Failed Values":true},{"ID":485,"Name":"internal.metrics.resultSerializationTime","Update":8,"Value":8,"Internal":true,"Count Failed Values":true},{"ID":497,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":59,"Value":59,"Internal":true,"Count Failed Values":true},{"ID":498,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":499,"Name":"internal.metrics.shuffle.write.writeTime","Update":17725023,"Value":17725023,"Internal":true,"Count Failed Values":true},{"ID":500,"Name":"internal.metrics.input.bytesRead","Update":497937,"Value":497937,"Internal":true,"Count Failed Values":true},{"ID":501,"Name":"internal.metrics.input.recordsRead","Update":16,"Value":16,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":76,"Executor Deserialize CPU Time":67974889,"Executor Run Time":636,"Executor CPU Time":463317853,"Peak Execution Memory":0,"Result Size":2053,"JVM GC Time":0,"Result Serialization Time":8,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":59,"Shuffle Write Time":17725023,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":497937,"Records Read":16},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":11,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":49,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"100\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[48],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":46,"Name":"FileScanRDD","Scope":"{\"id\":\"106\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":47,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"106\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[46],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":48,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"101\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[47],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340935298,"Completion Time":1691340936047,"Accumulables":[{"ID":452,"Name":"number of output rows","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":456,"Name":"data size","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":464,"Name":"shuffle bytes written","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":465,"Name":"shuffle records written","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":466,"Name":"shuffle write time","Value":"17725023","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":472,"Name":"duration","Value":"560","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":473,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":476,"Name":"time in aggregation build","Value":"526","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":478,"Name":"number of output rows","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":479,"Name":"internal.metrics.executorDeserializeTime","Value":76,"Internal":true,"Count Failed Values":true},{"ID":480,"Name":"internal.metrics.executorDeserializeCpuTime","Value":67974889,"Internal":true,"Count Failed Values":true},{"ID":481,"Name":"internal.metrics.executorRunTime","Value":636,"Internal":true,"Count Failed Values":true},{"ID":482,"Name":"internal.metrics.executorCpuTime","Value":463317853,"Internal":true,"Count Failed Values":true},{"ID":483,"Name":"internal.metrics.resultSize","Value":2053,"Internal":true,"Count Failed Values":true},{"ID":485,"Name":"internal.metrics.resultSerializationTime","Value":8,"Internal":true,"Count Failed Values":true},{"ID":497,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":59,"Internal":true,"Count Failed Values":true},{"ID":498,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":1,"Internal":true,"Count Failed Values":true},{"ID":499,"Name":"internal.metrics.shuffle.write.writeTime","Value":17725023,"Internal":true,"Count Failed Values":true},{"ID":500,"Name":"internal.metrics.input.bytesRead","Value":497937,"Internal":true,"Count Failed Values":true},{"ID":501,"Name":"internal.metrics.input.recordsRead","Value":16,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":9,"Completion Time":1691340936048,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":7,"physicalPlanDescription":"== Parsed Logical Plan ==\nAggregate [count(1) AS count#170L]\n+- Sort [year#129 ASC NULLS FIRST], true\n   +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n      +- Project [year#129, title#130, directors_0#131, rating#132, actors_0#137, actors_1#138, actors_2#139]\n         +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Analyzed Logical Plan ==\ncount: bigint\nAggregate [count(1) AS count#170L]\n+- Sort [year#129 ASC NULLS FIRST], true\n   +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n      +- Project [year#129, title#130, directors_0#131, rating#132, actors_0#137, actors_1#138, actors_2#139]\n         +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Optimized Logical Plan ==\nAggregate [count(1) AS count#170L]\n+- Project\n   +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n      +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=true\n+- == Final Plan ==\n   *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#170L])\n   +- ShuffleQueryStage 0\n      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#146]\n         +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#173L])\n            +- *(1) Project\n               +- *(1) Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n                  +- FileScan csv [actors_0#137,actors_1#138,actors_2#139] Batched: false, DataFilters: [(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>\n+- == Initial Plan ==\n   HashAggregate(keys=[], functions=[count(1)], output=[count#170L])\n   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#131]\n      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#173L])\n         +- Project\n            +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n               +- FileScan csv [actors_0#137,actors_1#138,actors_2#139] Batched: false, DataFilters: [(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=true","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[count(1)])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#146]","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_count(1)])","children":[{"nodeName":"Project","simpleString":"Project","children":[{"nodeName":"Filter","simpleString":"Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [actors_0#137,actors_1#138,actors_2#139] Batched: false, DataFilters: [(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv]","ReadSchema":"struct<actors_0:string,actors_1:string,actors_2:string>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Foster))]","DataFilters":"[(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))]"},"metrics":[{"name":"number of output rows","accumulatorId":452,"metricType":"sum"},{"name":"number of files read","accumulatorId":453,"metricType":"sum"},{"name":"metadata time","accumulatorId":454,"metricType":"timing"},{"name":"size of files read","accumulatorId":455,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":478,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":475,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":476,"metricType":"timing"},{"name":"peak memory","accumulatorId":474,"metricType":"size"},{"name":"number of output rows","accumulatorId":473,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":477,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":472,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":465,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":466,"metricType":"nsTiming"},{"name":"records read","accumulatorId":463,"metricType":"sum"},{"name":"local bytes read","accumulatorId":461,"metricType":"size"},{"name":"fetch wait time","accumulatorId":462,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":459,"metricType":"size"},{"name":"local blocks read","accumulatorId":458,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":457,"metricType":"sum"},{"name":"data size","accumulatorId":456,"metricType":"size"},{"name":"remote bytes read to disk","accumulatorId":460,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":464,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":507,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":508,"metricType":"timing"},{"name":"peak memory","accumulatorId":506,"metricType":"size"},{"name":"number of output rows","accumulatorId":505,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":509,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":504,"metricType":"timing"}]}],"metadata":{},"metrics":[]}}
{"Event":"SparkListenerJobStart","Job ID":10,"Submission Time":1691340936082,"Stage Infos":[{"Stage ID":12,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":49,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"100\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[48],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":46,"Name":"FileScanRDD","Scope":"{\"id\":\"106\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":47,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"106\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[46],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":48,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"101\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[47],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0},{"Stage ID":13,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":52,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"113\",\"name\":\"mapPartitionsInternal\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[51],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":51,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"108\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[50],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":50,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"112\",\"name\":\"Exchange\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[49],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[12],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[12,13],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movie-summary","spark.rdd.scope":"{\"id\":\"114\",\"name\":\"collect\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"7","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":13,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":52,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"113\",\"name\":\"mapPartitionsInternal\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[51],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":51,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"108\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[50],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":50,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"112\",\"name\":\"Exchange\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[49],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[12],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340936088,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movie-summary","spark.rdd.scope":"{\"id\":\"114\",\"name\":\"collect\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"7","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":13,"Stage Attempt ID":0,"Task Info":{"Task ID":11,"Index":0,"Attempt":0,"Launch Time":1691340936153,"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":13,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":11,"Index":0,"Attempt":0,"Launch Time":1691340936153,"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340936430,"Failed":false,"Killed":false,"Accumulables":[{"ID":458,"Name":"local blocks read","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":461,"Name":"local bytes read","Update":"59","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":462,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":463,"Name":"records read","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":504,"Name":"duration","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":505,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":508,"Name":"time in aggregation build","Update":"15","Value":"15","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":510,"Name":"internal.metrics.executorDeserializeTime","Update":47,"Value":47,"Internal":true,"Count Failed Values":true},{"ID":511,"Name":"internal.metrics.executorDeserializeCpuTime","Update":20252745,"Value":20252745,"Internal":true,"Count Failed Values":true},{"ID":512,"Name":"internal.metrics.executorRunTime","Update":216,"Value":216,"Internal":true,"Count Failed Values":true},{"ID":513,"Name":"internal.metrics.executorCpuTime","Update":121787421,"Value":121787421,"Internal":true,"Count Failed Values":true},{"ID":514,"Name":"internal.metrics.resultSize","Update":2644,"Value":2644,"Internal":true,"Count Failed Values":true},{"ID":521,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":522,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":523,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":524,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":525,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":59,"Value":59,"Internal":true,"Count Failed Values":true},{"ID":526,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":527,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1,"Value":1,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":97763448,"JVMOffHeapMemory":110557464,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":1194418,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":1194418,"OffHeapUnifiedMemory":0,"DirectPoolMemory":12207,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":13,"MinorGCTime":218,"MajorGCCount":3,"MajorGCTime":328},"Task Metrics":{"Executor Deserialize Time":47,"Executor Deserialize CPU Time":20252745,"Executor Run Time":216,"Executor CPU Time":121787421,"Peak Execution Memory":0,"Result Size":2644,"JVM GC Time":0,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":1,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":59,"Total Records Read":1},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":13,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":52,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"113\",\"name\":\"mapPartitionsInternal\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[51],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":51,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"108\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[50],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":50,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"112\",\"name\":\"Exchange\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[49],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[12],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340936088,"Completion Time":1691340936431,"Accumulables":[{"ID":458,"Name":"local blocks read","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":461,"Name":"local bytes read","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":462,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":463,"Name":"records read","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":504,"Name":"duration","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":505,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":508,"Name":"time in aggregation build","Value":"15","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":510,"Name":"internal.metrics.executorDeserializeTime","Value":47,"Internal":true,"Count Failed Values":true},{"ID":511,"Name":"internal.metrics.executorDeserializeCpuTime","Value":20252745,"Internal":true,"Count Failed Values":true},{"ID":512,"Name":"internal.metrics.executorRunTime","Value":216,"Internal":true,"Count Failed Values":true},{"ID":513,"Name":"internal.metrics.executorCpuTime","Value":121787421,"Internal":true,"Count Failed Values":true},{"ID":514,"Name":"internal.metrics.resultSize","Value":2644,"Internal":true,"Count Failed Values":true},{"ID":521,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":522,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":1,"Internal":true,"Count Failed Values":true},{"ID":523,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":524,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":525,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":59,"Internal":true,"Count Failed Values":true},{"ID":526,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":527,"Name":"internal.metrics.shuffle.read.recordsRead","Value":1,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":10,"Completion Time":1691340936432,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":7,"timePerRule":{"PruneFileSourcePartitions":203622,"ReassignLambdaVariableID":55145,"PushPredicateThroughNonJoin":25088,"Analyzer$ResolveEncodersInUDF":16617,"Analyzer$HandleNullInputsForUDF":26107,"OptimizeUpdateFields":179357,"Analyzer$ResolveSubqueryColumnAliases":13176,"ResolveTimeZone":18279,"Analyzer$ResolveNamespace":8448,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":12569,"RelationConversions":7796,"RewriteCorrelatedScalarSubquery":477185,"RemoveLiteralFromGroupExpressions":17645,"PushProjectionThroughUnion":75554,"EliminateSubqueryAliases":23486,"ResolveCatalogs":9861,"PushLeftSemiLeftAntiThroughJoin":55017,"Analyzer$ResolveUserSpecifiedColumns":6346,"EliminateJoinToEmptyRelation":5828,"FlattenScalarSubqueriesWithAggregates":47889,"LikeSimplification":631722,"CollapseRepartition":128638,"ResolveHints$ResolveCoalesceHints":11839,"Analyzer$ExtractGenerator":83403,"RewriteIntersectAll":18007,"Analyzer$AddMetadataColumns":103624,"ResolveHints$ResolveJoinStrategyHints":10355,"TypeCoercion$MapZipWithCoercion":14540,"NullPropagation":706862,"EliminateAggregateFilter":42322,"PullupCorrelatedPredicates":84848,"UpdateOuterReferences":12192,"ExtractPythonUDFs":202610,"Analyzer$WindowsSubstitution":8322,"CombineUnions":70662,"ExtractGroupingPythonUDFFromAggregate":16486,"ReorderAssociativeOperator":289145,"CleanupDynamicPruningFilters":168133,"ResolveHints$RemoveAllHints":7289,"SimplifyBinaryComparison":824637,"ResolveTableValuedFunctions":8097,"EliminateSerialization":68509,"OptimizeJsonExprs":2153281,"GetCurrentDatabaseAndCatalog":182881,"TypeCoercion$BooleanEquality":21238,"package$ExpressionCanonicalizer$CleanExpressions":38251,"EliminateLimits":63769,"ReplaceIntersectWithSemiJoin":20198,"ConstantPropagation":183707,"PushExtraPredicateThroughJoin":22243,"CostBasedJoinReorder":20352,"Analyzer$ResolveReferences":3674076,"CTESubstitution":336074,"RemoveRedundantAliases":4192722,"TypeCoercion$ImplicitTypeCasts":19820,"RewriteExceptAll":24537,"UpdateAttributeNullability":1806111,"PropagateEmptyRelation":61166,"InferFiltersFromGenerate":26029,"SimplifyCasts":4427591,"EliminateMapObjects":61475,"DetectAmbiguousSelfJoin":37396,"ReplaceExpressions":92362,"ResolveInlineTables":9373,"ResolveUnion":10714,"OptimizeIn":4584691,"CollapseWindow":153505,"TypeCoercion$IfCoercion":19457,"ResolveSessionCatalog":14684,"PartitionPruning":35452,"BooleanSimplification":11293189,"TypeCoercion$PromoteStrings":28627,"Analyzer$ResolveAliases":19334,"DecimalAggregates":56706,"PruneFilters":521052,"PruneHiveTablePartitions":3269881,"Analyzer$ResolveMissingReferences":13664,"TransposeWindow":56581,"Analyzer$ResolveRelations":15307,"EliminateUnions":10546,"RewritePredicateSubquery":75573,"ObjectSerializerPruning":14958,"LimitPushDown":53155,"SimplifyCaseConversionExpressions":232695,"ResolvePartitionSpec":7580,"Analyzer$ResolveNaturalAndUsingJoin":9126,"UnwrapCastInBinaryComparison":706979,"EliminateView":23061,"CombineTypedFilters":14969,"ReplaceUpdateFieldsExpression":53941,"OptimizeLimitZero":23317,"CheckCartesianProducts":31791,"ExtractPythonUDFFromAggregate":34609,"Analyzer$ExtractWindowExpressions":29079,"ReplaceExceptWithAntiJoin":20961,"ResolveLambdaVariables":12322,"FallBackFileSourceV2":10172,"Analyzer$ResolveTables":11294,"SubstituteUnresolvedOrdinals":23146,"TypeCoercion$CaseWhenCoercion":16750,"DecimalPrecision":47118,"EliminateSorts":2744521,"PushDownLeftSemiAntiJoin":72596,"ExtractPythonUDFFromJoinCondition":17158,"TypeCoercion$StackCoercion":13360,"Analyzer$ResolveAggAliasInGroupBy":28000,"TypeCoercion$StringLiteralCoercion":18594,"FoldablePropagation":3904687,"ResolveHiveSerdeTable":7855,"V2ScanRelationPushDown":223604,"EliminateDistinct":20586,"InferFiltersFromConstraints":1683205,"DetermineTableStats":8886,"Analyzer$PullOutNondeterministic":50425,"Analyzer$ResolveFunctions":29148,"ReplaceNullWithFalseInPredicate":288639,"ResolveHigherOrderFunctions":14767,"Analyzer$ResolvePivot":6594,"CollapseProject":412030,"Analyzer$ResolveNewInstance":9484,"ColumnPruning":7910301,"Analyzer$ResolveWindowOrder":16761,"TypeCoercion$ConcatCoercion":23006,"PushDownPredicates":485480,"TimeWindowing":45208,"Optimizer$OptimizeSubqueries":145177,"RewriteNonCorrelatedExists":74613,"DemoteBroadcastHashJoin":8584,"TypeCoercion$Division":21207,"ComputeCurrentTime":193930,"ResolveCreateNamedStruct":101714,"TypeCoercion$EltCoercion":16755,"ConvertToLocalRelation":41432,"OptimizeWindowFunctions":3262422,"RemoveRepetitionFromGroupExpressions":21694,"ReplaceDistinctWithAggregate":16605,"PreprocessTableCreation":7332,"ResolveSQLOnFile":6344,"Analyzer$ResolveSubquery":22009,"CombineConcats":34824,"Analyzer$ResolveGroupingAnalytics":32742,"Analyzer$ResolveBinaryArithmetic":23136,"RemoveDispensableExpressions":332001,"Analyzer$ResolveAlterTableChanges":8602,"ResolveEncodersInScalaAgg":19181,"TypeCoercion$IntegralDivision":17363,"Analyzer$ResolveWindowFrame":71903,"Analyzer$ResolveDeserializer":48971,"RewriteDistinctAggregates":47731,"RemoveNoopOperators":123750,"Analyzer$ResolveAggregateFunctions":7941,"NormalizeFloatingNumbers":13907,"ReorderJoin":66970,"Analyzer$ResolveUpCast":6492,"Analyzer$ResolveGenerate":9525,"TypeCoercion$WidenSetOperationTypes":85406,"EliminateOuterJoin":52682,"SimplifyExtractValueOps":197803,"OptimizeMetadataOnlyQuery":14383,"EliminateResolvedHint":65678,"Analyzer$ResolveInsertInto":31774,"ReplaceExceptWithFilter":41097,"CleanupAliases":521602,"SchemaPruning":226416,"ResolveHints$DisableHints":11352,"Analyzer$ResolveOutputRelation":8203,"BloomFilterJoinRule":28038,"HiveAnalysis":6461,"Analyzer$ResolveRandomSeed":8864,"TypeCoercion$WindowFrameCoercion":13345,"ConstantFolding":1865955,"TypeCoercion$DateTimeOperations":17624,"ResolveNoopDropTable":8222,"TypeCoercion$InConversion":25344,"FindDataSourceTable":7326,"ApplyCharTypePadding":21059,"SimplifyConditionals":274126,"DataSourceAnalysis":7349,"TypeCoercion$FunctionArgumentConversion":23500,"Analyzer$GlobalAggregates":7088,"Analyzer$LookupFunctions":23090,"CombineFilters":64486,"ReplaceDeduplicateWithAggregate":109300,"PreprocessTableInsertion":6742},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":1,"Analyzer$HandleNullInputsForUDF":1,"OptimizeUpdateFields":4,"Analyzer$ResolveSubqueryColumnAliases":1,"ResolveTimeZone":1,"Analyzer$ResolveNamespace":1,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":1,"RelationConversions":1,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":1,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":1,"EliminateJoinToEmptyRelation":1,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":1,"Analyzer$ExtractGenerator":1,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":1,"ResolveHints$ResolveJoinStrategyHints":1,"TypeCoercion$MapZipWithCoercion":1,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":1,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":1,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":1,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":1,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":1,"package$ExpressionCanonicalizer$CleanExpressions":1,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":1,"CTESubstitution":1,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":1,"RewriteExceptAll":1,"UpdateAttributeNullability":3,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":1,"ReplaceExpressions":1,"ResolveInlineTables":1,"ResolveUnion":1,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":1,"ResolveSessionCatalog":1,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":1,"Analyzer$ResolveAliases":1,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":1,"TransposeWindow":3,"Analyzer$ResolveRelations":1,"EliminateUnions":1,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":1,"Analyzer$ResolveNaturalAndUsingJoin":1,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":1,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":1,"FallBackFileSourceV2":1,"Analyzer$ResolveTables":1,"SubstituteUnresolvedOrdinals":1,"TypeCoercion$CaseWhenCoercion":1,"DecimalPrecision":1,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":1,"Analyzer$ResolveAggAliasInGroupBy":1,"TypeCoercion$StringLiteralCoercion":1,"FoldablePropagation":3,"ResolveHiveSerdeTable":1,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":1,"Analyzer$PullOutNondeterministic":1,"Analyzer$ResolveFunctions":1,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":1,"Analyzer$ResolvePivot":1,"CollapseProject":4,"Analyzer$ResolveNewInstance":1,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":1,"TypeCoercion$ConcatCoercion":1,"PushDownPredicates":6,"TimeWindowing":1,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"DemoteBroadcastHashJoin":1,"TypeCoercion$Division":1,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":1,"TypeCoercion$EltCoercion":1,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":1,"ResolveSQLOnFile":1,"Analyzer$ResolveSubquery":1,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":1,"Analyzer$ResolveBinaryArithmetic":1,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":1,"ResolveEncodersInScalaAgg":1,"TypeCoercion$IntegralDivision":1,"Analyzer$ResolveWindowFrame":1,"Analyzer$ResolveDeserializer":1,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":1,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":1,"Analyzer$ResolveGenerate":1,"TypeCoercion$WidenSetOperationTypes":1,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":1,"ReplaceExceptWithFilter":1,"CleanupAliases":2,"SchemaPruning":1,"ResolveHints$DisableHints":1,"Analyzer$ResolveOutputRelation":1,"BloomFilterJoinRule":1,"HiveAnalysis":1,"Analyzer$ResolveRandomSeed":1,"TypeCoercion$WindowFrameCoercion":1,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":1,"ResolveNoopDropTable":1,"TypeCoercion$InConversion":1,"FindDataSourceTable":1,"ApplyCharTypePadding":1,"SimplifyConditionals":3,"DataSourceAnalysis":1,"TypeCoercion$FunctionArgumentConversion":1,"Analyzer$GlobalAggregates":1,"Analyzer$LookupFunctions":1,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":1},"numEffectiveRunsPerRule":{"EliminateSorts":1,"CollapseProject":2,"ColumnPruning":2,"PushDownPredicates":1,"CleanupAliases":1},"timeEffectiveRunsPerRule":{"EliminateSorts":2744521,"CollapseProject":367031,"ColumnPruning":3195882,"PushDownPredicates":342338,"CleanupAliases":33547},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":7,"time":1691340936436}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":8,"description":"showString at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nGlobalLimit 21\n+- LocalLimit 21\n   +- Project [cast(year#129 as string) AS year#184, cast(title#130 as string) AS title#185, cast(directors_0#131 as string) AS directors_0#186, cast(rating#132 as string) AS rating#187, cast(actors_0#137 as string) AS actors_0#188, cast(actors_1#138 as string) AS actors_1#189, cast(actors_2#139 as string) AS actors_2#190]\n      +- Sort [year#129 ASC NULLS FIRST], true\n         +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n            +- Project [year#129, title#130, directors_0#131, rating#132, actors_0#137, actors_1#138, actors_2#139]\n               +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Analyzed Logical Plan ==\nyear: string, title: string, directors_0: string, rating: string, actors_0: string, actors_1: string, actors_2: string\nGlobalLimit 21\n+- LocalLimit 21\n   +- Project [cast(year#129 as string) AS year#184, cast(title#130 as string) AS title#185, cast(directors_0#131 as string) AS directors_0#186, cast(rating#132 as string) AS rating#187, cast(actors_0#137 as string) AS actors_0#188, cast(actors_1#138 as string) AS actors_1#189, cast(actors_2#139 as string) AS actors_2#190]\n      +- Sort [year#129 ASC NULLS FIRST], true\n         +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n            +- Project [year#129, title#130, directors_0#131, rating#132, actors_0#137, actors_1#138, actors_2#139]\n               +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Optimized Logical Plan ==\nGlobalLimit 21\n+- LocalLimit 21\n   +- Project [cast(year#129 as string) AS year#184, title#130, directors_0#131, cast(rating#132 as string) AS rating#187, actors_0#137, actors_1#138, actors_2#139]\n      +- Sort [year#129 ASC NULLS FIRST], true\n         +- Project [year#129, title#130, directors_0#131, rating#132, actors_0#137, actors_1#138, actors_2#139]\n            +- Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n               +- Relation[year#129,title#130,directors_0#131,rating#132,genres_0#133,genres_1#134,rank#135,running_time_secs#136,actors_0#137,actors_1#138,actors_2#139,directors_1#140,directors_2#141] csv\n\n== Physical Plan ==\nTakeOrderedAndProject(limit=21, orderBy=[year#129 ASC NULLS FIRST], output=[year#184,title#130,directors_0#131,rating#187,actors_0#137,actors_1#138,actors_2#139])\n+- *(1) Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))\n   +- FileScan csv [year#129,title#130,directors_0#131,rating#132,actors_0#137,actors_1#138,actors_2#139] Batched: false, DataFilters: [(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<year:int,title:string,directors_0:string,rating:double,actors_0:string,actors_1:string,act...\n","sparkPlanInfo":{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[year#129 ASC NULLS FIRST], output=[year#184,title#130,directors_0#131,rating#187,actors_0#137,actors_1#138,actors_2#139])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Filter","simpleString":"Filter (((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [year#129,title#130,directors_0#131,rating#132,actors_0#137,actors_1#138,actors_2#139] Batched: false, DataFilters: [(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<year:int,title:string,directors_0:string,rating:double,actors_0:string,actors_1:string,act...","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv]","ReadSchema":"struct<year:int,title:string,directors_0:string,rating:double,actors_0:string,actors_1:string,actors_2:string>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Foster))]","DataFilters":"[(((actors_0#137 = Jodie Foster) OR (actors_1#138 = Jodie Foster)) OR (actors_2#139 = Jodie Foster))]"},"metrics":[{"name":"number of output rows","accumulatorId":547,"metricType":"sum"},{"name":"number of files read","accumulatorId":548,"metricType":"sum"},{"name":"metadata time","accumulatorId":549,"metricType":"timing"},{"name":"size of files read","accumulatorId":550,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":546,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":545,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":543,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":544,"metricType":"nsTiming"},{"name":"records read","accumulatorId":541,"metricType":"sum"},{"name":"local bytes read","accumulatorId":539,"metricType":"size"},{"name":"fetch wait time","accumulatorId":540,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":537,"metricType":"size"},{"name":"local blocks read","accumulatorId":536,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":535,"metricType":"sum"},{"name":"remote bytes read to disk","accumulatorId":538,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":542,"metricType":"size"}]},"time":1691340945851}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":8,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":8,"accumUpdates":[[548,1],[549,1],[550,497937]]}
{"Event":"SparkListenerJobStart","Job ID":11,"Submission Time":1691340946031,"Stage Infos":[{"Stage ID":14,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":57,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"127\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[56],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":56,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"126\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[55],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":54,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"125\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[53],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":53,"Name":"FileScanRDD","Scope":"{\"id\":\"125\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":55,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"122\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[54],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[14],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movie-summary","spark.rdd.scope":"{\"id\":\"127\",\"name\":\"takeOrdered\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"8","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":14,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":57,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"127\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[56],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":56,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"126\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[55],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":54,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"125\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[53],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":53,"Name":"FileScanRDD","Scope":"{\"id\":\"125\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":55,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"122\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[54],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340946037,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movie-summary","spark.rdd.scope":"{\"id\":\"127\",\"name\":\"takeOrdered\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"8","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":14,"Stage Attempt ID":0,"Task Info":{"Task ID":12,"Index":0,"Attempt":0,"Launch Time":1691340946048,"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":14,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":12,"Index":0,"Attempt":0,"Launch Time":1691340946048,"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691340946621,"Failed":false,"Killed":false,"Accumulables":[{"ID":545,"Name":"duration","Update":"758","Value":"758","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":546,"Name":"number of output rows","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":547,"Name":"number of output rows","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":551,"Name":"internal.metrics.executorDeserializeTime","Update":117,"Value":117,"Internal":true,"Count Failed Values":true},{"ID":552,"Name":"internal.metrics.executorDeserializeCpuTime","Update":75919904,"Value":75919904,"Internal":true,"Count Failed Values":true},{"ID":553,"Name":"internal.metrics.executorRunTime","Update":435,"Value":435,"Internal":true,"Count Failed Values":true},{"ID":554,"Name":"internal.metrics.executorCpuTime","Update":244761277,"Value":244761277,"Internal":true,"Count Failed Values":true},{"ID":555,"Name":"internal.metrics.resultSize","Update":6527,"Value":6527,"Internal":true,"Count Failed Values":true},{"ID":557,"Name":"internal.metrics.resultSerializationTime","Update":6,"Value":6,"Internal":true,"Count Failed Values":true},{"ID":572,"Name":"internal.metrics.input.bytesRead","Update":497937,"Value":497937,"Internal":true,"Count Failed Values":true},{"ID":573,"Name":"internal.metrics.input.recordsRead","Update":16,"Value":16,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":136961560,"JVMOffHeapMemory":111814408,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":595274,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":595274,"OffHeapUnifiedMemory":0,"DirectPoolMemory":12809,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":13,"MinorGCTime":218,"MajorGCCount":3,"MajorGCTime":328},"Task Metrics":{"Executor Deserialize Time":117,"Executor Deserialize CPU Time":75919904,"Executor Run Time":435,"Executor CPU Time":244761277,"Peak Execution Memory":0,"Result Size":6527,"JVM GC Time":0,"Result Serialization Time":6,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":497937,"Records Read":16},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":14,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":57,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"127\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[56],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":56,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"126\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[55],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":54,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"125\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[53],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":53,"Name":"FileScanRDD","Scope":"{\"id\":\"125\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":55,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"122\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[54],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691340946037,"Completion Time":1691340946622,"Accumulables":[{"ID":545,"Name":"duration","Value":"758","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":546,"Name":"number of output rows","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":547,"Name":"number of output rows","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":551,"Name":"internal.metrics.executorDeserializeTime","Value":117,"Internal":true,"Count Failed Values":true},{"ID":552,"Name":"internal.metrics.executorDeserializeCpuTime","Value":75919904,"Internal":true,"Count Failed Values":true},{"ID":553,"Name":"internal.metrics.executorRunTime","Value":435,"Internal":true,"Count Failed Values":true},{"ID":554,"Name":"internal.metrics.executorCpuTime","Value":244761277,"Internal":true,"Count Failed Values":true},{"ID":555,"Name":"internal.metrics.resultSize","Value":6527,"Internal":true,"Count Failed Values":true},{"ID":557,"Name":"internal.metrics.resultSerializationTime","Value":6,"Internal":true,"Count Failed Values":true},{"ID":572,"Name":"internal.metrics.input.bytesRead","Value":497937,"Internal":true,"Count Failed Values":true},{"ID":573,"Name":"internal.metrics.input.recordsRead","Value":16,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":11,"Completion Time":1691340946625,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":8,"timePerRule":{"PruneFileSourcePartitions":352245,"ReassignLambdaVariableID":76219,"PushPredicateThroughNonJoin":2259152,"Analyzer$ResolveEncodersInUDF":51818,"Analyzer$HandleNullInputsForUDF":60804,"OptimizeUpdateFields":319300,"Analyzer$ResolveSubqueryColumnAliases":18378,"ResolveTimeZone":61070,"Analyzer$ResolveNamespace":91301,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":21825,"RelationConversions":12896,"RewriteCorrelatedScalarSubquery":498672,"RemoveLiteralFromGroupExpressions":20373,"PushProjectionThroughUnion":76835,"EliminateSubqueryAliases":25336,"ResolveCatalogs":25481,"PushLeftSemiLeftAntiThroughJoin":57781,"Analyzer$ResolveUserSpecifiedColumns":17178,"FlattenScalarSubqueriesWithAggregates":119112,"LikeSimplification":303723,"CollapseRepartition":121042,"ResolveHints$ResolveCoalesceHints":16807,"Analyzer$ExtractGenerator":142936,"RewriteIntersectAll":20578,"Analyzer$AddMetadataColumns":118949,"ResolveHints$ResolveJoinStrategyHints":20983,"TypeCoercion$MapZipWithCoercion":124667,"NullPropagation":373758,"EliminateAggregateFilter":16887,"PullupCorrelatedPredicates":83827,"UpdateOuterReferences":19467,"ExtractPythonUDFs":1717690,"Analyzer$WindowsSubstitution":21347,"CombineUnions":147816,"ExtractGroupingPythonUDFFromAggregate":23204,"ReorderAssociativeOperator":311677,"CleanupDynamicPruningFilters":225679,"ResolveHints$RemoveAllHints":11477,"SimplifyBinaryComparison":276226,"ResolveTableValuedFunctions":27949,"EliminateSerialization":81475,"OptimizeJsonExprs":319210,"GetCurrentDatabaseAndCatalog":187716,"TypeCoercion$BooleanEquality":318881,"package$ExpressionCanonicalizer$CleanExpressions":161775,"EliminateLimits":107815,"ReplaceIntersectWithSemiJoin":21224,"ConstantPropagation":108687,"PushExtraPredicateThroughJoin":25246,"CostBasedJoinReorder":19353,"Analyzer$ResolveReferences":1269080,"CTESubstitution":1596670,"RemoveRedundantAliases":1220684,"TypeCoercion$ImplicitTypeCasts":216284,"RewriteExceptAll":23186,"UpdateAttributeNullability":1045855,"PropagateEmptyRelation":76312,"InferFiltersFromGenerate":23908,"SimplifyCasts":404371,"EliminateMapObjects":76818,"DetectAmbiguousSelfJoin":90912,"ReplaceExpressions":93673,"ResolveInlineTables":23257,"ResolveUnion":25416,"OptimizeIn":242269,"CollapseWindow":84845,"TypeCoercion$IfCoercion":183759,"ResolveSessionCatalog":463192,"PartitionPruning":1631899,"BooleanSimplification":1137010,"TypeCoercion$PromoteStrings":7233020,"Analyzer$ResolveAliases":19527,"DecimalAggregates":71102,"PruneFilters":331678,"PruneHiveTablePartitions":1935299,"Analyzer$ResolveMissingReferences":14839,"TransposeWindow":64130,"Analyzer$ResolveRelations":39622,"EliminateUnions":18275,"RewritePredicateSubquery":92999,"ObjectSerializerPruning":18761,"LimitPushDown":61391,"SimplifyCaseConversionExpressions":253412,"ResolvePartitionSpec":19521,"Analyzer$ResolveNaturalAndUsingJoin":20607,"UnwrapCastInBinaryComparison":271125,"EliminateView":20821,"CombineTypedFilters":19835,"ReplaceUpdateFieldsExpression":76876,"OptimizeLimitZero":28416,"CheckCartesianProducts":33870,"ExtractPythonUDFFromAggregate":25147,"Analyzer$ExtractWindowExpressions":27353,"ReplaceExceptWithAntiJoin":19601,"ResolveLambdaVariables":46128,"FallBackFileSourceV2":15170,"Analyzer$ResolveTables":29570,"SubstituteUnresolvedOrdinals":12479,"TypeCoercion$CaseWhenCoercion":96156,"DecimalPrecision":658926,"EliminateSorts":77420,"PushDownLeftSemiAntiJoin":79031,"ExtractPythonUDFFromJoinCondition":25108,"TypeCoercion$StackCoercion":98374,"Analyzer$ResolveAggAliasInGroupBy":15698,"TypeCoercion$StringLiteralCoercion":118219,"FoldablePropagation":784889,"ResolveHiveSerdeTable":21744,"V2ScanRelationPushDown":2240458,"EliminateDistinct":8773,"InferFiltersFromConstraints":451417,"DetermineTableStats":16356,"Analyzer$PullOutNondeterministic":129127,"Analyzer$ResolveFunctions":182498,"ReplaceNullWithFalseInPredicate":279993,"ResolveHigherOrderFunctions":62413,"Analyzer$ResolvePivot":17573,"CollapseProject":110447,"Analyzer$ResolveNewInstance":67954,"ColumnPruning":11216908,"Analyzer$ResolveWindowOrder":2033710,"TypeCoercion$ConcatCoercion":156604,"PushDownPredicates":575961,"TimeWindowing":130405,"Optimizer$OptimizeSubqueries":198751,"RewriteNonCorrelatedExists":80365,"TypeCoercion$Division":151834,"ComputeCurrentTime":163560,"ResolveCreateNamedStruct":997191,"TypeCoercion$EltCoercion":128239,"ConvertToLocalRelation":58601,"OptimizeWindowFunctions":174980,"RemoveRepetitionFromGroupExpressions":19548,"ReplaceDistinctWithAggregate":19410,"PreprocessTableCreation":14434,"ResolveSQLOnFile":17864,"Analyzer$ResolveSubquery":80706,"CombineConcats":13355,"Analyzer$ResolveGroupingAnalytics":28499,"Analyzer$ResolveBinaryArithmetic":111727,"RemoveDispensableExpressions":209457,"Analyzer$ResolveAlterTableChanges":14165,"ResolveEncodersInScalaAgg":2466321,"TypeCoercion$IntegralDivision":129327,"Analyzer$ResolveWindowFrame":92833,"Analyzer$ResolveDeserializer":887894,"RewriteDistinctAggregates":46108,"RemoveNoopOperators":301806,"Analyzer$ResolveAggregateFunctions":18455,"NormalizeFloatingNumbers":22338,"ReorderJoin":126860,"Analyzer$ResolveUpCast":21442,"Analyzer$ResolveGenerate":19820,"TypeCoercion$WidenSetOperationTypes":203773,"EliminateOuterJoin":58824,"SimplifyExtractValueOps":225820,"OptimizeMetadataOnlyQuery":13123,"EliminateResolvedHint":82052,"Analyzer$ResolveInsertInto":16542,"ReplaceExceptWithFilter":36818,"CleanupAliases":32128,"SchemaPruning":275409,"ResolveHints$DisableHints":27978,"Analyzer$ResolveOutputRelation":18625,"BloomFilterJoinRule":35777,"HiveAnalysis":11339,"Analyzer$ResolveRandomSeed":18477,"TypeCoercion$WindowFrameCoercion":104363,"ConstantFolding":4036286,"TypeCoercion$DateTimeOperations":198392,"ResolveNoopDropTable":13334,"TypeCoercion$InConversion":89592,"FindDataSourceTable":18070,"ApplyCharTypePadding":64821,"SimplifyConditionals":310297,"DataSourceAnalysis":12361,"TypeCoercion$FunctionArgumentConversion":1902634,"Analyzer$GlobalAggregates":15383,"Analyzer$LookupFunctions":75497,"CombineFilters":3099543,"ReplaceDeduplicateWithAggregate":117551,"PreprocessTableInsertion":11698},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":2,"Analyzer$HandleNullInputsForUDF":2,"OptimizeUpdateFields":5,"Analyzer$ResolveSubqueryColumnAliases":3,"ResolveTimeZone":3,"Analyzer$ResolveNamespace":3,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":3,"RelationConversions":2,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":3,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":3,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":2,"Analyzer$ExtractGenerator":3,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":3,"ResolveHints$ResolveJoinStrategyHints":2,"TypeCoercion$MapZipWithCoercion":3,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":2,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":2,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":2,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":3,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":3,"package$ExpressionCanonicalizer$CleanExpressions":12,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":3,"CTESubstitution":2,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":3,"RewriteExceptAll":1,"UpdateAttributeNullability":4,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":2,"ReplaceExpressions":1,"ResolveInlineTables":3,"ResolveUnion":3,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":3,"ResolveSessionCatalog":3,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":3,"Analyzer$ResolveAliases":3,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":3,"TransposeWindow":3,"Analyzer$ResolveRelations":3,"EliminateUnions":2,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":3,"Analyzer$ResolveNaturalAndUsingJoin":3,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":3,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":3,"FallBackFileSourceV2":3,"Analyzer$ResolveTables":3,"SubstituteUnresolvedOrdinals":2,"TypeCoercion$CaseWhenCoercion":3,"DecimalPrecision":3,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":3,"Analyzer$ResolveAggAliasInGroupBy":3,"TypeCoercion$StringLiteralCoercion":3,"FoldablePropagation":3,"ResolveHiveSerdeTable":3,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":2,"Analyzer$PullOutNondeterministic":2,"Analyzer$ResolveFunctions":3,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":3,"Analyzer$ResolvePivot":3,"CollapseProject":4,"Analyzer$ResolveNewInstance":3,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":3,"TypeCoercion$ConcatCoercion":3,"PushDownPredicates":6,"TimeWindowing":3,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"TypeCoercion$Division":3,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":3,"TypeCoercion$EltCoercion":3,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":2,"ResolveSQLOnFile":3,"Analyzer$ResolveSubquery":3,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":3,"Analyzer$ResolveBinaryArithmetic":3,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":2,"ResolveEncodersInScalaAgg":3,"TypeCoercion$IntegralDivision":3,"Analyzer$ResolveWindowFrame":3,"Analyzer$ResolveDeserializer":3,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":3,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":3,"Analyzer$ResolveGenerate":3,"TypeCoercion$WidenSetOperationTypes":3,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":3,"ReplaceExceptWithFilter":1,"CleanupAliases":2,"SchemaPruning":1,"ResolveHints$DisableHints":2,"Analyzer$ResolveOutputRelation":3,"BloomFilterJoinRule":1,"HiveAnalysis":2,"Analyzer$ResolveRandomSeed":3,"TypeCoercion$WindowFrameCoercion":3,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":3,"ResolveNoopDropTable":2,"TypeCoercion$InConversion":3,"FindDataSourceTable":3,"ApplyCharTypePadding":2,"SimplifyConditionals":3,"DataSourceAnalysis":2,"TypeCoercion$FunctionArgumentConversion":3,"Analyzer$GlobalAggregates":3,"Analyzer$LookupFunctions":2,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":2},"numEffectiveRunsPerRule":{"package$ExpressionCanonicalizer$CleanExpressions":2,"RemoveRedundantAliases":1,"SimplifyCasts":1,"PushDownPredicates":1,"Analyzer$ResolveDeserializer":1},"timeEffectiveRunsPerRule":{"package$ExpressionCanonicalizer$CleanExpressions":31493,"RemoveRedundantAliases":617596,"SimplifyCasts":289700,"PushDownPredicates":397415,"Analyzer$ResolveDeserializer":870001},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":8,"time":1691340946698}
{"Event":"SparkListenerBlockManagerRemoved","Block Manager ID":{"Executor ID":"6","Host":"ip-10-0-10-231.us-west-2.compute.internal","Port":40521},"Timestamp":1691341009237}
{"Event":"SparkListenerExecutorRemoved","Timestamp":1691341009240,"Executor ID":"6","Removed Reason":"Container container_1691339165261_0001_01_000014 exited from explicit termination request."}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":9,"description":"csv at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nGlobalLimit 1\n+- LocalLimit 1\n   +- Filter (length(trim(value#219, None)) > 0)\n      +- Project [value#213 AS value#219]\n         +- Project [value#213]\n            +- Relation[value#213] text\n\n== Analyzed Logical Plan ==\nvalue: string\nGlobalLimit 1\n+- LocalLimit 1\n   +- Filter (length(trim(value#219, None)) > 0)\n      +- Project [value#213 AS value#219]\n         +- Project [value#213]\n            +- Relation[value#213] text\n\n== Optimized Logical Plan ==\nGlobalLimit 1\n+- LocalLimit 1\n   +- Filter (length(trim(value#213, None)) > 0)\n      +- Relation[value#213] text\n\n== Physical Plan ==\nCollectLimit 1\n+- *(1) Filter (length(trim(value#213, None)) > 0)\n   +- FileScan text [value#213] Batched: false, DataFilters: [(length(trim(value#213, None)) > 0)], Format: Text, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<value:string>\n","sparkPlanInfo":{"nodeName":"CollectLimit","simpleString":"CollectLimit 1","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Filter","simpleString":"Filter (length(trim(value#213, None)) > 0)","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan text ","simpleString":"FileScan text [value#213] Batched: false, DataFilters: [(length(trim(value#213, None)) > 0)], Format: Text, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<value:string>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv]","ReadSchema":"struct<value:string>","Format":"Text","Batched":"false","PartitionFilters":"[]","PushedFilters":"[]","DataFilters":"[(length(trim(value#213, None)) > 0)]"},"metrics":[{"name":"number of output rows","accumulatorId":588,"metricType":"sum"},{"name":"number of files read","accumulatorId":589,"metricType":"sum"},{"name":"metadata time","accumulatorId":590,"metricType":"timing"},{"name":"size of files read","accumulatorId":591,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":587,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":586,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":584,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":585,"metricType":"nsTiming"},{"name":"records read","accumulatorId":582,"metricType":"sum"},{"name":"local bytes read","accumulatorId":580,"metricType":"size"},{"name":"fetch wait time","accumulatorId":581,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":578,"metricType":"size"},{"name":"local blocks read","accumulatorId":577,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":576,"metricType":"sum"},{"name":"remote bytes read to disk","accumulatorId":579,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":583,"metricType":"size"}]},"time":1691341145498}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":9,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":9,"accumUpdates":[[589,1],[590,0],[591,497937]]}
{"Event":"SparkListenerJobStart","Job ID":12,"Submission Time":1691341145565,"Stage Infos":[{"Stage ID":15,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":61,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"137\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[60],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":58,"Name":"FileScanRDD","Scope":"{\"id\":\"136\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":60,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"133\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[59],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":59,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"136\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[58],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[15],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.driver.memory":"2048M","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"9","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":15,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":61,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"137\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[60],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":58,"Name":"FileScanRDD","Scope":"{\"id\":\"136\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":60,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"133\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[59],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":59,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"136\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[58],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341145567,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.driver.memory":"2048M","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"9","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerExecutorAdded","Timestamp":1691341150728,"Executor ID":"7","Executor Info":{"Host":"ip-10-0-10-52.us-west-2.compute.internal","Total Cores":4,"Log Urls":{"stdout":"http://ip-10-0-10-52.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000017/hadoop/stdout?start=-4096","stderr":"http://ip-10-0-10-52.us-west-2.compute.internal:8042/node/containerlogs/container_1691339165261_0001_01_000017/hadoop/stderr?start=-4096"},"Attributes":{"NM_HTTP_ADDRESS":"ip-10-0-10-52.us-west-2.compute.internal:8042","USER":"hadoop","LOG_FILES":"stderr,stdout","NM_HTTP_PORT":"8042","CLUSTER_ID":"","NM_PORT":"8041","HTTP_SCHEME":"http://","NM_HOST":"ip-10-0-10-52.us-west-2.compute.internal","CONTAINER_ID":"container_1691339165261_0001_01_000017"},"Resources":{},"Resource Profile Id":0}}
{"Event":"SparkListenerBlockManagerAdded","Block Manager ID":{"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Port":33487},"Maximum Memory":2199493017,"Timestamp":1691341151107,"Maximum Onheap Memory":2199493017,"Maximum Offheap Memory":0}
{"Event":"SparkListenerTaskStart","Stage ID":15,"Stage Attempt ID":0,"Task Info":{"Task ID":13,"Index":0,"Attempt":0,"Launch Time":1691341151247,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":15,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":13,"Index":0,"Attempt":0,"Launch Time":1691341151247,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691341157629,"Failed":false,"Killed":false,"Accumulables":[{"ID":587,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":592,"Name":"internal.metrics.executorDeserializeTime","Update":2059,"Value":2059,"Internal":true,"Count Failed Values":true},{"ID":593,"Name":"internal.metrics.executorDeserializeCpuTime","Update":1106034631,"Value":1106034631,"Internal":true,"Count Failed Values":true},{"ID":594,"Name":"internal.metrics.executorRunTime","Update":4259,"Value":4259,"Internal":true,"Count Failed Values":true},{"ID":595,"Name":"internal.metrics.executorCpuTime","Update":2158552501,"Value":2158552501,"Internal":true,"Count Failed Values":true},{"ID":596,"Name":"internal.metrics.resultSize","Update":1696,"Value":1696,"Internal":true,"Count Failed Values":true},{"ID":597,"Name":"internal.metrics.jvmGCTime","Update":266,"Value":266,"Internal":true,"Count Failed Values":true},{"ID":598,"Name":"internal.metrics.resultSerializationTime","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":613,"Name":"internal.metrics.input.bytesRead","Update":1363,"Value":1363,"Internal":true,"Count Failed Values":true},{"ID":614,"Name":"internal.metrics.input.recordsRead","Update":1,"Value":1,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":2059,"Executor Deserialize CPU Time":1106034631,"Executor Run Time":4259,"Executor CPU Time":2158552501,"Peak Execution Memory":0,"Result Size":1696,"JVM GC Time":266,"Result Serialization Time":1,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":1363,"Records Read":1},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":15,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":61,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"137\",\"name\":\"mapPartitionsInternal\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[60],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":58,"Name":"FileScanRDD","Scope":"{\"id\":\"136\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":60,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"133\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[59],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":59,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"136\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[58],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341145567,"Completion Time":1691341157630,"Accumulables":[{"ID":587,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":588,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":592,"Name":"internal.metrics.executorDeserializeTime","Value":2059,"Internal":true,"Count Failed Values":true},{"ID":593,"Name":"internal.metrics.executorDeserializeCpuTime","Value":1106034631,"Internal":true,"Count Failed Values":true},{"ID":594,"Name":"internal.metrics.executorRunTime","Value":4259,"Internal":true,"Count Failed Values":true},{"ID":595,"Name":"internal.metrics.executorCpuTime","Value":2158552501,"Internal":true,"Count Failed Values":true},{"ID":596,"Name":"internal.metrics.resultSize","Value":1696,"Internal":true,"Count Failed Values":true},{"ID":597,"Name":"internal.metrics.jvmGCTime","Value":266,"Internal":true,"Count Failed Values":true},{"ID":598,"Name":"internal.metrics.resultSerializationTime","Value":1,"Internal":true,"Count Failed Values":true},{"ID":613,"Name":"internal.metrics.input.bytesRead","Value":1363,"Internal":true,"Count Failed Values":true},{"ID":614,"Name":"internal.metrics.input.recordsRead","Value":1,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":12,"Completion Time":1691341157630,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":9,"timePerRule":{"PruneFileSourcePartitions":3313807,"ReassignLambdaVariableID":34146,"PushPredicateThroughNonJoin":11190,"Analyzer$ResolveEncodersInUDF":8032,"Analyzer$HandleNullInputsForUDF":11559,"OptimizeUpdateFields":77369,"Analyzer$ResolveSubqueryColumnAliases":5039,"ResolveTimeZone":6384,"Analyzer$ResolveNamespace":5214,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":7085,"RelationConversions":4779,"RewriteCorrelatedScalarSubquery":272968,"RemoveLiteralFromGroupExpressions":15001,"PushProjectionThroughUnion":31914,"EliminateSubqueryAliases":17793,"ResolveCatalogs":6603,"PushLeftSemiLeftAntiThroughJoin":26669,"Analyzer$ResolveUserSpecifiedColumns":4216,"FlattenScalarSubqueriesWithAggregates":19531,"LikeSimplification":93196,"CollapseRepartition":30108,"ResolveHints$ResolveCoalesceHints":5723,"Analyzer$ExtractGenerator":18885,"RewriteIntersectAll":14867,"Analyzer$AddMetadataColumns":40123,"ResolveHints$ResolveJoinStrategyHints":7297,"TypeCoercion$MapZipWithCoercion":6996,"NullPropagation":4194730,"EliminateAggregateFilter":14094,"PullupCorrelatedPredicates":41076,"UpdateOuterReferences":7897,"ExtractPythonUDFs":162359,"Analyzer$WindowsSubstitution":5635,"CombineUnions":38492,"ExtractGroupingPythonUDFFromAggregate":8411,"ReorderAssociativeOperator":186710,"CleanupDynamicPruningFilters":51802,"ResolveHints$RemoveAllHints":5015,"SimplifyBinaryComparison":260258,"ResolveTableValuedFunctions":5846,"EliminateSerialization":34868,"OptimizeJsonExprs":153050,"GetCurrentDatabaseAndCatalog":119784,"TypeCoercion$BooleanEquality":9459,"package$ExpressionCanonicalizer$CleanExpressions":64484,"EliminateLimits":54262,"ReplaceIntersectWithSemiJoin":25657,"ConstantPropagation":40411,"PushExtraPredicateThroughJoin":10105,"CostBasedJoinReorder":16850,"Analyzer$ResolveReferences":38541,"CTESubstitution":202729,"RemoveRedundantAliases":427967,"TypeCoercion$ImplicitTypeCasts":7935,"RewriteExceptAll":18066,"UpdateAttributeNullability":344091,"PropagateEmptyRelation":42084,"InferFiltersFromGenerate":12368,"SimplifyCasts":76095,"EliminateMapObjects":31053,"DetectAmbiguousSelfJoin":26368,"ReplaceExpressions":48994,"ResolveInlineTables":6108,"ResolveUnion":7815,"OptimizeIn":68151,"CollapseWindow":29392,"TypeCoercion$IfCoercion":9015,"ResolveSessionCatalog":9800,"PartitionPruning":29615,"BooleanSimplification":100241,"TypeCoercion$PromoteStrings":11623,"Analyzer$ResolveAliases":5198,"DecimalAggregates":25229,"PruneFilters":402705,"PruneHiveTablePartitions":30936,"Analyzer$ResolveMissingReferences":4999,"TransposeWindow":25749,"Analyzer$ResolveRelations":10655,"EliminateUnions":6635,"RewritePredicateSubquery":64154,"ObjectSerializerPruning":7580,"LimitPushDown":32247,"SimplifyCaseConversionExpressions":98901,"ResolvePartitionSpec":5532,"Analyzer$ResolveNaturalAndUsingJoin":5282,"UnwrapCastInBinaryComparison":121266,"EliminateView":13391,"CombineTypedFilters":8230,"ReplaceUpdateFieldsExpression":28877,"OptimizeLimitZero":19798,"CheckCartesianProducts":24127,"ExtractPythonUDFFromAggregate":10288,"Analyzer$ExtractWindowExpressions":7544,"ReplaceExceptWithAntiJoin":15485,"ResolveLambdaVariables":7856,"FallBackFileSourceV2":4238,"Analyzer$ResolveTables":8589,"SubstituteUnresolvedOrdinals":4680,"TypeCoercion$CaseWhenCoercion":6696,"DecimalPrecision":19066,"EliminateSorts":12528,"PushDownLeftSemiAntiJoin":42582,"ExtractPythonUDFFromJoinCondition":11282,"TypeCoercion$StackCoercion":6565,"Analyzer$ResolveAggAliasInGroupBy":4726,"TypeCoercion$StringLiteralCoercion":6981,"FoldablePropagation":336586,"ResolveHiveSerdeTable":5572,"V2ScanRelationPushDown":93001,"EliminateDistinct":9002,"InferFiltersFromConstraints":512099,"DetermineTableStats":6561,"Analyzer$PullOutNondeterministic":58284,"Analyzer$ResolveFunctions":11066,"ReplaceNullWithFalseInPredicate":99022,"ResolveHigherOrderFunctions":7069,"Analyzer$ResolvePivot":4973,"CollapseProject":182654,"Analyzer$ResolveNewInstance":5724,"ColumnPruning":550137,"Analyzer$ResolveWindowOrder":7306,"TypeCoercion$ConcatCoercion":8937,"PushDownPredicates":2825830,"TimeWindowing":33449,"Optimizer$OptimizeSubqueries":92708,"RewriteNonCorrelatedExists":35385,"TypeCoercion$Division":7556,"ComputeCurrentTime":116071,"ResolveCreateNamedStruct":8568,"TypeCoercion$EltCoercion":8286,"ConvertToLocalRelation":35473,"OptimizeWindowFunctions":73081,"RemoveRepetitionFromGroupExpressions":12859,"ReplaceDistinctWithAggregate":16210,"PreprocessTableCreation":5368,"ResolveSQLOnFile":4606,"Analyzer$ResolveSubquery":11049,"CombineConcats":12011,"Analyzer$ResolveGroupingAnalytics":7721,"Analyzer$ResolveBinaryArithmetic":9628,"RemoveDispensableExpressions":79501,"Analyzer$ResolveAlterTableChanges":6162,"ResolveEncodersInScalaAgg":10059,"TypeCoercion$IntegralDivision":7143,"Analyzer$ResolveWindowFrame":5854,"Analyzer$ResolveDeserializer":7120,"RewriteDistinctAggregates":10453,"RemoveNoopOperators":108091,"Analyzer$ResolveAggregateFunctions":5447,"NormalizeFloatingNumbers":9418,"ReorderJoin":35211,"Analyzer$ResolveUpCast":5542,"Analyzer$ResolveGenerate":6010,"TypeCoercion$WidenSetOperationTypes":58148,"EliminateOuterJoin":28602,"SimplifyExtractValueOps":64599,"OptimizeMetadataOnlyQuery":13213,"EliminateResolvedHint":44963,"Analyzer$ResolveInsertInto":4434,"ReplaceExceptWithFilter":30210,"CleanupAliases":10871,"SchemaPruning":70903,"ResolveHints$DisableHints":10713,"Analyzer$ResolveOutputRelation":5388,"BloomFilterJoinRule":50704,"HiveAnalysis":4649,"Analyzer$ResolveRandomSeed":5530,"TypeCoercion$WindowFrameCoercion":6725,"ConstantFolding":150273,"TypeCoercion$DateTimeOperations":8260,"ResolveNoopDropTable":5444,"TypeCoercion$InConversion":8468,"FindDataSourceTable":5280,"ApplyCharTypePadding":10843,"SimplifyConditionals":91964,"DataSourceAnalysis":5134,"TypeCoercion$FunctionArgumentConversion":9962,"Analyzer$GlobalAggregates":4498,"Analyzer$LookupFunctions":13349,"CombineFilters":49700,"ReplaceDeduplicateWithAggregate":83213,"PreprocessTableInsertion":7732},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":1,"Analyzer$HandleNullInputsForUDF":1,"OptimizeUpdateFields":4,"Analyzer$ResolveSubqueryColumnAliases":1,"ResolveTimeZone":1,"Analyzer$ResolveNamespace":1,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":1,"RelationConversions":1,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":1,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":1,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":1,"Analyzer$ExtractGenerator":1,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":1,"ResolveHints$ResolveJoinStrategyHints":1,"TypeCoercion$MapZipWithCoercion":1,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":1,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":1,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":1,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":1,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":1,"package$ExpressionCanonicalizer$CleanExpressions":2,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":1,"CTESubstitution":1,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":1,"RewriteExceptAll":1,"UpdateAttributeNullability":3,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":1,"ReplaceExpressions":1,"ResolveInlineTables":1,"ResolveUnion":1,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":1,"ResolveSessionCatalog":1,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":1,"Analyzer$ResolveAliases":1,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":1,"TransposeWindow":3,"Analyzer$ResolveRelations":1,"EliminateUnions":1,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":1,"Analyzer$ResolveNaturalAndUsingJoin":1,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":1,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":1,"FallBackFileSourceV2":1,"Analyzer$ResolveTables":1,"SubstituteUnresolvedOrdinals":1,"TypeCoercion$CaseWhenCoercion":1,"DecimalPrecision":1,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":1,"Analyzer$ResolveAggAliasInGroupBy":1,"TypeCoercion$StringLiteralCoercion":1,"FoldablePropagation":3,"ResolveHiveSerdeTable":1,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":1,"Analyzer$PullOutNondeterministic":1,"Analyzer$ResolveFunctions":1,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":1,"Analyzer$ResolvePivot":1,"CollapseProject":4,"Analyzer$ResolveNewInstance":1,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":1,"TypeCoercion$ConcatCoercion":1,"PushDownPredicates":6,"TimeWindowing":1,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"TypeCoercion$Division":1,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":1,"TypeCoercion$EltCoercion":1,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":1,"ResolveSQLOnFile":1,"Analyzer$ResolveSubquery":1,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":1,"Analyzer$ResolveBinaryArithmetic":1,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":1,"ResolveEncodersInScalaAgg":1,"TypeCoercion$IntegralDivision":1,"Analyzer$ResolveWindowFrame":1,"Analyzer$ResolveDeserializer":1,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":1,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":1,"Analyzer$ResolveGenerate":1,"TypeCoercion$WidenSetOperationTypes":1,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":1,"ReplaceExceptWithFilter":1,"CleanupAliases":1,"SchemaPruning":1,"ResolveHints$DisableHints":1,"Analyzer$ResolveOutputRelation":1,"BloomFilterJoinRule":1,"HiveAnalysis":1,"Analyzer$ResolveRandomSeed":1,"TypeCoercion$WindowFrameCoercion":1,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":1,"ResolveNoopDropTable":1,"TypeCoercion$InConversion":1,"FindDataSourceTable":1,"ApplyCharTypePadding":1,"SimplifyConditionals":3,"DataSourceAnalysis":1,"TypeCoercion$FunctionArgumentConversion":1,"Analyzer$GlobalAggregates":1,"Analyzer$LookupFunctions":1,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":1},"numEffectiveRunsPerRule":{"RemoveNoopOperators":1,"PushDownPredicates":1,"CollapseProject":1,"RemoveRedundantAliases":1},"timeEffectiveRunsPerRule":{"RemoveNoopOperators":76690,"PushDownPredicates":2729314,"CollapseProject":160413,"RemoveRedundantAliases":271974},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":9,"time":1691341157635}
{"Event":"SparkListenerJobStart","Job ID":13,"Submission Time":1691341157692,"Stage Infos":[{"Stage ID":16,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":67,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"145\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[66],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":64,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"142\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[63],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":63,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"143\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[62],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":66,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"144\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[65],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":65,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[64],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":62,"Name":"FileScanRDD","Scope":"{\"id\":\"143\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[16],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.rdd.scope":"{\"id\":\"146\",\"name\":\"aggregate\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":16,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":67,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"145\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[66],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":64,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"142\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[63],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":63,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"143\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[62],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":66,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"144\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[65],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":65,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[64],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":62,"Name":"FileScanRDD","Scope":"{\"id\":\"143\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341157695,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.rdd.scope":"{\"id\":\"146\",\"name\":\"aggregate\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":16,"Stage Attempt ID":0,"Task Info":{"Task ID":14,"Index":0,"Attempt":0,"Launch Time":1691341157705,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":16,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":14,"Index":0,"Attempt":0,"Launch Time":1691341157705,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691341160564,"Failed":false,"Killed":false,"Accumulables":[{"ID":617,"Name":"number of output rows","Update":"4610","Value":"4610","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"internal.metrics.executorDeserializeTime","Update":112,"Value":112,"Internal":true,"Count Failed Values":true},{"ID":622,"Name":"internal.metrics.executorDeserializeCpuTime","Update":101785854,"Value":101785854,"Internal":true,"Count Failed Values":true},{"ID":623,"Name":"internal.metrics.executorRunTime","Update":2730,"Value":2730,"Internal":true,"Count Failed Values":true},{"ID":624,"Name":"internal.metrics.executorCpuTime","Update":2095948122,"Value":2095948122,"Internal":true,"Count Failed Values":true},{"ID":625,"Name":"internal.metrics.resultSize","Update":1707,"Value":1707,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.resultSerializationTime","Update":3,"Value":3,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.input.bytesRead","Update":497937,"Value":497937,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.input.recordsRead","Update":4610,"Value":4610,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":112,"Executor Deserialize CPU Time":101785854,"Executor Run Time":2730,"Executor CPU Time":2095948122,"Peak Execution Memory":0,"Result Size":1707,"JVM GC Time":0,"Result Serialization Time":3,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":497937,"Records Read":4610},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":16,"Stage Attempt ID":0,"Stage Name":"csv at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":67,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"145\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[66],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":64,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"142\",\"name\":\"DeserializeToObject\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[63],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":63,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"143\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[62],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":66,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"144\",\"name\":\"mapPartitions\"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[65],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":65,"Name":"SQLExecutionRDD","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[64],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":62,"Name":"FileScanRDD","Scope":"{\"id\":\"143\",\"name\":\"Scan text \"}","Callsite":"csv at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.DataFrameReader.csv(DataFrameReader.scala:796)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341157695,"Completion Time":1691341160565,"Accumulables":[{"ID":617,"Name":"number of output rows","Value":"4610","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":621,"Name":"internal.metrics.executorDeserializeTime","Value":112,"Internal":true,"Count Failed Values":true},{"ID":622,"Name":"internal.metrics.executorDeserializeCpuTime","Value":101785854,"Internal":true,"Count Failed Values":true},{"ID":623,"Name":"internal.metrics.executorRunTime","Value":2730,"Internal":true,"Count Failed Values":true},{"ID":624,"Name":"internal.metrics.executorCpuTime","Value":2095948122,"Internal":true,"Count Failed Values":true},{"ID":625,"Name":"internal.metrics.resultSize","Value":1707,"Internal":true,"Count Failed Values":true},{"ID":627,"Name":"internal.metrics.resultSerializationTime","Value":3,"Internal":true,"Count Failed Values":true},{"ID":642,"Name":"internal.metrics.input.bytesRead","Value":497937,"Internal":true,"Count Failed Values":true},{"ID":643,"Name":"internal.metrics.input.recordsRead","Value":4610,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":13,"Completion Time":1691341160565,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":10,"description":"showString at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nGlobalLimit 11\n+- LocalLimit 11\n   +- Project [cast(year#229 as string) AS year#267, cast(title#230 as string) AS title#268, cast(rating#232 as string) AS rating#269, cast(actors_0#237 as string) AS actors_0#270, cast(actors_1#238 as string) AS actors_1#271, cast(actors_2#239 as string) AS actors_2#272]\n      +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n         +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Analyzed Logical Plan ==\nyear: string, title: string, rating: string, actors_0: string, actors_1: string, actors_2: string\nGlobalLimit 11\n+- LocalLimit 11\n   +- Project [cast(year#229 as string) AS year#267, cast(title#230 as string) AS title#268, cast(rating#232 as string) AS rating#269, cast(actors_0#237 as string) AS actors_0#270, cast(actors_1#238 as string) AS actors_1#271, cast(actors_2#239 as string) AS actors_2#272]\n      +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n         +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Optimized Logical Plan ==\nGlobalLimit 11\n+- LocalLimit 11\n   +- Project [cast(year#229 as string) AS year#267, title#230, cast(rating#232 as string) AS rating#269, actors_0#237, actors_1#238, actors_2#239]\n      +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Physical Plan ==\nCollectLimit 11\n+- *(1) Project [cast(year#229 as string) AS year#267, title#230, cast(rating#232 as string) AS rating#269, actors_0#237, actors_1#238, actors_2#239]\n   +- FileScan csv [year#229,title#230,rating#232,actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<year:int,title:string,rating:double,actors_0:string,actors_1:string,actors_2:string>\n","sparkPlanInfo":{"nodeName":"CollectLimit","simpleString":"CollectLimit 11","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Project","simpleString":"Project [cast(year#229 as string) AS year#267, title#230, cast(rating#232 as string) AS rating#269, actors_0#237, actors_1#238, actors_2#239]","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [year#229,title#230,rating#232,actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [], Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [], ReadSchema: struct<year:int,title:string,rating:double,actors_0:string,actors_1:string,actors_2:string>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv]","ReadSchema":"struct<year:int,title:string,rating:double,actors_0:string,actors_1:string,actors_2:string>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[]","DataFilters":"[]"},"metrics":[{"name":"number of output rows","accumulatorId":657,"metricType":"sum"},{"name":"number of files read","accumulatorId":658,"metricType":"sum"},{"name":"metadata time","accumulatorId":659,"metricType":"timing"},{"name":"size of files read","accumulatorId":660,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":656,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":654,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":655,"metricType":"nsTiming"},{"name":"records read","accumulatorId":652,"metricType":"sum"},{"name":"local bytes read","accumulatorId":650,"metricType":"size"},{"name":"fetch wait time","accumulatorId":651,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":648,"metricType":"size"},{"name":"local blocks read","accumulatorId":647,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":646,"metricType":"sum"},{"name":"remote bytes read to disk","accumulatorId":649,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":653,"metricType":"size"}]},"time":1691341166545}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":10,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":10,"accumUpdates":[[658,1],[659,0],[660,497937]]}
{"Event":"SparkListenerJobStart","Job ID":14,"Submission Time":1691341166627,"Stage Infos":[{"Stage ID":17,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":71,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"157\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[70],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":70,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"153\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[69],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":69,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"156\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[68],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":68,"Name":"FileScanRDD","Scope":"{\"id\":\"156\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[17],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.driver.memory":"2048M","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"10","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":17,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":71,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"157\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[70],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":70,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"153\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[69],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":69,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"156\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[68],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":68,"Name":"FileScanRDD","Scope":"{\"id\":\"156\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341166628,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.driver.memory":"2048M","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"10","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":17,"Stage Attempt ID":0,"Task Info":{"Task ID":15,"Index":0,"Attempt":0,"Launch Time":1691341166636,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":17,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":15,"Index":0,"Attempt":0,"Launch Time":1691341166636,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691341166935,"Failed":false,"Killed":false,"Accumulables":[{"ID":657,"Name":"number of output rows","Update":"11","Value":"11","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":661,"Name":"internal.metrics.executorDeserializeTime","Update":27,"Value":27,"Internal":true,"Count Failed Values":true},{"ID":662,"Name":"internal.metrics.executorDeserializeCpuTime","Update":21534953,"Value":21534953,"Internal":true,"Count Failed Values":true},{"ID":663,"Name":"internal.metrics.executorRunTime","Update":260,"Value":260,"Internal":true,"Count Failed Values":true},{"ID":664,"Name":"internal.metrics.executorCpuTime","Update":179406213,"Value":179406213,"Internal":true,"Count Failed Values":true},{"ID":665,"Name":"internal.metrics.resultSize","Update":2520,"Value":2520,"Internal":true,"Count Failed Values":true},{"ID":682,"Name":"internal.metrics.input.bytesRead","Update":16384,"Value":16384,"Internal":true,"Count Failed Values":true},{"ID":683,"Name":"internal.metrics.input.recordsRead","Update":11,"Value":11,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":27,"Executor Deserialize CPU Time":21534953,"Executor Run Time":260,"Executor CPU Time":179406213,"Peak Execution Memory":0,"Result Size":2520,"JVM GC Time":0,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":16384,"Records Read":11},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":17,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":71,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"157\",\"name\":\"mapPartitionsInternal\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[70],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":70,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"153\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[69],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":69,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"156\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[68],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":68,"Name":"FileScanRDD","Scope":"{\"id\":\"156\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341166628,"Completion Time":1691341166936,"Accumulables":[{"ID":657,"Name":"number of output rows","Value":"11","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":661,"Name":"internal.metrics.executorDeserializeTime","Value":27,"Internal":true,"Count Failed Values":true},{"ID":662,"Name":"internal.metrics.executorDeserializeCpuTime","Value":21534953,"Internal":true,"Count Failed Values":true},{"ID":663,"Name":"internal.metrics.executorRunTime","Value":260,"Internal":true,"Count Failed Values":true},{"ID":664,"Name":"internal.metrics.executorCpuTime","Value":179406213,"Internal":true,"Count Failed Values":true},{"ID":665,"Name":"internal.metrics.resultSize","Value":2520,"Internal":true,"Count Failed Values":true},{"ID":682,"Name":"internal.metrics.input.bytesRead","Value":16384,"Internal":true,"Count Failed Values":true},{"ID":683,"Name":"internal.metrics.input.recordsRead","Value":11,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":14,"Completion Time":1691341166936,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":10,"timePerRule":{"PruneFileSourcePartitions":165443,"ReassignLambdaVariableID":47680,"PushPredicateThroughNonJoin":10141,"Analyzer$ResolveEncodersInUDF":39871,"Analyzer$HandleNullInputsForUDF":59669,"OptimizeUpdateFields":243610,"Analyzer$ResolveSubqueryColumnAliases":15848,"ResolveTimeZone":53402,"Analyzer$ResolveNamespace":274586,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":18654,"RelationConversions":10184,"RewriteCorrelatedScalarSubquery":281666,"RemoveLiteralFromGroupExpressions":14843,"PushProjectionThroughUnion":37493,"EliminateSubqueryAliases":16503,"ResolveCatalogs":20584,"PushLeftSemiLeftAntiThroughJoin":31369,"Analyzer$ResolveUserSpecifiedColumns":14462,"FlattenScalarSubqueriesWithAggregates":63532,"LikeSimplification":154468,"CollapseRepartition":34112,"ResolveHints$ResolveCoalesceHints":13979,"Analyzer$ExtractGenerator":109929,"RewriteIntersectAll":14168,"Analyzer$AddMetadataColumns":124603,"ResolveHints$ResolveJoinStrategyHints":15405,"TypeCoercion$MapZipWithCoercion":68041,"NullPropagation":167273,"EliminateAggregateFilter":13044,"PullupCorrelatedPredicates":44450,"UpdateOuterReferences":18705,"ExtractPythonUDFs":354593,"Analyzer$WindowsSubstitution":13507,"CombineUnions":47268,"ExtractGroupingPythonUDFFromAggregate":9818,"ReorderAssociativeOperator":194512,"CleanupDynamicPruningFilters":119409,"ResolveHints$RemoveAllHints":9698,"SimplifyBinaryComparison":110162,"ResolveTableValuedFunctions":17742,"EliminateSerialization":40269,"OptimizeJsonExprs":193837,"GetCurrentDatabaseAndCatalog":189435,"TypeCoercion$BooleanEquality":169310,"package$ExpressionCanonicalizer$CleanExpressions":42575,"EliminateLimits":61160,"ReplaceIntersectWithSemiJoin":13105,"ConstantPropagation":32705,"PushExtraPredicateThroughJoin":15405,"CostBasedJoinReorder":15271,"Analyzer$ResolveReferences":167446,"CTESubstitution":388429,"RemoveRedundantAliases":697376,"TypeCoercion$ImplicitTypeCasts":103047,"RewriteExceptAll":15647,"UpdateAttributeNullability":729492,"PropagateEmptyRelation":54174,"InferFiltersFromGenerate":14424,"SimplifyCasts":308214,"EliminateMapObjects":41108,"DetectAmbiguousSelfJoin":77151,"ReplaceExpressions":56771,"ResolveInlineTables":18908,"ResolveUnion":24611,"OptimizeIn":91190,"CollapseWindow":36661,"TypeCoercion$IfCoercion":102552,"ResolveSessionCatalog":32867,"PartitionPruning":34825,"BooleanSimplification":221677,"TypeCoercion$PromoteStrings":99517,"Analyzer$ResolveAliases":16901,"DecimalAggregates":39112,"PruneFilters":47599,"PruneHiveTablePartitions":87314,"Analyzer$ResolveMissingReferences":12855,"TransposeWindow":30915,"Analyzer$ResolveRelations":80819,"EliminateUnions":14157,"RewritePredicateSubquery":17111,"ObjectSerializerPruning":13238,"LimitPushDown":34208,"SimplifyCaseConversionExpressions":108056,"ResolvePartitionSpec":18784,"Analyzer$ResolveNaturalAndUsingJoin":18527,"UnwrapCastInBinaryComparison":122125,"EliminateView":13397,"CombineTypedFilters":12019,"ReplaceUpdateFieldsExpression":46960,"OptimizeLimitZero":20297,"CheckCartesianProducts":26996,"ExtractPythonUDFFromAggregate":12498,"Analyzer$ExtractWindowExpressions":24488,"ReplaceExceptWithAntiJoin":13054,"ResolveLambdaVariables":38500,"FallBackFileSourceV2":12591,"Analyzer$ResolveTables":34344,"SubstituteUnresolvedOrdinals":10430,"TypeCoercion$CaseWhenCoercion":109540,"DecimalPrecision":165524,"EliminateSorts":17071,"PushDownLeftSemiAntiJoin":38384,"ExtractPythonUDFFromJoinCondition":12858,"TypeCoercion$StackCoercion":62027,"Analyzer$ResolveAggAliasInGroupBy":14695,"TypeCoercion$StringLiteralCoercion":81081,"FoldablePropagation":421018,"ResolveHiveSerdeTable":17317,"V2ScanRelationPushDown":137184,"EliminateDistinct":9783,"InferFiltersFromConstraints":21339,"DetermineTableStats":14461,"Analyzer$PullOutNondeterministic":168035,"Analyzer$ResolveFunctions":157478,"ReplaceNullWithFalseInPredicate":85183,"ResolveHigherOrderFunctions":59791,"Analyzer$ResolvePivot":14602,"CollapseProject":321405,"Analyzer$ResolveNewInstance":49702,"ColumnPruning":488257,"Analyzer$ResolveWindowOrder":62916,"TypeCoercion$ConcatCoercion":135590,"PushDownPredicates":111727,"TimeWindowing":103897,"Optimizer$OptimizeSubqueries":118135,"RewriteNonCorrelatedExists":46196,"TypeCoercion$Division":87682,"ComputeCurrentTime":115699,"ResolveCreateNamedStruct":113395,"TypeCoercion$EltCoercion":74691,"ConvertToLocalRelation":43979,"OptimizeWindowFunctions":119178,"RemoveRepetitionFromGroupExpressions":29113,"ReplaceDistinctWithAggregate":12771,"PreprocessTableCreation":10380,"ResolveSQLOnFile":12770,"Analyzer$ResolveSubquery":57248,"CombineConcats":11653,"Analyzer$ResolveGroupingAnalytics":24597,"Analyzer$ResolveBinaryArithmetic":68282,"RemoveDispensableExpressions":126499,"Analyzer$ResolveAlterTableChanges":12145,"ResolveEncodersInScalaAgg":73153,"TypeCoercion$IntegralDivision":137278,"Analyzer$ResolveWindowFrame":52435,"Analyzer$ResolveDeserializer":521750,"RewriteDistinctAggregates":15861,"RemoveNoopOperators":111959,"Analyzer$ResolveAggregateFunctions":15510,"NormalizeFloatingNumbers":13065,"ReorderJoin":37749,"Analyzer$ResolveUpCast":17715,"Analyzer$ResolveGenerate":146137,"TypeCoercion$WidenSetOperationTypes":178643,"EliminateOuterJoin":32982,"SimplifyExtractValueOps":103100,"OptimizeMetadataOnlyQuery":12248,"EliminateResolvedHint":44592,"Analyzer$ResolveInsertInto":13239,"ReplaceExceptWithFilter":63710,"CleanupAliases":30888,"SchemaPruning":140780,"ResolveHints$DisableHints":21685,"Analyzer$ResolveOutputRelation":17501,"BloomFilterJoinRule":28925,"HiveAnalysis":10092,"Analyzer$ResolveRandomSeed":16333,"TypeCoercion$WindowFrameCoercion":75034,"ConstantFolding":123198,"TypeCoercion$DateTimeOperations":198936,"ResolveNoopDropTable":10915,"TypeCoercion$InConversion":80168,"FindDataSourceTable":15452,"ApplyCharTypePadding":54383,"SimplifyConditionals":108101,"DataSourceAnalysis":57004,"TypeCoercion$FunctionArgumentConversion":127646,"Analyzer$GlobalAggregates":12482,"Analyzer$LookupFunctions":60079,"CombineFilters":36754,"ReplaceDeduplicateWithAggregate":78223,"PreprocessTableInsertion":8364},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":2,"Analyzer$HandleNullInputsForUDF":2,"OptimizeUpdateFields":5,"Analyzer$ResolveSubqueryColumnAliases":3,"ResolveTimeZone":3,"Analyzer$ResolveNamespace":3,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":3,"RelationConversions":2,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":3,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":3,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":2,"Analyzer$ExtractGenerator":3,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":3,"ResolveHints$ResolveJoinStrategyHints":2,"TypeCoercion$MapZipWithCoercion":3,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":2,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":2,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":2,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":3,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":3,"package$ExpressionCanonicalizer$CleanExpressions":1,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":3,"CTESubstitution":2,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":3,"RewriteExceptAll":1,"UpdateAttributeNullability":4,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":2,"ReplaceExpressions":1,"ResolveInlineTables":3,"ResolveUnion":3,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":3,"ResolveSessionCatalog":3,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":3,"Analyzer$ResolveAliases":3,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":3,"TransposeWindow":3,"Analyzer$ResolveRelations":3,"EliminateUnions":2,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":3,"Analyzer$ResolveNaturalAndUsingJoin":3,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":3,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":3,"FallBackFileSourceV2":3,"Analyzer$ResolveTables":3,"SubstituteUnresolvedOrdinals":2,"TypeCoercion$CaseWhenCoercion":3,"DecimalPrecision":3,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":3,"Analyzer$ResolveAggAliasInGroupBy":3,"TypeCoercion$StringLiteralCoercion":3,"FoldablePropagation":3,"ResolveHiveSerdeTable":3,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":2,"Analyzer$PullOutNondeterministic":2,"Analyzer$ResolveFunctions":3,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":3,"Analyzer$ResolvePivot":3,"CollapseProject":4,"Analyzer$ResolveNewInstance":3,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":3,"TypeCoercion$ConcatCoercion":3,"PushDownPredicates":6,"TimeWindowing":3,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"TypeCoercion$Division":3,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":3,"TypeCoercion$EltCoercion":3,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":2,"ResolveSQLOnFile":3,"Analyzer$ResolveSubquery":3,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":3,"Analyzer$ResolveBinaryArithmetic":3,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":2,"ResolveEncodersInScalaAgg":3,"TypeCoercion$IntegralDivision":3,"Analyzer$ResolveWindowFrame":3,"Analyzer$ResolveDeserializer":3,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":3,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":3,"Analyzer$ResolveGenerate":3,"TypeCoercion$WidenSetOperationTypes":3,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":3,"ReplaceExceptWithFilter":1,"CleanupAliases":2,"SchemaPruning":1,"ResolveHints$DisableHints":2,"Analyzer$ResolveOutputRelation":3,"BloomFilterJoinRule":1,"HiveAnalysis":2,"Analyzer$ResolveRandomSeed":3,"TypeCoercion$WindowFrameCoercion":3,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":3,"ResolveNoopDropTable":2,"TypeCoercion$InConversion":3,"FindDataSourceTable":3,"ApplyCharTypePadding":2,"SimplifyConditionals":3,"DataSourceAnalysis":2,"TypeCoercion$FunctionArgumentConversion":3,"Analyzer$GlobalAggregates":3,"Analyzer$LookupFunctions":2,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":2},"numEffectiveRunsPerRule":{"Analyzer$ResolveDeserializer":1,"CollapseProject":1,"SimplifyCasts":1,"RemoveRedundantAliases":1},"timeEffectiveRunsPerRule":{"Analyzer$ResolveDeserializer":507120,"CollapseProject":282582,"SimplifyCasts":249935,"RemoveRedundantAliases":362009},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":10,"time":1691341166985}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":11,"description":"createOrReplaceTempView at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.createOrReplaceTempView(Dataset.scala:3341)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nCreateViewCommand `movies_view`, false, true, LocalTempView\n   +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n      +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Analyzed Logical Plan ==\n\nCreateViewCommand `movies_view`, false, true, LocalTempView\n   +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n      +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Optimized Logical Plan ==\nCreateViewCommand `movies_view`, false, true, LocalTempView\n   +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n      +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Physical Plan ==\nExecute CreateViewCommand\n   +- CreateViewCommand `movies_view`, false, true, LocalTempView\n         +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n            +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n","sparkPlanInfo":{"nodeName":"Execute CreateViewCommand","simpleString":"Execute CreateViewCommand","children":[],"metadata":{},"metrics":[]},"time":1691341189452}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":11,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":11,"timePerRule":{"PruneFileSourcePartitions":15921,"ReassignLambdaVariableID":14873,"PushPredicateThroughNonJoin":3697,"Analyzer$ResolveEncodersInUDF":7051,"Analyzer$HandleNullInputsForUDF":9934,"OptimizeUpdateFields":50759,"Analyzer$ResolveSubqueryColumnAliases":5020,"ResolveTimeZone":4882,"Analyzer$ResolveNamespace":5523,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":8503,"RelationConversions":67951,"RewriteCorrelatedScalarSubquery":118899,"RemoveLiteralFromGroupExpressions":4390,"PushProjectionThroughUnion":7216,"EliminateSubqueryAliases":7375,"ResolveCatalogs":8395,"PushLeftSemiLeftAntiThroughJoin":7361,"Analyzer$ResolveUserSpecifiedColumns":4250,"FlattenScalarSubqueriesWithAggregates":13207,"LikeSimplification":28584,"CollapseRepartition":7038,"ResolveHints$ResolveCoalesceHints":5435,"Analyzer$ExtractGenerator":17825,"RewriteIntersectAll":4824,"Analyzer$AddMetadataColumns":11635,"ResolveHints$ResolveJoinStrategyHints":7186,"TypeCoercion$MapZipWithCoercion":4921,"NullPropagation":15401,"EliminateAggregateFilter":10658,"PullupCorrelatedPredicates":28153,"UpdateOuterReferences":5476,"ExtractPythonUDFs":71773,"Analyzer$WindowsSubstitution":6367,"CombineUnions":10804,"ExtractGroupingPythonUDFFromAggregate":3794,"ReorderAssociativeOperator":35766,"CleanupDynamicPruningFilters":25959,"ResolveHints$RemoveAllHints":4331,"SimplifyBinaryComparison":12801,"ResolveTableValuedFunctions":5151,"EliminateSerialization":11592,"OptimizeJsonExprs":38615,"GetCurrentDatabaseAndCatalog":106697,"TypeCoercion$BooleanEquality":12554,"EliminateLimits":8305,"ReplaceIntersectWithSemiJoin":4457,"ConstantPropagation":7338,"PushExtraPredicateThroughJoin":5909,"CostBasedJoinReorder":12324,"Analyzer$ResolveReferences":47336,"CTESubstitution":171086,"RemoveRedundantAliases":31946,"TypeCoercion$ImplicitTypeCasts":8320,"RewriteExceptAll":5919,"UpdateAttributeNullability":61117,"PropagateEmptyRelation":8791,"InferFiltersFromGenerate":6721,"SimplifyCasts":18995,"EliminateMapObjects":12690,"DetectAmbiguousSelfJoin":30986,"ReplaceExpressions":13069,"ResolveInlineTables":4606,"ResolveUnion":11503,"OptimizeIn":12861,"CollapseWindow":7327,"TypeCoercion$IfCoercion":5237,"ResolveSessionCatalog":12688,"PartitionPruning":24876,"BooleanSimplification":14725,"TypeCoercion$PromoteStrings":8518,"Analyzer$ResolveAliases":5022,"DecimalAggregates":8817,"PruneFilters":11747,"PruneHiveTablePartitions":3533,"Analyzer$ResolveMissingReferences":4774,"TransposeWindow":7467,"Analyzer$ResolveRelations":11082,"EliminateUnions":8103,"RewritePredicateSubquery":4620,"ObjectSerializerPruning":3983,"LimitPushDown":6662,"SimplifyCaseConversionExpressions":11053,"ResolvePartitionSpec":5557,"Analyzer$ResolveNaturalAndUsingJoin":4766,"UnwrapCastInBinaryComparison":12037,"EliminateView":4692,"CombineTypedFilters":4234,"ReplaceUpdateFieldsExpression":12100,"OptimizeLimitZero":5979,"CheckCartesianProducts":19782,"ExtractPythonUDFFromAggregate":4875,"Analyzer$ExtractWindowExpressions":10756,"ReplaceExceptWithAntiJoin":5007,"ResolveLambdaVariables":6677,"FallBackFileSourceV2":4738,"Analyzer$ResolveTables":44358,"SubstituteUnresolvedOrdinals":4865,"TypeCoercion$CaseWhenCoercion":4846,"DecimalPrecision":14103,"EliminateSorts":6029,"PushDownLeftSemiAntiJoin":8969,"ExtractPythonUDFFromJoinCondition":6319,"TypeCoercion$StackCoercion":5219,"Analyzer$ResolveAggAliasInGroupBy":5120,"TypeCoercion$StringLiteralCoercion":5026,"FoldablePropagation":14978,"ResolveHiveSerdeTable":5186,"V2ScanRelationPushDown":22412,"EliminateDistinct":8427,"InferFiltersFromConstraints":14652,"DetermineTableStats":5899,"Analyzer$PullOutNondeterministic":5493,"Analyzer$ResolveFunctions":7996,"ReplaceNullWithFalseInPredicate":11184,"ResolveHigherOrderFunctions":5669,"Analyzer$ResolvePivot":5163,"CollapseProject":11708,"Analyzer$ResolveNewInstance":8676,"ColumnPruning":77968,"Analyzer$ResolveWindowOrder":6462,"TypeCoercion$ConcatCoercion":7179,"PushDownPredicates":42735,"TimeWindowing":9300,"Optimizer$OptimizeSubqueries":40409,"RewriteNonCorrelatedExists":9030,"TypeCoercion$Division":5874,"ComputeCurrentTime":86102,"ResolveCreateNamedStruct":6413,"TypeCoercion$EltCoercion":6409,"ConvertToLocalRelation":8809,"OptimizeWindowFunctions":5971,"RemoveRepetitionFromGroupExpressions":3439,"ReplaceDistinctWithAggregate":4869,"PreprocessTableCreation":8588,"ResolveSQLOnFile":4435,"Analyzer$ResolveSubquery":5725,"CombineConcats":6834,"Analyzer$ResolveGroupingAnalytics":10792,"Analyzer$ResolveBinaryArithmetic":8322,"RemoveDispensableExpressions":17240,"Analyzer$ResolveAlterTableChanges":6285,"ResolveEncodersInScalaAgg":8869,"TypeCoercion$IntegralDivision":5459,"Analyzer$ResolveWindowFrame":4797,"Analyzer$ResolveDeserializer":27628,"RewriteDistinctAggregates":5699,"RemoveNoopOperators":12264,"Analyzer$ResolveAggregateFunctions":5656,"NormalizeFloatingNumbers":4835,"ReorderJoin":10231,"Analyzer$ResolveUpCast":7334,"Analyzer$ResolveGenerate":5145,"TypeCoercion$WidenSetOperationTypes":77833,"EliminateOuterJoin":6233,"SimplifyExtractValueOps":11491,"OptimizeMetadataOnlyQuery":10879,"EliminateResolvedHint":18675,"Analyzer$ResolveInsertInto":4839,"ReplaceExceptWithFilter":17477,"CleanupAliases":10567,"SchemaPruning":32026,"ResolveHints$DisableHints":13055,"Analyzer$ResolveOutputRelation":4712,"BloomFilterJoinRule":13961,"HiveAnalysis":4808,"Analyzer$ResolveRandomSeed":5176,"TypeCoercion$WindowFrameCoercion":5226,"ConstantFolding":10167,"TypeCoercion$DateTimeOperations":4991,"ResolveNoopDropTable":4928,"TypeCoercion$InConversion":9231,"FindDataSourceTable":5433,"ApplyCharTypePadding":8484,"SimplifyConditionals":11362,"DataSourceAnalysis":4669,"TypeCoercion$FunctionArgumentConversion":6090,"Analyzer$GlobalAggregates":4152,"Analyzer$LookupFunctions":16508,"CombineFilters":8286,"ReplaceDeduplicateWithAggregate":39159,"PreprocessTableInsertion":4282},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":1,"Analyzer$HandleNullInputsForUDF":1,"OptimizeUpdateFields":3,"Analyzer$ResolveSubqueryColumnAliases":1,"ResolveTimeZone":1,"Analyzer$ResolveNamespace":1,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":1,"RelationConversions":1,"RewriteCorrelatedScalarSubquery":2,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":2,"EliminateSubqueryAliases":1,"ResolveCatalogs":1,"PushLeftSemiLeftAntiThroughJoin":2,"Analyzer$ResolveUserSpecifiedColumns":1,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":2,"CollapseRepartition":2,"ResolveHints$ResolveCoalesceHints":1,"Analyzer$ExtractGenerator":1,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":1,"ResolveHints$ResolveJoinStrategyHints":1,"TypeCoercion$MapZipWithCoercion":1,"NullPropagation":2,"EliminateAggregateFilter":2,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":1,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":1,"CombineUnions":3,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":2,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":1,"SimplifyBinaryComparison":2,"ResolveTableValuedFunctions":1,"EliminateSerialization":2,"OptimizeJsonExprs":2,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":1,"EliminateLimits":2,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":2,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":1,"CTESubstitution":1,"RemoveRedundantAliases":2,"TypeCoercion$ImplicitTypeCasts":1,"RewriteExceptAll":1,"UpdateAttributeNullability":3,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":2,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":1,"ReplaceExpressions":1,"ResolveInlineTables":1,"ResolveUnion":1,"OptimizeIn":2,"CollapseWindow":2,"TypeCoercion$IfCoercion":1,"ResolveSessionCatalog":1,"PartitionPruning":1,"BooleanSimplification":2,"TypeCoercion$PromoteStrings":1,"Analyzer$ResolveAliases":1,"DecimalAggregates":1,"PruneFilters":3,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":1,"TransposeWindow":2,"Analyzer$ResolveRelations":1,"EliminateUnions":1,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":2,"SimplifyCaseConversionExpressions":2,"ResolvePartitionSpec":1,"Analyzer$ResolveNaturalAndUsingJoin":1,"UnwrapCastInBinaryComparison":2,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":1,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":1,"FallBackFileSourceV2":1,"Analyzer$ResolveTables":1,"SubstituteUnresolvedOrdinals":1,"TypeCoercion$CaseWhenCoercion":1,"DecimalPrecision":1,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":2,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":1,"Analyzer$ResolveAggAliasInGroupBy":1,"TypeCoercion$StringLiteralCoercion":1,"FoldablePropagation":2,"ResolveHiveSerdeTable":1,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":1,"Analyzer$PullOutNondeterministic":1,"Analyzer$ResolveFunctions":1,"ReplaceNullWithFalseInPredicate":2,"ResolveHigherOrderFunctions":1,"Analyzer$ResolvePivot":1,"CollapseProject":3,"Analyzer$ResolveNewInstance":1,"ColumnPruning":4,"Analyzer$ResolveWindowOrder":1,"TypeCoercion$ConcatCoercion":1,"PushDownPredicates":5,"TimeWindowing":1,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"TypeCoercion$Division":1,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":1,"TypeCoercion$EltCoercion":1,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":2,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":1,"ResolveSQLOnFile":1,"Analyzer$ResolveSubquery":1,"CombineConcats":2,"Analyzer$ResolveGroupingAnalytics":1,"Analyzer$ResolveBinaryArithmetic":1,"RemoveDispensableExpressions":2,"Analyzer$ResolveAlterTableChanges":1,"ResolveEncodersInScalaAgg":1,"TypeCoercion$IntegralDivision":1,"Analyzer$ResolveWindowFrame":1,"Analyzer$ResolveDeserializer":1,"RewriteDistinctAggregates":1,"RemoveNoopOperators":4,"Analyzer$ResolveAggregateFunctions":1,"NormalizeFloatingNumbers":1,"ReorderJoin":2,"Analyzer$ResolveUpCast":1,"Analyzer$ResolveGenerate":1,"TypeCoercion$WidenSetOperationTypes":1,"EliminateOuterJoin":2,"SimplifyExtractValueOps":2,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":1,"ReplaceExceptWithFilter":1,"CleanupAliases":1,"SchemaPruning":1,"ResolveHints$DisableHints":1,"Analyzer$ResolveOutputRelation":1,"BloomFilterJoinRule":1,"HiveAnalysis":1,"Analyzer$ResolveRandomSeed":1,"TypeCoercion$WindowFrameCoercion":1,"ConstantFolding":2,"TypeCoercion$DateTimeOperations":1,"ResolveNoopDropTable":1,"TypeCoercion$InConversion":1,"FindDataSourceTable":1,"ApplyCharTypePadding":1,"SimplifyConditionals":2,"DataSourceAnalysis":1,"TypeCoercion$FunctionArgumentConversion":1,"Analyzer$GlobalAggregates":1,"Analyzer$LookupFunctions":1,"CombineFilters":3,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":1},"numEffectiveRunsPerRule":{},"timeEffectiveRunsPerRule":{},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":11,"time":1691341189455}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":12,"description":"showString at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nGlobalLimit 21\n+- LocalLimit 21\n   +- Project [cast(year#229 as string) AS year#304, cast(title#230 as string) AS title#305, cast(rating#232 as string) AS rating#306, cast(actors_0#237 as string) AS actors_0#307, cast(actors_1#238 as string) AS actors_1#308, cast(actors_2#239 as string) AS actors_2#309]\n      +- Sort [year#229 ASC NULLS FIRST], true\n         +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n            +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n               +- SubqueryAlias movies_view\n                  +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n                     +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Analyzed Logical Plan ==\nyear: string, title: string, rating: string, actors_0: string, actors_1: string, actors_2: string\nGlobalLimit 21\n+- LocalLimit 21\n   +- Project [cast(year#229 as string) AS year#304, cast(title#230 as string) AS title#305, cast(rating#232 as string) AS rating#306, cast(actors_0#237 as string) AS actors_0#307, cast(actors_1#238 as string) AS actors_1#308, cast(actors_2#239 as string) AS actors_2#309]\n      +- Sort [year#229 ASC NULLS FIRST], true\n         +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n            +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n               +- SubqueryAlias movies_view\n                  +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n                     +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Optimized Logical Plan ==\nGlobalLimit 21\n+- LocalLimit 21\n   +- Project [cast(year#229 as string) AS year#304, title#230, cast(rating#232 as string) AS rating#306, actors_0#237, actors_1#238, actors_2#239]\n      +- Sort [year#229 ASC NULLS FIRST], true\n         +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n            +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n               +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Physical Plan ==\nTakeOrderedAndProject(limit=21, orderBy=[year#229 ASC NULLS FIRST], output=[year#304,title#230,rating#306,actors_0#237,actors_1#238,actors_2#239])\n+- *(1) Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n   +- FileScan csv [year#229,title#230,rating#232,actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<year:int,title:string,rating:double,actors_0:string,actors_1:string,actors_2:string>\n","sparkPlanInfo":{"nodeName":"TakeOrderedAndProject","simpleString":"TakeOrderedAndProject(limit=21, orderBy=[year#229 ASC NULLS FIRST], output=[year#304,title#230,rating#306,actors_0#237,actors_1#238,actors_2#239])","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"Filter","simpleString":"Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [year#229,title#230,rating#232,actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<year:int,title:string,rating:double,actors_0:string,actors_1:string,actors_2:string>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv]","ReadSchema":"struct<year:int,title:string,rating:double,actors_0:string,actors_1:string,actors_2:string>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Foster))]","DataFilters":"[(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))]"},"metrics":[{"name":"number of output rows","accumulatorId":698,"metricType":"sum"},{"name":"number of files read","accumulatorId":699,"metricType":"sum"},{"name":"metadata time","accumulatorId":700,"metricType":"timing"},{"name":"size of files read","accumulatorId":701,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":697,"metricType":"sum"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":696,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":694,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":695,"metricType":"nsTiming"},{"name":"records read","accumulatorId":692,"metricType":"sum"},{"name":"local bytes read","accumulatorId":690,"metricType":"size"},{"name":"fetch wait time","accumulatorId":691,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":688,"metricType":"size"},{"name":"local blocks read","accumulatorId":687,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":686,"metricType":"sum"},{"name":"remote bytes read to disk","accumulatorId":689,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":693,"metricType":"size"}]},"time":1691341220277}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":12,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":12,"accumUpdates":[[699,1],[700,0],[701,497937]]}
{"Event":"SparkListenerJobStart","Job ID":15,"Submission Time":1691341220359,"Stage Infos":[{"Stage ID":18,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":76,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"167\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[75],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":73,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"165\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[72],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":75,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"166\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[74],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":74,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"162\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[73],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":72,"Name":"FileScanRDD","Scope":"{\"id\":\"165\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[18],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.rdd.scope":"{\"id\":\"167\",\"name\":\"takeOrdered\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"12","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":18,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":76,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"167\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[75],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":73,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"165\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[72],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":75,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"166\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[74],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":74,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"162\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[73],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":72,"Name":"FileScanRDD","Scope":"{\"id\":\"165\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341220362,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.rdd.scope":"{\"id\":\"167\",\"name\":\"takeOrdered\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"12","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":18,"Stage Attempt ID":0,"Task Info":{"Task ID":16,"Index":0,"Attempt":0,"Launch Time":1691341220372,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":18,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":16,"Index":0,"Attempt":0,"Launch Time":1691341220372,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691341221139,"Failed":false,"Killed":false,"Accumulables":[{"ID":696,"Name":"duration","Update":"1098","Value":"1098","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":697,"Name":"number of output rows","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":698,"Name":"number of output rows","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":702,"Name":"internal.metrics.executorDeserializeTime","Update":152,"Value":152,"Internal":true,"Count Failed Values":true},{"ID":703,"Name":"internal.metrics.executorDeserializeCpuTime","Update":88494804,"Value":88494804,"Internal":true,"Count Failed Values":true},{"ID":704,"Name":"internal.metrics.executorRunTime","Update":585,"Value":585,"Internal":true,"Count Failed Values":true},{"ID":705,"Name":"internal.metrics.executorCpuTime","Update":368258729,"Value":368258729,"Internal":true,"Count Failed Values":true},{"ID":706,"Name":"internal.metrics.resultSize","Update":6168,"Value":6168,"Internal":true,"Count Failed Values":true},{"ID":707,"Name":"internal.metrics.jvmGCTime","Update":37,"Value":37,"Internal":true,"Count Failed Values":true},{"ID":708,"Name":"internal.metrics.resultSerializationTime","Update":9,"Value":9,"Internal":true,"Count Failed Values":true},{"ID":723,"Name":"internal.metrics.input.bytesRead","Update":497937,"Value":497937,"Internal":true,"Count Failed Values":true},{"ID":724,"Name":"internal.metrics.input.recordsRead","Update":16,"Value":16,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":152,"Executor Deserialize CPU Time":88494804,"Executor Run Time":585,"Executor CPU Time":368258729,"Peak Execution Memory":0,"Result Size":6168,"JVM GC Time":37,"Result Serialization Time":9,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":497937,"Records Read":16},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":18,"Stage Attempt ID":0,"Stage Name":"showString at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":76,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"167\",\"name\":\"takeOrdered\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[75],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":73,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"165\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[72],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":75,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"166\",\"name\":\"map\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[74],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":74,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"162\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[73],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":72,"Name":"FileScanRDD","Scope":"{\"id\":\"165\",\"name\":\"Scan csv \"}","Callsite":"showString at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.showString(Dataset.scala:339)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341220362,"Completion Time":1691341221140,"Accumulables":[{"ID":696,"Name":"duration","Value":"1098","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":697,"Name":"number of output rows","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":698,"Name":"number of output rows","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":702,"Name":"internal.metrics.executorDeserializeTime","Value":152,"Internal":true,"Count Failed Values":true},{"ID":703,"Name":"internal.metrics.executorDeserializeCpuTime","Value":88494804,"Internal":true,"Count Failed Values":true},{"ID":704,"Name":"internal.metrics.executorRunTime","Value":585,"Internal":true,"Count Failed Values":true},{"ID":705,"Name":"internal.metrics.executorCpuTime","Value":368258729,"Internal":true,"Count Failed Values":true},{"ID":706,"Name":"internal.metrics.resultSize","Value":6168,"Internal":true,"Count Failed Values":true},{"ID":707,"Name":"internal.metrics.jvmGCTime","Value":37,"Internal":true,"Count Failed Values":true},{"ID":708,"Name":"internal.metrics.resultSerializationTime","Value":9,"Internal":true,"Count Failed Values":true},{"ID":723,"Name":"internal.metrics.input.bytesRead","Value":497937,"Internal":true,"Count Failed Values":true},{"ID":724,"Name":"internal.metrics.input.recordsRead","Value":16,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":15,"Completion Time":1691341221142,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":12,"timePerRule":{"PruneFileSourcePartitions":322478,"ReassignLambdaVariableID":144567,"PushPredicateThroughNonJoin":30367,"Analyzer$ResolveEncodersInUDF":39157,"Analyzer$HandleNullInputsForUDF":45538,"OptimizeUpdateFields":243416,"Analyzer$ResolveSubqueryColumnAliases":14882,"ResolveTimeZone":51147,"Analyzer$ResolveNamespace":16716,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":20388,"RelationConversions":11372,"RewriteCorrelatedScalarSubquery":488820,"RemoveLiteralFromGroupExpressions":20114,"PushProjectionThroughUnion":63135,"EliminateSubqueryAliases":194902,"ResolveCatalogs":22633,"PushLeftSemiLeftAntiThroughJoin":47791,"Analyzer$ResolveUserSpecifiedColumns":14120,"FlattenScalarSubqueriesWithAggregates":114492,"LikeSimplification":156873,"CollapseRepartition":95720,"ResolveHints$ResolveCoalesceHints":12427,"Analyzer$ExtractGenerator":113135,"RewriteIntersectAll":21502,"Analyzer$AddMetadataColumns":102252,"ResolveHints$ResolveJoinStrategyHints":15367,"TypeCoercion$MapZipWithCoercion":200967,"NullPropagation":295623,"EliminateAggregateFilter":14348,"PullupCorrelatedPredicates":93477,"UpdateOuterReferences":16611,"ExtractPythonUDFs":883215,"Analyzer$WindowsSubstitution":13897,"CombineUnions":69459,"ExtractGroupingPythonUDFFromAggregate":15661,"ReorderAssociativeOperator":234610,"CleanupDynamicPruningFilters":204172,"ResolveHints$RemoveAllHints":10519,"SimplifyBinaryComparison":201368,"ResolveTableValuedFunctions":16861,"EliminateSerialization":62066,"OptimizeJsonExprs":308532,"GetCurrentDatabaseAndCatalog":198855,"TypeCoercion$BooleanEquality":79655,"package$ExpressionCanonicalizer$CleanExpressions":146670,"EliminateLimits":83674,"ReplaceIntersectWithSemiJoin":20244,"ConstantPropagation":95742,"PushExtraPredicateThroughJoin":20405,"CostBasedJoinReorder":18082,"Analyzer$ResolveReferences":176777,"CTESubstitution":603723,"RemoveRedundantAliases":738519,"TypeCoercion$ImplicitTypeCasts":140166,"RewriteExceptAll":23775,"UpdateAttributeNullability":1577876,"PropagateEmptyRelation":70713,"InferFiltersFromGenerate":22499,"SimplifyCasts":346799,"EliminateMapObjects":68324,"DetectAmbiguousSelfJoin":83383,"ReplaceExpressions":96767,"ResolveInlineTables":18341,"ResolveUnion":23963,"OptimizeIn":152912,"CollapseWindow":54998,"TypeCoercion$IfCoercion":92950,"ResolveSessionCatalog":34397,"PartitionPruning":42261,"BooleanSimplification":1308558,"TypeCoercion$PromoteStrings":99384,"Analyzer$ResolveAliases":31284,"DecimalAggregates":70833,"PruneFilters":455377,"PruneHiveTablePartitions":156358,"Analyzer$ResolveMissingReferences":13449,"TransposeWindow":45940,"Analyzer$ResolveRelations":33058,"EliminateUnions":16337,"RewritePredicateSubquery":77842,"ObjectSerializerPruning":16522,"LimitPushDown":49791,"SimplifyCaseConversionExpressions":162632,"ResolvePartitionSpec":16114,"Analyzer$ResolveNaturalAndUsingJoin":23375,"UnwrapCastInBinaryComparison":268101,"EliminateView":36552,"CombineTypedFilters":17078,"ReplaceUpdateFieldsExpression":72459,"OptimizeLimitZero":30165,"CheckCartesianProducts":31513,"ExtractPythonUDFFromAggregate":18331,"Analyzer$ExtractWindowExpressions":22886,"ReplaceExceptWithAntiJoin":20113,"ResolveLambdaVariables":40311,"FallBackFileSourceV2":12942,"Analyzer$ResolveTables":26443,"SubstituteUnresolvedOrdinals":11712,"TypeCoercion$CaseWhenCoercion":68544,"DecimalPrecision":157303,"EliminateSorts":64450,"PushDownLeftSemiAntiJoin":123908,"ExtractPythonUDFFromJoinCondition":23088,"TypeCoercion$StackCoercion":130707,"Analyzer$ResolveAggAliasInGroupBy":14117,"TypeCoercion$StringLiteralCoercion":64810,"FoldablePropagation":644640,"ResolveHiveSerdeTable":18184,"V2ScanRelationPushDown":298320,"EliminateDistinct":9843,"InferFiltersFromConstraints":865595,"DetermineTableStats":13877,"Analyzer$PullOutNondeterministic":73265,"Analyzer$ResolveFunctions":95615,"ReplaceNullWithFalseInPredicate":222864,"ResolveHigherOrderFunctions":51897,"Analyzer$ResolvePivot":16125,"CollapseProject":377772,"Analyzer$ResolveNewInstance":53540,"ColumnPruning":5038192,"Analyzer$ResolveWindowOrder":52808,"TypeCoercion$ConcatCoercion":110193,"PushDownPredicates":649834,"TimeWindowing":92353,"Optimizer$OptimizeSubqueries":168583,"RewriteNonCorrelatedExists":77343,"TypeCoercion$Division":91244,"ComputeCurrentTime":154402,"ResolveCreateNamedStruct":61145,"TypeCoercion$EltCoercion":86689,"ConvertToLocalRelation":58731,"OptimizeWindowFunctions":175072,"RemoveRepetitionFromGroupExpressions":18328,"ReplaceDistinctWithAggregate":19697,"PreprocessTableCreation":12047,"ResolveSQLOnFile":13871,"Analyzer$ResolveSubquery":54952,"CombineConcats":12073,"Analyzer$ResolveGroupingAnalytics":25867,"Analyzer$ResolveBinaryArithmetic":78136,"RemoveDispensableExpressions":145792,"Analyzer$ResolveAlterTableChanges":12831,"ResolveEncodersInScalaAgg":64829,"TypeCoercion$IntegralDivision":144018,"Analyzer$ResolveWindowFrame":65780,"Analyzer$ResolveDeserializer":501193,"RewriteDistinctAggregates":19817,"RemoveNoopOperators":177111,"Analyzer$ResolveAggregateFunctions":16173,"NormalizeFloatingNumbers":19397,"ReorderJoin":57988,"Analyzer$ResolveUpCast":19032,"Analyzer$ResolveGenerate":16464,"TypeCoercion$WidenSetOperationTypes":196596,"EliminateOuterJoin":46739,"SimplifyExtractValueOps":189740,"OptimizeMetadataOnlyQuery":13951,"EliminateResolvedHint":67431,"Analyzer$ResolveInsertInto":14281,"ReplaceExceptWithFilter":40450,"CleanupAliases":26196,"SchemaPruning":226375,"ResolveHints$DisableHints":24341,"Analyzer$ResolveOutputRelation":16768,"BloomFilterJoinRule":35034,"HiveAnalysis":10609,"Analyzer$ResolveRandomSeed":16647,"TypeCoercion$WindowFrameCoercion":67076,"ConstantFolding":198074,"TypeCoercion$DateTimeOperations":148359,"ResolveNoopDropTable":11998,"TypeCoercion$InConversion":75884,"FindDataSourceTable":16263,"ApplyCharTypePadding":47900,"SimplifyConditionals":254526,"DataSourceAnalysis":11451,"TypeCoercion$FunctionArgumentConversion":136090,"Analyzer$GlobalAggregates":15162,"Analyzer$LookupFunctions":56138,"CombineFilters":54528,"ReplaceDeduplicateWithAggregate":124564,"PreprocessTableInsertion":10205},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":2,"Analyzer$HandleNullInputsForUDF":2,"OptimizeUpdateFields":5,"Analyzer$ResolveSubqueryColumnAliases":3,"ResolveTimeZone":3,"Analyzer$ResolveNamespace":3,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":3,"RelationConversions":2,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":3,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":3,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":2,"Analyzer$ExtractGenerator":3,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":3,"ResolveHints$ResolveJoinStrategyHints":2,"TypeCoercion$MapZipWithCoercion":3,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":2,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":2,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":2,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":3,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":3,"package$ExpressionCanonicalizer$CleanExpressions":11,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":3,"CTESubstitution":2,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":3,"RewriteExceptAll":1,"UpdateAttributeNullability":4,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":2,"ReplaceExpressions":1,"ResolveInlineTables":3,"ResolveUnion":3,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":3,"ResolveSessionCatalog":3,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":3,"Analyzer$ResolveAliases":3,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":3,"TransposeWindow":3,"Analyzer$ResolveRelations":3,"EliminateUnions":2,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":3,"Analyzer$ResolveNaturalAndUsingJoin":3,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":3,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":3,"FallBackFileSourceV2":3,"Analyzer$ResolveTables":3,"SubstituteUnresolvedOrdinals":2,"TypeCoercion$CaseWhenCoercion":3,"DecimalPrecision":3,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":3,"Analyzer$ResolveAggAliasInGroupBy":3,"TypeCoercion$StringLiteralCoercion":3,"FoldablePropagation":3,"ResolveHiveSerdeTable":3,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":2,"Analyzer$PullOutNondeterministic":2,"Analyzer$ResolveFunctions":3,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":3,"Analyzer$ResolvePivot":3,"CollapseProject":4,"Analyzer$ResolveNewInstance":3,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":3,"TypeCoercion$ConcatCoercion":3,"PushDownPredicates":6,"TimeWindowing":3,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"TypeCoercion$Division":3,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":3,"TypeCoercion$EltCoercion":3,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":2,"ResolveSQLOnFile":3,"Analyzer$ResolveSubquery":3,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":3,"Analyzer$ResolveBinaryArithmetic":3,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":2,"ResolveEncodersInScalaAgg":3,"TypeCoercion$IntegralDivision":3,"Analyzer$ResolveWindowFrame":3,"Analyzer$ResolveDeserializer":3,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":3,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":3,"Analyzer$ResolveGenerate":3,"TypeCoercion$WidenSetOperationTypes":3,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":3,"ReplaceExceptWithFilter":1,"CleanupAliases":2,"SchemaPruning":1,"ResolveHints$DisableHints":2,"Analyzer$ResolveOutputRelation":3,"BloomFilterJoinRule":1,"HiveAnalysis":2,"Analyzer$ResolveRandomSeed":3,"TypeCoercion$WindowFrameCoercion":3,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":3,"ResolveNoopDropTable":2,"TypeCoercion$InConversion":3,"FindDataSourceTable":3,"ApplyCharTypePadding":2,"SimplifyConditionals":3,"DataSourceAnalysis":2,"TypeCoercion$FunctionArgumentConversion":3,"Analyzer$GlobalAggregates":3,"Analyzer$LookupFunctions":2,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":2},"numEffectiveRunsPerRule":{"EliminateSubqueryAliases":1,"package$ExpressionCanonicalizer$CleanExpressions":2,"RemoveRedundantAliases":1,"SimplifyCasts":1,"CollapseProject":1,"PushDownPredicates":1,"Analyzer$ResolveDeserializer":1},"timeEffectiveRunsPerRule":{"EliminateSubqueryAliases":194902,"package$ExpressionCanonicalizer$CleanExpressions":28036,"RemoveRedundantAliases":355342,"SimplifyCasts":251239,"CollapseProject":247346,"PushDownPredicates":522987,"Analyzer$ResolveDeserializer":486686},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":12,"time":1691341221182}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionStart","executionId":13,"description":"count at NativeMethodAccessorImpl.java:0","details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","physicalPlanDescription":"== Parsed Logical Plan ==\nAggregate [count(1) AS count#336L]\n+- Sort [year#229 ASC NULLS FIRST], true\n   +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n      +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n         +- SubqueryAlias movies_view\n            +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n               +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Analyzed Logical Plan ==\ncount: bigint\nAggregate [count(1) AS count#336L]\n+- Sort [year#229 ASC NULLS FIRST], true\n   +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n      +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n         +- SubqueryAlias movies_view\n            +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n               +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Optimized Logical Plan ==\nAggregate [count(1) AS count#336L]\n+- Project\n   +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n      +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=false\n+- HashAggregate(keys=[], functions=[count(1)], output=[count#336L])\n   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#228]\n      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#339L])\n         +- Project\n            +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n               +- FileScan csv [actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[count(1)])","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#228]","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_count(1)])","children":[{"nodeName":"Project","simpleString":"Project","children":[{"nodeName":"Filter","simpleString":"Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv]","ReadSchema":"struct<actors_0:string,actors_1:string,actors_2:string>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Foster))]","DataFilters":"[(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))]"},"metrics":[{"name":"number of output rows","accumulatorId":760,"metricType":"sum"},{"name":"number of files read","accumulatorId":761,"metricType":"sum"},{"name":"metadata time","accumulatorId":762,"metricType":"timing"},{"name":"size of files read","accumulatorId":763,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":759,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":756,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":757,"metricType":"timing"},{"name":"peak memory","accumulatorId":755,"metricType":"size"},{"name":"number of output rows","accumulatorId":754,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":758,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":736,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":737,"metricType":"nsTiming"},{"name":"records read","accumulatorId":734,"metricType":"sum"},{"name":"local bytes read","accumulatorId":732,"metricType":"size"},{"name":"fetch wait time","accumulatorId":733,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":730,"metricType":"size"},{"name":"local blocks read","accumulatorId":729,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":728,"metricType":"sum"},{"name":"data size","accumulatorId":727,"metricType":"size"},{"name":"remote bytes read to disk","accumulatorId":731,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":735,"metricType":"size"}]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":751,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":752,"metricType":"timing"},{"name":"peak memory","accumulatorId":750,"metricType":"size"},{"name":"number of output rows","accumulatorId":749,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":753,"metricType":"average"}]}],"metadata":{},"metrics":[]},"time":1691341230978}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerEffectiveSQLConf","executionId":13,"effectiveSQLConf":{"spark.sql.adaptive.coalescePartitions.initialPartitionNum":"<undefined>","spark.sql.streaming.disabledV2Writers":"","spark.sql.streaming.noDataMicroBatches.enabled":"true","spark.sql.maxMetadataStringLength":"100","spark.sql.files.maxPartitionBytes":"128MB","spark.sql.thriftserver.ui.retainedStatements":"200","spark.sql.hive.metastore.barrierPrefixes":"","spark.sql.ui.retainedExecutions":"1000","spark.sql.execution.arrow.pyspark.fallback.enabled":"<value of spark.sql.execution.arrow.fallback.enabled>","spark.sql.json.filterPushdown.enabled":"true","spark.sql.sources.parallelPartitionDiscovery.threshold":"32","spark.sql.cbo.joinReorder.enabled":"false","spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.int96AsTimestamp":"true","spark.sql.adaptive.optimizer.excludedRules":"<undefined>","spark.sql.files.minPartitionNum":"<undefined>","spark.sql.thriftserver.ui.retainedSessions":"200","spark.sql.hive.convertMetastoreParquet":"true","spark.sql.hive.verifyPartitionPath":"false","spark.sql.autoBroadcastJoinThreshold":"10MB","spark.sql.orc.mergeSchema":"false","spark.sql.adaptive.enabled":"true","spark.sql.adaptive.skewJoin.enabled":"true","spark.sql.optimizer.sizeBasedJoinReorder.enabled":"true","spark.sql.avro.filterPushdown.enabled":"true","spark.sql.streaming.ui.retainedQueries":"100","spark.sql.orc.enableVectorizedReader":"true","spark.sql.streaming.continuous.epochBacklogQueueSize":"10000","spark.sql.parquet.binaryAsString":"false","spark.sql.pivotMaxValues":"10000","spark.sql.adaptive.localShuffleReader.enabled":"true","spark.sql.storeAssignmentPolicy":"ANSI","spark.sql.redaction.options.regex":"(?i)url","spark.sql.cbo.joinReorder.dp.star.filter":"false","spark.sql.parser.quotedRegexColumnNames":"false","spark.sql.files.ignoreMissingFiles":"false","spark.sql.streaming.ui.enabled":"true","spark.sql.execution.arrow.sparkr.enabled":"false","spark.sql.orc.filterPushdown":"true","spark.sql.thriftserver.scheduler.pool":"<undefined>","spark.sql.catalog.spark_catalog":"<undefined>","spark.sql.thriftServer.queryTimeout":"0ms","spark.sql.datetime.java8API.enabled":"false","spark.sql.execution.pandas.udf.buffer.size":"<value of spark.buffer.size>","spark.sql.function.eltOutputAsString":"false","spark.sql.hive.version":"<value of spark.sql.hive.metastore.version>","spark.sql.cbo.joinReorder.dp.threshold":"12","spark.sql.statsImprovements.enabled":"true","spark.sql.cache.serializer":"org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer","spark.sql.streaming.stateStore.stateSchemaCheck":"true","spark.sql.parquet.columnarReaderBatchSize":"4096","spark.sql.parquet.outputTimestampType":"INT96","spark.sql.hive.metastore.jars":"builtin","spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB","spark.sql.hive.convertMetastoreParquet.mergeSchema":"false","spark.sql.statistics.size.autoUpdate.enabled":"false","spark.sql.hive.filesourcePartitionFileCacheSize":"262144000","spark.sql.streaming.ui.retainedProgressUpdates":"100","spark.sql.inMemoryColumnarStorage.compressed":"true","spark.sql.pyspark.jvmStacktrace.enabled":"false","spark.sql.cbo.starSchemaDetection":"false","spark.sql.columnNameOfCorruptRecord":"_corrupt_record","spark.sql.hive.convertMetastore.partitionOverwriteMode":"DYNAMIC","spark.sql.adaptive.advisoryPartitionSizeInBytes":"<value of spark.sql.adaptive.shuffle.targetPostShuffleInputSize>","spark.sql.avro.compression.codec":"snappy","spark.sql.streaming.metricsEnabled":"false","spark.sql.ui.pruneCachedInMemoryRelation":"true","spark.sql.event.truncate.length":"2147483647","spark.sql.groupByAliases":"true","spark.sql.hive.metastorePartitionPruning":"true","spark.sql.execution.arrow.enabled":"false","spark.sql.optimizer.dynamicPartitionPruning.enabled":"true","spark.sql.extendedEventInfo":"true","spark.sql.sources.bucketing.maxBuckets":"100000","spark.sql.streaming.multipleWatermarkPolicy":"min","spark.sql.hive.metastore.jars.path":"","spark.sql.jsonGenerator.ignoreNullFields":"true","spark.sql.optimizer.flattenScalarSubqueriesWithAggregates.enabled":"true","spark.sql.debug.maxToStringFields":"25","spark.sql.files.maxRecordsPerFile":"0","spark.sql.hive.thriftServer.singleSession":"false","spark.sql.hive.thriftServer.async":"true","spark.sql.parquet.mergeSchema":"false","spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5","spark.sql.queryExecutionListeners":"<undefined>","spark.sql.streaming.numRecentProgressUpdates":"100","spark.sql.variable.substitute":"true","spark.sql.adaptive.shuffle.mapOutputStats.useDataSize":"true","spark.sql.function.concatBinaryAsString":"false","spark.sql.avro.deflate.level":"-1","spark.sql.repl.eagerEval.maxNumRows":"20","spark.sql.ansi.enabled":"false","spark.sql.legacy.allowHashOnMapType":"false","spark.sql.hive.convertInsertingPartitionedTable":"true","spark.sql.sources.bucketing.autoBucketedScan.enabled":"true","spark.sql.bloomFilterJoin.maxFilterBytes":"2097152","spark.sql.orderByOrdinal":"true","spark.sql.streaming.stopTimeout":"0","spark.sql.adaptive.coalescePartitions.enabled":"true","spark.sql.session.timeZone":"UTC","spark.sql.parquet.respectSummaryFiles":"false","spark.sql.parquet.enableVectorizedReader":"true","spark.sql.cbo.enabled":"false","spark.sql.sources.bucketing.enabled":"true","spark.sql.csv.filterPushdown.enabled":"true","spark.sql.repl.eagerEval.truncate":"20","spark.sql.cbo.planStats.enabled":"false","spark.sql.hive.convertMetastoreCtas":"true","spark.sql.ui.explainMode":"extended","spark.sql.optimizer.excludedRules":"<undefined>","spark.sql.sources.partitionColumnTypeInference.enabled":"true","spark.sql.sortMergeJoinExec.extendedCodegen.enabled":"true","spark.sql.hive.convertMetastoreOrc":"true","spark.sql.execution.arrow.fallback.enabled":"true","spark.sql.streaming.forceDeleteTempCheckpointLocation":"false","spark.sql.maxPlanStringLength":"2147483632","spark.sql.hive.manageFilesourcePartitions":"true","spark.sql.parquet.int96TimestampConversion":"false","spark.sql.sources.partitionOverwriteMode":"STATIC","spark.sql.streaming.checkpointLocation":"<undefined>","spark.sql.broadcastTimeout":"300","spark.sql.execution.arrow.pyspark.enabled":"<value of spark.sql.execution.arrow.enabled>","spark.sql.metadataCacheTTLSeconds":"-1000ms","spark.sql.repl.eagerEval.enabled":"false","spark.sql.mapKeyDedupPolicy":"EXCEPTION","spark.sql.parquet.filterPushdown":"true","spark.sql.bucketing.coalesceBucketsInJoin.enabled":"false","spark.sql.maven.additionalRemoteRepositories":"https://maven-central.storage-download.googleapis.com/maven2/","spark.sql.orc.compression.codec":"snappy","spark.sql.statistics.histogram.enabled":"false","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.sql.streaming.stopActiveRunOnRestart":"true","spark.sql.orc.columnarReaderBatchSize":"4096","spark.sql.optimizer.enableJsonExpressionOptimization":"true","spark.sql.redaction.string.regex":"<value of spark.redaction.string.regex>","spark.sql.inMemoryColumnarStorage.batchSize":"10000","spark.sql.parquet.writeLegacyFormat":"false","spark.sql.statistics.fallBackToHdfs":"false","spark.sql.defaultCatalog":"spark_catalog","spark.sql.streaming.fileSource.cleaner.numThreads":"1","spark.sql.legacy.sessionInitWithConfigDefaults":"false","spark.sql.adaptive.coalescePartitions.minPartitionNum":"<undefined>","spark.sql.bucketing.coalesceBucketsInJoin.maxBucketRatio":"4","spark.sql.execution.arrow.maxRecordsPerBatch":"10000","spark.sql.stringHashComputationWithoutCopyMemory.enabled":"true","spark.sql.streaming.streamingQueryListeners":"<undefined>","spark.sql.execution.pyspark.udf.simplifiedTraceback.enabled":"false","spark.sql.files.ignoreCorruptFiles":"false","spark.sql.inMemoryColumnarStorage.enableVectorizedReader":"true","spark.sql.extensions":"<undefined>","spark.sql.sources.default":"parquet","spark.sql.ui.extendedInfo":"true","spark.sql.bloomFilterJoin.enabled":"true","spark.sql.parquet.compression.codec":"snappy","spark.sql.optimizer.distinctBeforeIntersect.enabled":"true","spark.sql.parquet.recordLevelFilter.enabled":"false","spark.sql.shuffle.partitions":"200","spark.sql.groupByOrdinal":"true","spark.sql.hive.metastore.version":"2.3.7-amzn-4"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":13,"physicalPlanDescription":"== Parsed Logical Plan ==\nAggregate [count(1) AS count#336L]\n+- Sort [year#229 ASC NULLS FIRST], true\n   +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n      +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n         +- SubqueryAlias movies_view\n            +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n               +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Analyzed Logical Plan ==\ncount: bigint\nAggregate [count(1) AS count#336L]\n+- Sort [year#229 ASC NULLS FIRST], true\n   +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n      +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n         +- SubqueryAlias movies_view\n            +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n               +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Optimized Logical Plan ==\nAggregate [count(1) AS count#336L]\n+- Project\n   +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n      +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=false\n+- == Current Plan ==\n   HashAggregate(keys=[], functions=[count(1)], output=[count#336L])\n   +- ShuffleQueryStage 0\n      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#243]\n         +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#339L])\n            +- *(1) Project\n               +- *(1) Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n                  +- FileScan csv [actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>\n+- == Initial Plan ==\n   HashAggregate(keys=[], functions=[count(1)], output=[count#336L])\n   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#228]\n      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#339L])\n         +- Project\n            +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n               +- FileScan csv [actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=false","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[count(1)])","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#243]","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_count(1)])","children":[{"nodeName":"Project","simpleString":"Project","children":[{"nodeName":"Filter","simpleString":"Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv]","ReadSchema":"struct<actors_0:string,actors_1:string,actors_2:string>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Foster))]","DataFilters":"[(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))]"},"metrics":[{"name":"number of output rows","accumulatorId":760,"metricType":"sum"},{"name":"number of files read","accumulatorId":761,"metricType":"sum"},{"name":"metadata time","accumulatorId":762,"metricType":"timing"},{"name":"size of files read","accumulatorId":763,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":786,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":783,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":784,"metricType":"timing"},{"name":"peak memory","accumulatorId":782,"metricType":"size"},{"name":"number of output rows","accumulatorId":781,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":785,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":780,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":773,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":774,"metricType":"nsTiming"},{"name":"records read","accumulatorId":771,"metricType":"sum"},{"name":"local bytes read","accumulatorId":769,"metricType":"size"},{"name":"fetch wait time","accumulatorId":770,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":767,"metricType":"size"},{"name":"local blocks read","accumulatorId":766,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":765,"metricType":"sum"},{"name":"data size","accumulatorId":764,"metricType":"size"},{"name":"remote bytes read to disk","accumulatorId":768,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":772,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":777,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":778,"metricType":"timing"},{"name":"peak memory","accumulatorId":776,"metricType":"size"},{"name":"number of output rows","accumulatorId":775,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":779,"metricType":"average"}]}],"metadata":{},"metrics":[]}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerDriverAccumUpdates","executionId":13,"accumUpdates":[[761,1],[762,0],[763,497937]]}
{"Event":"SparkListenerJobStart","Job ID":16,"Submission Time":1691341231036,"Stage Infos":[{"Stage ID":19,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":80,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"173\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[79],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":79,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"174\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[78],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":78,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"179\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[77],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":77,"Name":"FileScanRDD","Scope":"{\"id\":\"179\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[19],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.rdd.scope":"{\"id\":\"173\",\"name\":\"ShuffleQueryStage\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"13","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":19,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":80,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"173\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[79],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":79,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"174\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[78],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":78,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"179\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[77],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":77,"Name":"FileScanRDD","Scope":"{\"id\":\"179\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341231040,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.rdd.scope":"{\"id\":\"173\",\"name\":\"ShuffleQueryStage\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"13","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":19,"Stage Attempt ID":0,"Task Info":{"Task ID":17,"Index":0,"Attempt":0,"Launch Time":1691341231050,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":19,"Stage Attempt ID":0,"Task Type":"ShuffleMapTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":17,"Index":0,"Attempt":0,"Launch Time":1691341231050,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"RACK_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691341231620,"Failed":false,"Killed":false,"Accumulables":[{"ID":760,"Name":"number of output rows","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":764,"Name":"data size","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":772,"Name":"shuffle bytes written","Update":"59","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":773,"Name":"shuffle records written","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":774,"Name":"shuffle write time","Update":"16655438","Value":"16655438","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":780,"Name":"duration","Update":"348","Value":"348","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":781,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":784,"Name":"time in aggregation build","Update":"311","Value":"311","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":786,"Name":"number of output rows","Update":"16","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":787,"Name":"internal.metrics.executorDeserializeTime","Update":90,"Value":90,"Internal":true,"Count Failed Values":true},{"ID":788,"Name":"internal.metrics.executorDeserializeCpuTime","Update":51247093,"Value":51247093,"Internal":true,"Count Failed Values":true},{"ID":789,"Name":"internal.metrics.executorRunTime","Update":469,"Value":469,"Internal":true,"Count Failed Values":true},{"ID":790,"Name":"internal.metrics.executorCpuTime","Update":262638727,"Value":262638727,"Internal":true,"Count Failed Values":true},{"ID":791,"Name":"internal.metrics.resultSize","Update":2052,"Value":2052,"Internal":true,"Count Failed Values":true},{"ID":793,"Name":"internal.metrics.resultSerializationTime","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":805,"Name":"internal.metrics.shuffle.write.bytesWritten","Update":59,"Value":59,"Internal":true,"Count Failed Values":true},{"ID":806,"Name":"internal.metrics.shuffle.write.recordsWritten","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":807,"Name":"internal.metrics.shuffle.write.writeTime","Update":16655438,"Value":16655438,"Internal":true,"Count Failed Values":true},{"ID":808,"Name":"internal.metrics.input.bytesRead","Update":497937,"Value":497937,"Internal":true,"Count Failed Values":true},{"ID":809,"Name":"internal.metrics.input.recordsRead","Update":16,"Value":16,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":90,"Executor Deserialize CPU Time":51247093,"Executor Run Time":469,"Executor CPU Time":262638727,"Peak Execution Memory":0,"Result Size":2052,"JVM GC Time":0,"Result Serialization Time":1,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":0,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":0,"Total Records Read":0},"Shuffle Write Metrics":{"Shuffle Bytes Written":59,"Shuffle Write Time":16655438,"Shuffle Records Written":1},"Input Metrics":{"Bytes Read":497937,"Records Read":16},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":19,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":80,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"173\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[79],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":79,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"174\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[78],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":78,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"179\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[77],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":77,"Name":"FileScanRDD","Scope":"{\"id\":\"179\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341231040,"Completion Time":1691341231621,"Accumulables":[{"ID":760,"Name":"number of output rows","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":764,"Name":"data size","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":772,"Name":"shuffle bytes written","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":773,"Name":"shuffle records written","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":774,"Name":"shuffle write time","Value":"16655438","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":780,"Name":"duration","Value":"348","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":781,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":784,"Name":"time in aggregation build","Value":"311","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":786,"Name":"number of output rows","Value":"16","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":787,"Name":"internal.metrics.executorDeserializeTime","Value":90,"Internal":true,"Count Failed Values":true},{"ID":788,"Name":"internal.metrics.executorDeserializeCpuTime","Value":51247093,"Internal":true,"Count Failed Values":true},{"ID":789,"Name":"internal.metrics.executorRunTime","Value":469,"Internal":true,"Count Failed Values":true},{"ID":790,"Name":"internal.metrics.executorCpuTime","Value":262638727,"Internal":true,"Count Failed Values":true},{"ID":791,"Name":"internal.metrics.resultSize","Value":2052,"Internal":true,"Count Failed Values":true},{"ID":793,"Name":"internal.metrics.resultSerializationTime","Value":1,"Internal":true,"Count Failed Values":true},{"ID":805,"Name":"internal.metrics.shuffle.write.bytesWritten","Value":59,"Internal":true,"Count Failed Values":true},{"ID":806,"Name":"internal.metrics.shuffle.write.recordsWritten","Value":1,"Internal":true,"Count Failed Values":true},{"ID":807,"Name":"internal.metrics.shuffle.write.writeTime","Value":16655438,"Internal":true,"Count Failed Values":true},{"ID":808,"Name":"internal.metrics.input.bytesRead","Value":497937,"Internal":true,"Count Failed Values":true},{"ID":809,"Name":"internal.metrics.input.recordsRead","Value":16,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":16,"Completion Time":1691341231622,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLAdaptiveExecutionUpdate","executionId":13,"physicalPlanDescription":"== Parsed Logical Plan ==\nAggregate [count(1) AS count#336L]\n+- Sort [year#229 ASC NULLS FIRST], true\n   +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n      +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n         +- SubqueryAlias movies_view\n            +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n               +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Analyzed Logical Plan ==\ncount: bigint\nAggregate [count(1) AS count#336L]\n+- Sort [year#229 ASC NULLS FIRST], true\n   +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n      +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n         +- SubqueryAlias movies_view\n            +- Project [year#229, title#230, rating#232, actors_0#237, actors_1#238, actors_2#239]\n               +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Optimized Logical Plan ==\nAggregate [count(1) AS count#336L]\n+- Project\n   +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n      +- Relation[year#229,title#230,directors_0#231,rating#232,genres_0#233,genres_1#234,rank#235,running_time_secs#236,actors_0#237,actors_1#238,actors_2#239,directors_1#240,directors_2#241] csv\n\n== Physical Plan ==\nAdaptiveSparkPlan isFinalPlan=true\n+- == Final Plan ==\n   *(2) HashAggregate(keys=[], functions=[count(1)], output=[count#336L])\n   +- ShuffleQueryStage 0\n      +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#243]\n         +- *(1) HashAggregate(keys=[], functions=[partial_count(1)], output=[count#339L])\n            +- *(1) Project\n               +- *(1) Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n                  +- FileScan csv [actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>\n+- == Initial Plan ==\n   HashAggregate(keys=[], functions=[count(1)], output=[count#336L])\n   +- Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#228]\n      +- HashAggregate(keys=[], functions=[partial_count(1)], output=[count#339L])\n         +- Project\n            +- Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))\n               +- FileScan csv [actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>\n","sparkPlanInfo":{"nodeName":"AdaptiveSparkPlan","simpleString":"AdaptiveSparkPlan isFinalPlan=true","children":[{"nodeName":"WholeStageCodegen (2)","simpleString":"WholeStageCodegen (2)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[count(1)])","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"ShuffleQueryStage","simpleString":"ShuffleQueryStage 0","children":[{"nodeName":"Exchange","simpleString":"Exchange SinglePartition, ENSURE_REQUIREMENTS, [id=#243]","children":[{"nodeName":"WholeStageCodegen (1)","simpleString":"WholeStageCodegen (1)","children":[{"nodeName":"HashAggregate","simpleString":"HashAggregate(keys=[], functions=[partial_count(1)])","children":[{"nodeName":"Project","simpleString":"Project","children":[{"nodeName":"Filter","simpleString":"Filter (((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))","children":[{"nodeName":"InputAdapter","simpleString":"InputAdapter","children":[{"nodeName":"Scan csv ","simpleString":"FileScan csv [actors_0#237,actors_1#238,actors_2#239] Batched: false, DataFilters: [(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foste..., Format: CSV, Location: InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv], PartitionFilters: [], PushedFilters: [Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Fost..., ReadSchema: struct<actors_0:string,actors_1:string,actors_2:string>","children":[],"metadata":{"Location":"InMemoryFileIndex[s3://challengebucket-us-west-2-165206281/data/movies.csv]","ReadSchema":"struct<actors_0:string,actors_1:string,actors_2:string>","Format":"CSV","Batched":"false","PartitionFilters":"[]","PushedFilters":"[Or(Or(EqualTo(actors_0,Jodie Foster),EqualTo(actors_1,Jodie Foster)),EqualTo(actors_2,Jodie Foster))]","DataFilters":"[(((actors_0#237 = Jodie Foster) OR (actors_1#238 = Jodie Foster)) OR (actors_2#239 = Jodie Foster))]"},"metrics":[{"name":"number of output rows","accumulatorId":760,"metricType":"sum"},{"name":"number of files read","accumulatorId":761,"metricType":"sum"},{"name":"metadata time","accumulatorId":762,"metricType":"timing"},{"name":"size of files read","accumulatorId":763,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"number of output rows","accumulatorId":786,"metricType":"sum"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":783,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":784,"metricType":"timing"},{"name":"peak memory","accumulatorId":782,"metricType":"size"},{"name":"number of output rows","accumulatorId":781,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":785,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":780,"metricType":"timing"}]}],"metadata":{},"metrics":[{"name":"shuffle records written","accumulatorId":773,"metricType":"sum"},{"name":"shuffle write time","accumulatorId":774,"metricType":"nsTiming"},{"name":"records read","accumulatorId":771,"metricType":"sum"},{"name":"local bytes read","accumulatorId":769,"metricType":"size"},{"name":"fetch wait time","accumulatorId":770,"metricType":"timing"},{"name":"remote bytes read","accumulatorId":767,"metricType":"size"},{"name":"local blocks read","accumulatorId":766,"metricType":"sum"},{"name":"remote blocks read","accumulatorId":765,"metricType":"sum"},{"name":"data size","accumulatorId":764,"metricType":"size"},{"name":"remote bytes read to disk","accumulatorId":768,"metricType":"size"},{"name":"shuffle bytes written","accumulatorId":772,"metricType":"size"}]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[]}],"metadata":{},"metrics":[{"name":"spill size","accumulatorId":815,"metricType":"size"},{"name":"time in aggregation build","accumulatorId":816,"metricType":"timing"},{"name":"peak memory","accumulatorId":814,"metricType":"size"},{"name":"number of output rows","accumulatorId":813,"metricType":"sum"},{"name":"avg hash probe bucket list iters","accumulatorId":817,"metricType":"average"}]}],"metadata":{},"metrics":[{"name":"duration","accumulatorId":812,"metricType":"timing"}]}],"metadata":{},"metrics":[]}}
{"Event":"SparkListenerJobStart","Job ID":17,"Submission Time":1691341231649,"Stage Infos":[{"Stage ID":20,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":80,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"173\",\"name\":\"ShuffleQueryStage\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[79],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":79,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"174\",\"name\":\"WholeStageCodegen (1)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[78],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":78,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"179\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[77],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":77,"Name":"FileScanRDD","Scope":"{\"id\":\"179\",\"name\":\"Scan csv \"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0},{"Stage ID":21,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":83,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"186\",\"name\":\"mapPartitionsInternal\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[82],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":82,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"181\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[81],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":81,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"185\",\"name\":\"Exchange\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[80],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[20],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Accumulables":[],"Resource Profile Id":0}],"Stage IDs":[20,21],"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.rdd.scope":"{\"id\":\"187\",\"name\":\"collect\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"13","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerStageSubmitted","Stage Info":{"Stage ID":21,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":83,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"186\",\"name\":\"mapPartitionsInternal\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[82],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":82,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"181\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[81],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":81,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"185\",\"name\":\"Exchange\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[80],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[20],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341231651,"Accumulables":[],"Resource Profile Id":0},"Properties":{"spark.sql.warehouse.dir":"hdfs:///user/spark/warehouse","spark.sql.parquet.fs.optimized.committer.optimization-enabled":"true","spark.driver.host":"ip-10-0-10-20.us-west-2.compute.internal","spark.serializer.objectStreamReset":"100","spark.history.fs.logDirectory":"hdfs:///var/log/spark/apps","spark.hadoop.mapreduce.fileoutputcommitter.algorithm.version.emr_internal_use_only.EmrFileSystem":"2","spark.eventLog.enabled":"true","resource.executor.cores":"4","spark.driver.port":"34023","spark.shuffle.service.enabled":"true","__fetch_continuous_blocks_in_batch_enabled":"true","spark.rdd.compress":"True","spark.driver.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.executorEnv.PYTHONPATH":"/usr/lib/spark/python/lib/py4j-0.10.9-src.zip:/usr/lib/spark/python/:<CPS>{{PWD}}/pyspark.zip<CPS>{{PWD}}/py4j-0.10.9-src.zip","spark.yarn.historyServer.address":"ip-10-0-10-20.us-west-2.compute.internal:18080","spark.stage.attempt.ignoreOnDecommissionFetchFailure":"true","spark.app.name":"movies","spark.rdd.scope":"{\"id\":\"187\",\"name\":\"collect\"}","spark.driver.memory":"2048M","spark.rdd.scope.noOverride":"true","spark.files.fetchFailure.unRegisterOutputOnHost":"true","spark.submit.pyFiles":"","spark.ui.showConsoleProgress":"true","spark.executor.defaultJavaOptions":"-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:OnOutOfMemoryError='kill -9 %p'","spark.resourceManager.cleanupExpiredHost":"true","spark.app.startTime":"1691340091107","spark.executor.id":"driver","spark.yarn.appMasterEnv.SPARK_PUBLIC_DNS":"$(hostname -f)","spark.sql.emr.internal.extensions":"com.amazonaws.emr.spark.EmrSparkSessionExtensions","spark.hadoop.fs.s3.getObject.initialSocketTimeoutMilliseconds":"2000","spark.submit.deployMode":"client","spark.master":"yarn","spark.sql.parquet.output.committer.class":"com.amazon.emr.committer.EmrOptimizedSparkSqlParquetOutputCommitter","spark.driver.defaultJavaOptions":"-XX:OnOutOfMemoryError='kill -9 %p'","spark.ui.filters":"org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter","spark.blacklist.decommissioning.timeout":"1h","spark.executor.extraLibraryPath":"/usr/lib/hadoop/lib/native:/usr/lib/hadoop-lzo/lib/native:/docker/usr/lib/hadoop/lib/native:/docker/usr/lib/hadoop-lzo/lib/native","spark.sql.hive.metastore.sharedPrefixes":"com.amazonaws.services.dynamodbv2","spark.executor.memory":"4269M","spark.driver.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.eventLog.dir":"hdfs:///var/log/spark/apps","spark.dynamicAllocation.enabled":"true","spark.executor.extraClassPath":"/usr/lib/hadoop-lzo/lib/*:/usr/lib/hadoop/hadoop-aws.jar:/usr/share/aws/aws-java-sdk/*:/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/usr/share/aws/emr/security/conf:/usr/share/aws/emr/security/lib/*:/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar:/docker/usr/lib/hadoop-lzo/lib/*:/docker/usr/lib/hadoop/hadoop-aws.jar:/docker/usr/share/aws/aws-java-sdk/*:/docker/usr/share/aws/emr/goodies/lib/emr-spark-goodies.jar:/docker/usr/share/aws/emr/security/conf:/docker/usr/share/aws/emr/security/lib/*:/docker/usr/share/aws/hmclient/lib/aws-glue-datacatalog-spark-client.jar:/docker/usr/share/java/Hive-JSON-Serde/hive-openx-serde.jar:/docker/usr/share/aws/sagemaker-spark-sdk/lib/sagemaker-spark-sdk.jar:/docker/usr/share/aws/emr/s3select/lib/emr-s3-select-spark-connector.jar","spark.sql.execution.id":"13","spark.sql.catalogImplementation":"hive","spark.executor.cores":"4","spark.history.ui.port":"18080","spark.driver.appUIAddress":"http://ip-10-0-10-20.us-west-2.compute.internal:4040","spark.yarn.isPython":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_HOSTS":"ip-10-0-10-20.us-west-2.compute.internal","spark.blacklist.decommissioning.enabled":"true","spark.org.apache.hadoop.yarn.server.webproxy.amfilter.AmIpFilter.param.PROXY_URI_BASES":"http://ip-10-0-10-20.us-west-2.compute.internal:20888/proxy/application_1691339165261_0001","spark.decommissioning.timeout.threshold":"20","spark.hadoop.mapreduce.fileoutputcommitter.cleanup-failures.ignored.emr_internal_use_only.EmrFileSystem":"true","spark.app.id":"application_1691339165261_0001","spark.hadoop.yarn.timeline-service.enabled":"false","spark.yarn.executor.memoryOverheadFactor":"0.1875"}}
{"Event":"SparkListenerTaskStart","Stage ID":21,"Stage Attempt ID":0,"Task Info":{"Task ID":18,"Index":0,"Attempt":0,"Launch Time":1691341231657,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":0,"Failed":false,"Killed":false,"Accumulables":[]}}
{"Event":"SparkListenerTaskEnd","Stage ID":21,"Stage Attempt ID":0,"Task Type":"ResultTask","Task End Reason":{"Reason":"Success"},"Task Info":{"Task ID":18,"Index":0,"Attempt":0,"Launch Time":1691341231657,"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Locality":"NODE_LOCAL","Speculative":false,"Getting Result Time":0,"Finish Time":1691341231797,"Failed":false,"Killed":false,"Accumulables":[{"ID":766,"Name":"local blocks read","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":769,"Name":"local bytes read","Update":"59","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":770,"Name":"fetch wait time","Update":"0","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":771,"Name":"records read","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":812,"Name":"duration","Update":"14","Value":"14","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":813,"Name":"number of output rows","Update":"1","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":816,"Name":"time in aggregation build","Update":"13","Value":"13","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":818,"Name":"internal.metrics.executorDeserializeTime","Update":28,"Value":28,"Internal":true,"Count Failed Values":true},{"ID":819,"Name":"internal.metrics.executorDeserializeCpuTime","Update":19474622,"Value":19474622,"Internal":true,"Count Failed Values":true},{"ID":820,"Name":"internal.metrics.executorRunTime","Update":103,"Value":103,"Internal":true,"Count Failed Values":true},{"ID":821,"Name":"internal.metrics.executorCpuTime","Update":99421677,"Value":99421677,"Internal":true,"Count Failed Values":true},{"ID":822,"Name":"internal.metrics.resultSize","Update":2644,"Value":2644,"Internal":true,"Count Failed Values":true},{"ID":829,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":830,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Update":1,"Value":1,"Internal":true,"Count Failed Values":true},{"ID":831,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":832,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":833,"Name":"internal.metrics.shuffle.read.localBytesRead","Update":59,"Value":59,"Internal":true,"Count Failed Values":true},{"ID":834,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Update":0,"Value":0,"Internal":true,"Count Failed Values":true},{"ID":835,"Name":"internal.metrics.shuffle.read.recordsRead","Update":1,"Value":1,"Internal":true,"Count Failed Values":true}]},"Task Executor Metrics":{"JVMHeapMemory":0,"JVMOffHeapMemory":0,"OnHeapExecutionMemory":0,"OffHeapExecutionMemory":0,"OnHeapStorageMemory":0,"OffHeapStorageMemory":0,"OnHeapUnifiedMemory":0,"OffHeapUnifiedMemory":0,"DirectPoolMemory":0,"MappedPoolMemory":0,"ProcessTreeJVMVMemory":0,"ProcessTreeJVMRSSMemory":0,"ProcessTreePythonVMemory":0,"ProcessTreePythonRSSMemory":0,"ProcessTreeOtherVMemory":0,"ProcessTreeOtherRSSMemory":0,"MinorGCCount":0,"MinorGCTime":0,"MajorGCCount":0,"MajorGCTime":0},"Task Metrics":{"Executor Deserialize Time":28,"Executor Deserialize CPU Time":19474622,"Executor Run Time":103,"Executor CPU Time":99421677,"Peak Execution Memory":0,"Result Size":2644,"JVM GC Time":0,"Result Serialization Time":0,"Memory Bytes Spilled":0,"Disk Bytes Spilled":0,"Shuffle Read Metrics":{"Remote Blocks Fetched":0,"Local Blocks Fetched":1,"Fetch Wait Time":0,"Remote Bytes Read":0,"Remote Bytes Read To Disk":0,"Local Bytes Read":59,"Total Records Read":1},"Shuffle Write Metrics":{"Shuffle Bytes Written":0,"Shuffle Write Time":0,"Shuffle Records Written":0},"Input Metrics":{"Bytes Read":0,"Records Read":0},"Output Metrics":{"Bytes Written":0,"Records Written":0},"Updated Blocks":[]}}
{"Event":"SparkListenerStageCompleted","Stage Info":{"Stage ID":21,"Stage Attempt ID":0,"Stage Name":"count at NativeMethodAccessorImpl.java:0","Number of Tasks":1,"RDD Info":[{"RDD ID":83,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"186\",\"name\":\"mapPartitionsInternal\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[82],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":82,"Name":"MapPartitionsRDD","Scope":"{\"id\":\"181\",\"name\":\"WholeStageCodegen (2)\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[81],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0},{"RDD ID":81,"Name":"ShuffledRowRDD","Scope":"{\"id\":\"185\",\"name\":\"Exchange\"}","Callsite":"count at NativeMethodAccessorImpl.java:0","Parent IDs":[80],"Storage Level":{"Use Disk":false,"Use Memory":false,"Deserialized":false,"Replication":1},"Barrier":false,"Number of Partitions":1,"Number of Cached Partitions":0,"Memory Size":0,"Disk Size":0}],"Parent IDs":[20],"Details":"org.apache.spark.sql.Dataset.count(Dataset.scala:3045)\nsun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nsun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nsun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\njava.lang.reflect.Method.invoke(Method.java:498)\npy4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\npy4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\npy4j.Gateway.invoke(Gateway.java:282)\npy4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\npy4j.commands.CallCommand.execute(CallCommand.java:79)\npy4j.GatewayConnection.run(GatewayConnection.java:238)\njava.lang.Thread.run(Thread.java:750)","Submission Time":1691341231651,"Completion Time":1691341231800,"Accumulables":[{"ID":766,"Name":"local blocks read","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":769,"Name":"local bytes read","Value":"59","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":770,"Name":"fetch wait time","Value":"0","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":771,"Name":"records read","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":812,"Name":"duration","Value":"14","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":813,"Name":"number of output rows","Value":"1","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":816,"Name":"time in aggregation build","Value":"13","Internal":true,"Count Failed Values":true,"Metadata":"sql"},{"ID":818,"Name":"internal.metrics.executorDeserializeTime","Value":28,"Internal":true,"Count Failed Values":true},{"ID":819,"Name":"internal.metrics.executorDeserializeCpuTime","Value":19474622,"Internal":true,"Count Failed Values":true},{"ID":820,"Name":"internal.metrics.executorRunTime","Value":103,"Internal":true,"Count Failed Values":true},{"ID":821,"Name":"internal.metrics.executorCpuTime","Value":99421677,"Internal":true,"Count Failed Values":true},{"ID":822,"Name":"internal.metrics.resultSize","Value":2644,"Internal":true,"Count Failed Values":true},{"ID":829,"Name":"internal.metrics.shuffle.read.remoteBlocksFetched","Value":0,"Internal":true,"Count Failed Values":true},{"ID":830,"Name":"internal.metrics.shuffle.read.localBlocksFetched","Value":1,"Internal":true,"Count Failed Values":true},{"ID":831,"Name":"internal.metrics.shuffle.read.remoteBytesRead","Value":0,"Internal":true,"Count Failed Values":true},{"ID":832,"Name":"internal.metrics.shuffle.read.remoteBytesReadToDisk","Value":0,"Internal":true,"Count Failed Values":true},{"ID":833,"Name":"internal.metrics.shuffle.read.localBytesRead","Value":59,"Internal":true,"Count Failed Values":true},{"ID":834,"Name":"internal.metrics.shuffle.read.fetchWaitTime","Value":0,"Internal":true,"Count Failed Values":true},{"ID":835,"Name":"internal.metrics.shuffle.read.recordsRead","Value":1,"Internal":true,"Count Failed Values":true}],"Resource Profile Id":0}}
{"Event":"SparkListenerJobEnd","Job ID":17,"Completion Time":1691341231801,"Job Result":{"Result":"JobSucceeded"}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerQueryExecutionMetrics","executionId":13,"timePerRule":{"PruneFileSourcePartitions":196071,"ReassignLambdaVariableID":54664,"PushPredicateThroughNonJoin":20350,"Analyzer$ResolveEncodersInUDF":14255,"Analyzer$HandleNullInputsForUDF":18962,"OptimizeUpdateFields":185279,"Analyzer$ResolveSubqueryColumnAliases":6397,"ResolveTimeZone":12290,"Analyzer$ResolveNamespace":6866,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":12489,"RelationConversions":6722,"RewriteCorrelatedScalarSubquery":575831,"RemoveLiteralFromGroupExpressions":21012,"PushProjectionThroughUnion":56512,"EliminateSubqueryAliases":164676,"ResolveCatalogs":9942,"PushLeftSemiLeftAntiThroughJoin":41722,"Analyzer$ResolveUserSpecifiedColumns":6227,"EliminateJoinToEmptyRelation":6665,"FlattenScalarSubqueriesWithAggregates":40717,"LikeSimplification":137918,"CollapseRepartition":95818,"ResolveHints$ResolveCoalesceHints":6801,"Analyzer$ExtractGenerator":68316,"RewriteIntersectAll":16734,"Analyzer$AddMetadataColumns":163676,"ResolveHints$ResolveJoinStrategyHints":9835,"TypeCoercion$MapZipWithCoercion":17591,"NullPropagation":374611,"EliminateAggregateFilter":36247,"PullupCorrelatedPredicates":63327,"UpdateOuterReferences":8856,"ExtractPythonUDFs":214545,"Analyzer$WindowsSubstitution":8200,"CombineUnions":62511,"ExtractGroupingPythonUDFFromAggregate":12731,"ReorderAssociativeOperator":227934,"CleanupDynamicPruningFilters":74828,"ResolveHints$RemoveAllHints":6065,"SimplifyBinaryComparison":153721,"ResolveTableValuedFunctions":7762,"EliminateSerialization":55361,"OptimizeJsonExprs":257433,"GetCurrentDatabaseAndCatalog":195141,"TypeCoercion$BooleanEquality":21508,"package$ExpressionCanonicalizer$CleanExpressions":35207,"EliminateLimits":41607,"ReplaceIntersectWithSemiJoin":16547,"ConstantPropagation":87952,"PushExtraPredicateThroughJoin":16893,"CostBasedJoinReorder":16793,"Analyzer$ResolveReferences":66568,"CTESubstitution":355552,"RemoveRedundantAliases":441604,"TypeCoercion$ImplicitTypeCasts":17721,"RewriteExceptAll":19122,"UpdateAttributeNullability":996939,"PropagateEmptyRelation":56298,"InferFiltersFromGenerate":19176,"SimplifyCasts":137782,"EliminateMapObjects":51742,"DetectAmbiguousSelfJoin":37249,"ReplaceExpressions":87196,"ResolveInlineTables":8046,"ResolveUnion":9024,"OptimizeIn":148960,"CollapseWindow":49497,"TypeCoercion$IfCoercion":20175,"ResolveSessionCatalog":15337,"PartitionPruning":33497,"BooleanSimplification":805559,"TypeCoercion$PromoteStrings":27042,"Analyzer$ResolveAliases":17809,"DecimalAggregates":54013,"PruneFilters":311750,"PruneHiveTablePartitions":81742,"Analyzer$ResolveMissingReferences":7554,"TransposeWindow":40082,"Analyzer$ResolveRelations":15360,"EliminateUnions":9516,"RewritePredicateSubquery":66154,"ObjectSerializerPruning":11721,"LimitPushDown":39823,"SimplifyCaseConversionExpressions":131705,"ResolvePartitionSpec":6814,"Analyzer$ResolveNaturalAndUsingJoin":7080,"UnwrapCastInBinaryComparison":169247,"EliminateView":31651,"CombineTypedFilters":12198,"ReplaceUpdateFieldsExpression":51744,"OptimizeLimitZero":19527,"CheckCartesianProducts":28051,"ExtractPythonUDFFromAggregate":30104,"Analyzer$ExtractWindowExpressions":41840,"ReplaceExceptWithAntiJoin":15737,"ResolveLambdaVariables":12095,"FallBackFileSourceV2":6247,"Analyzer$ResolveTables":9605,"SubstituteUnresolvedOrdinals":22470,"TypeCoercion$CaseWhenCoercion":12395,"DecimalPrecision":36142,"EliminateSorts":101236,"PushDownLeftSemiAntiJoin":63067,"ExtractPythonUDFFromJoinCondition":13040,"TypeCoercion$StackCoercion":13098,"Analyzer$ResolveAggAliasInGroupBy":24661,"TypeCoercion$StringLiteralCoercion":17290,"FoldablePropagation":506693,"ResolveHiveSerdeTable":8546,"V2ScanRelationPushDown":189948,"EliminateDistinct":19561,"InferFiltersFromConstraints":441846,"DetermineTableStats":7381,"Analyzer$PullOutNondeterministic":28796,"Analyzer$ResolveFunctions":22370,"ReplaceNullWithFalseInPredicate":203774,"ResolveHigherOrderFunctions":14090,"Analyzer$ResolvePivot":7171,"CollapseProject":345227,"Analyzer$ResolveNewInstance":7877,"ColumnPruning":4327947,"Analyzer$ResolveWindowOrder":13738,"TypeCoercion$ConcatCoercion":35134,"PushDownPredicates":346647,"TimeWindowing":35081,"Optimizer$OptimizeSubqueries":124448,"RewriteNonCorrelatedExists":63058,"DemoteBroadcastHashJoin":9752,"TypeCoercion$Division":17368,"ComputeCurrentTime":319062,"ResolveCreateNamedStruct":24081,"TypeCoercion$EltCoercion":16023,"ConvertToLocalRelation":36140,"OptimizeWindowFunctions":141080,"RemoveRepetitionFromGroupExpressions":16750,"ReplaceDistinctWithAggregate":16352,"PreprocessTableCreation":7260,"ResolveSQLOnFile":5637,"Analyzer$ResolveSubquery":18202,"CombineConcats":31778,"Analyzer$ResolveGroupingAnalytics":13609,"Analyzer$ResolveBinaryArithmetic":17965,"RemoveDispensableExpressions":126149,"Analyzer$ResolveAlterTableChanges":7174,"ResolveEncodersInScalaAgg":17061,"TypeCoercion$IntegralDivision":17097,"Analyzer$ResolveWindowFrame":11698,"Analyzer$ResolveDeserializer":28290,"RewriteDistinctAggregates":37232,"RemoveNoopOperators":90994,"Analyzer$ResolveAggregateFunctions":7272,"NormalizeFloatingNumbers":11739,"ReorderJoin":50885,"Analyzer$ResolveUpCast":6013,"Analyzer$ResolveGenerate":8600,"TypeCoercion$WidenSetOperationTypes":85820,"EliminateOuterJoin":42877,"SimplifyExtractValueOps":120931,"OptimizeMetadataOnlyQuery":11566,"EliminateResolvedHint":56733,"Analyzer$ResolveInsertInto":6149,"ReplaceExceptWithFilter":34961,"CleanupAliases":40209,"SchemaPruning":138269,"ResolveHints$DisableHints":10428,"Analyzer$ResolveOutputRelation":7024,"BloomFilterJoinRule":25374,"HiveAnalysis":6212,"Analyzer$ResolveRandomSeed":7214,"TypeCoercion$WindowFrameCoercion":29414,"ConstantFolding":158447,"TypeCoercion$DateTimeOperations":18366,"ResolveNoopDropTable":7143,"TypeCoercion$InConversion":20238,"FindDataSourceTable":6883,"ApplyCharTypePadding":20279,"SimplifyConditionals":139356,"DataSourceAnalysis":6482,"TypeCoercion$FunctionArgumentConversion":96852,"Analyzer$GlobalAggregates":5929,"Analyzer$LookupFunctions":23409,"CombineFilters":43179,"ReplaceDeduplicateWithAggregate":148895,"PreprocessTableInsertion":5792},"numRunsPerRule":{"PruneFileSourcePartitions":1,"ReassignLambdaVariableID":1,"PushPredicateThroughNonJoin":1,"Analyzer$ResolveEncodersInUDF":1,"Analyzer$HandleNullInputsForUDF":1,"OptimizeUpdateFields":4,"Analyzer$ResolveSubqueryColumnAliases":1,"ResolveTimeZone":1,"Analyzer$ResolveNamespace":1,"Analyzer$ResolveOrdinalInOrderByAndGroupBy":1,"RelationConversions":1,"RewriteCorrelatedScalarSubquery":3,"RemoveLiteralFromGroupExpressions":1,"PushProjectionThroughUnion":3,"EliminateSubqueryAliases":1,"ResolveCatalogs":1,"PushLeftSemiLeftAntiThroughJoin":3,"Analyzer$ResolveUserSpecifiedColumns":1,"EliminateJoinToEmptyRelation":1,"FlattenScalarSubqueriesWithAggregates":1,"LikeSimplification":3,"CollapseRepartition":3,"ResolveHints$ResolveCoalesceHints":1,"Analyzer$ExtractGenerator":1,"RewriteIntersectAll":1,"Analyzer$AddMetadataColumns":1,"ResolveHints$ResolveJoinStrategyHints":1,"TypeCoercion$MapZipWithCoercion":1,"NullPropagation":3,"EliminateAggregateFilter":3,"PullupCorrelatedPredicates":1,"UpdateOuterReferences":1,"ExtractPythonUDFs":1,"Analyzer$WindowsSubstitution":1,"CombineUnions":4,"ExtractGroupingPythonUDFFromAggregate":1,"ReorderAssociativeOperator":3,"CleanupDynamicPruningFilters":1,"ResolveHints$RemoveAllHints":1,"SimplifyBinaryComparison":3,"ResolveTableValuedFunctions":1,"EliminateSerialization":3,"OptimizeJsonExprs":3,"GetCurrentDatabaseAndCatalog":1,"TypeCoercion$BooleanEquality":1,"package$ExpressionCanonicalizer$CleanExpressions":1,"EliminateLimits":3,"ReplaceIntersectWithSemiJoin":1,"ConstantPropagation":3,"PushExtraPredicateThroughJoin":1,"CostBasedJoinReorder":1,"Analyzer$ResolveReferences":1,"CTESubstitution":1,"RemoveRedundantAliases":3,"TypeCoercion$ImplicitTypeCasts":1,"RewriteExceptAll":1,"UpdateAttributeNullability":3,"PropagateEmptyRelation":2,"InferFiltersFromGenerate":1,"SimplifyCasts":3,"EliminateMapObjects":1,"DetectAmbiguousSelfJoin":1,"ReplaceExpressions":1,"ResolveInlineTables":1,"ResolveUnion":1,"OptimizeIn":3,"CollapseWindow":3,"TypeCoercion$IfCoercion":1,"ResolveSessionCatalog":1,"PartitionPruning":1,"BooleanSimplification":3,"TypeCoercion$PromoteStrings":1,"Analyzer$ResolveAliases":1,"DecimalAggregates":1,"PruneFilters":4,"PruneHiveTablePartitions":1,"Analyzer$ResolveMissingReferences":1,"TransposeWindow":3,"Analyzer$ResolveRelations":1,"EliminateUnions":1,"RewritePredicateSubquery":1,"ObjectSerializerPruning":1,"LimitPushDown":3,"SimplifyCaseConversionExpressions":3,"ResolvePartitionSpec":1,"Analyzer$ResolveNaturalAndUsingJoin":1,"UnwrapCastInBinaryComparison":3,"EliminateView":1,"CombineTypedFilters":1,"ReplaceUpdateFieldsExpression":1,"OptimizeLimitZero":1,"CheckCartesianProducts":2,"ExtractPythonUDFFromAggregate":1,"Analyzer$ExtractWindowExpressions":1,"ReplaceExceptWithAntiJoin":1,"ResolveLambdaVariables":1,"FallBackFileSourceV2":1,"Analyzer$ResolveTables":1,"SubstituteUnresolvedOrdinals":1,"TypeCoercion$CaseWhenCoercion":1,"DecimalPrecision":1,"EliminateSorts":1,"PushDownLeftSemiAntiJoin":3,"ExtractPythonUDFFromJoinCondition":1,"TypeCoercion$StackCoercion":1,"Analyzer$ResolveAggAliasInGroupBy":1,"TypeCoercion$StringLiteralCoercion":1,"FoldablePropagation":3,"ResolveHiveSerdeTable":1,"V2ScanRelationPushDown":1,"EliminateDistinct":1,"InferFiltersFromConstraints":1,"DetermineTableStats":1,"Analyzer$PullOutNondeterministic":1,"Analyzer$ResolveFunctions":1,"ReplaceNullWithFalseInPredicate":3,"ResolveHigherOrderFunctions":1,"Analyzer$ResolvePivot":1,"CollapseProject":4,"Analyzer$ResolveNewInstance":1,"ColumnPruning":5,"Analyzer$ResolveWindowOrder":1,"TypeCoercion$ConcatCoercion":1,"PushDownPredicates":6,"TimeWindowing":1,"Optimizer$OptimizeSubqueries":3,"RewriteNonCorrelatedExists":1,"DemoteBroadcastHashJoin":1,"TypeCoercion$Division":1,"ComputeCurrentTime":1,"ResolveCreateNamedStruct":1,"TypeCoercion$EltCoercion":1,"ConvertToLocalRelation":2,"OptimizeWindowFunctions":3,"RemoveRepetitionFromGroupExpressions":1,"ReplaceDistinctWithAggregate":1,"PreprocessTableCreation":1,"ResolveSQLOnFile":1,"Analyzer$ResolveSubquery":1,"CombineConcats":3,"Analyzer$ResolveGroupingAnalytics":1,"Analyzer$ResolveBinaryArithmetic":1,"RemoveDispensableExpressions":3,"Analyzer$ResolveAlterTableChanges":1,"ResolveEncodersInScalaAgg":1,"TypeCoercion$IntegralDivision":1,"Analyzer$ResolveWindowFrame":1,"Analyzer$ResolveDeserializer":1,"RewriteDistinctAggregates":1,"RemoveNoopOperators":5,"Analyzer$ResolveAggregateFunctions":1,"NormalizeFloatingNumbers":1,"ReorderJoin":3,"Analyzer$ResolveUpCast":1,"Analyzer$ResolveGenerate":1,"TypeCoercion$WidenSetOperationTypes":1,"EliminateOuterJoin":3,"SimplifyExtractValueOps":3,"OptimizeMetadataOnlyQuery":1,"EliminateResolvedHint":1,"Analyzer$ResolveInsertInto":1,"ReplaceExceptWithFilter":1,"CleanupAliases":2,"SchemaPruning":1,"ResolveHints$DisableHints":1,"Analyzer$ResolveOutputRelation":1,"BloomFilterJoinRule":1,"HiveAnalysis":1,"Analyzer$ResolveRandomSeed":1,"TypeCoercion$WindowFrameCoercion":1,"ConstantFolding":3,"TypeCoercion$DateTimeOperations":1,"ResolveNoopDropTable":1,"TypeCoercion$InConversion":1,"FindDataSourceTable":1,"ApplyCharTypePadding":1,"SimplifyConditionals":3,"DataSourceAnalysis":1,"TypeCoercion$FunctionArgumentConversion":1,"Analyzer$GlobalAggregates":1,"Analyzer$LookupFunctions":1,"CombineFilters":4,"ReplaceDeduplicateWithAggregate":1,"PreprocessTableInsertion":1},"numEffectiveRunsPerRule":{"EliminateSubqueryAliases":1,"EliminateSorts":1,"CollapseProject":2,"ColumnPruning":2,"PushDownPredicates":1,"CleanupAliases":1},"timeEffectiveRunsPerRule":{"EliminateSubqueryAliases":164676,"EliminateSorts":101236,"CollapseProject":311594,"ColumnPruning":1858228,"PushDownPredicates":249544,"CleanupAliases":21446},"counters":{},"timers":{},"stats":{}}
{"Event":"org.apache.spark.sql.execution.ui.SparkListenerSQLExecutionEnd","executionId":13,"time":1691341231803}
{"Event":"SparkListenerBlockManagerRemoved","Block Manager ID":{"Executor ID":"7","Host":"ip-10-0-10-52.us-west-2.compute.internal","Port":33487},"Timestamp":1691341293034}
{"Event":"SparkListenerExecutorRemoved","Timestamp":1691341293038,"Executor ID":"7","Removed Reason":"Container container_1691339165261_0001_01_000017 exited from explicit termination request."}
